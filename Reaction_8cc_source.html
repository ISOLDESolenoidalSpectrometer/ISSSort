<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ISSSort: src/Reaction.cc Source File</title>
<link rel="icon" href=".isssort_logo.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src=".isssort_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">ISSSort
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">Reaction.cc</div></div>
</div><!--header-->
<div class="contents">
<a href="Reaction_8cc.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="preprocessor">#include &quot;<a class="code" href="Reaction_8hh.html">Reaction.hh</a>&quot;</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span> </div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// Uncomment this below to switch to the Butler algorithm (currently in testing)</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno"><a class="line" href="Reaction_8cc.html#a64e4e93922a1908dd2b64facbbfcd9cc">    4</a></span><span class="preprocessor">#define butler_algorithm</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span> </div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno"><a class="line" href="Reaction_8cc.html#a6516d0b611c080f9672b582640509a02">    6</a></span><a class="code hl_function" href="Reaction_8cc.html#a6516d0b611c080f9672b582640509a02">ClassImp</a>( <a class="code hl_class" href="classISSParticle.html">ISSParticle</a> )</div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><a class="code hl_function" href="Reaction_8cc.html#a6516d0b611c080f9672b582640509a02">ClassImp</a>( <a class="code hl_class" href="classISSReaction.html">ISSReaction</a> )</div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><a class="code hl_function" href="Reaction_8cc.html#a6516d0b611c080f9672b582640509a02">ClassImp</a>( <a class="code hl_class" href="classISSRxEvent.html">ISSRxEvent</a> )</div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><a class="code hl_function" href="Reaction_8cc.html#a6516d0b611c080f9672b582640509a02">ClassImp</a>( <a class="code hl_class" href="classISSRxInfo.html">ISSRxInfo</a> )</div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span> </div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span> </div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno"><a class="line" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">   16</a></span>double alpha_function( <span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *<a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a> ){</div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span>    </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span>    <span class="comment">// Equation to solve for alpha, LHS = 0</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span>    <span class="keywordtype">double</span> alpha = x[0];</div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno"><a class="line" href="Reaction_8cc.html#ab3e6ed577a7c669c19de1f9c1b46c872">   20</a></span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a> = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[0];</div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno"><a class="line" href="Reaction_8cc.html#addc5f96b125bcc4afc42a5a44472c9d7">   21</a></span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#addc5f96b125bcc4afc42a5a44472c9d7">r_meas</a> = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[1];</div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno"><a class="line" href="Reaction_8cc.html#aace2d484b0e3651abd108f04803d316c">   22</a></span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#aace2d484b0e3651abd108f04803d316c">p</a> = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[2];   <span class="comment">//  p</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno"><a class="line" href="Reaction_8cc.html#a30506dbffb6fb7641083ec5db1bab356">   23</a></span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#a30506dbffb6fb7641083ec5db1bab356">qb</a> = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[3];  <span class="comment">//  qb / 2*pi</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span>    </div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno"><a class="line" href="Reaction_8cc.html#adec064332fb7f7c5788d798dafbd9c7d">   25</a></span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#adec064332fb7f7c5788d798dafbd9c7d">root</a> = <a class="code hl_variable" href="Reaction_8cc.html#aace2d484b0e3651abd108f04803d316c">p</a> * TMath::Sin(alpha);</div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span>    <a class="code hl_variable" href="Reaction_8cc.html#adec064332fb7f7c5788d798dafbd9c7d">root</a> -= <a class="code hl_variable" href="Reaction_8cc.html#a30506dbffb6fb7641083ec5db1bab356">qb</a> * <a class="code hl_variable" href="Reaction_8cc.html#addc5f96b125bcc4afc42a5a44472c9d7">r_meas</a> * TMath::Tan(alpha);</div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span>    <a class="code hl_variable" href="Reaction_8cc.html#adec064332fb7f7c5788d798dafbd9c7d">root</a> -= <a class="code hl_variable" href="Reaction_8cc.html#a30506dbffb6fb7641083ec5db1bab356">qb</a> * <a class="code hl_variable" href="Reaction_8cc.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a>;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span>    </div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="Reaction_8cc.html#adec064332fb7f7c5788d798dafbd9c7d">root</a>;</div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span>    </div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span>}</div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="foldopen" id="foldopen00038" data-start="{" data-end="}">
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno"><a class="line" href="Reaction_8cc.html#aabf34ec196861bf46e08d4db1cdefa00">   38</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="Reaction_8cc.html#aabf34ec196861bf46e08d4db1cdefa00">alpha_derivative</a>( <span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *<a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a> ){</div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span>    </div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span>    <span class="comment">// Derivative of the alpha equation</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span>    <span class="keywordtype">double</span> alpha = x[0];</div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>    <span class="comment">//double z = params[0]; // unused in derivative</span></div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#addc5f96b125bcc4afc42a5a44472c9d7">r_meas</a> = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[1];</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#aace2d484b0e3651abd108f04803d316c">p</a> = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[2];   <span class="comment">//  p</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#a30506dbffb6fb7641083ec5db1bab356">qb</a> = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[3];  <span class="comment">//  qb / 2*pi</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>    </div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#adec064332fb7f7c5788d798dafbd9c7d">root</a> = <a class="code hl_variable" href="Reaction_8cc.html#aace2d484b0e3651abd108f04803d316c">p</a> * TMath::Cos(alpha);</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>    <a class="code hl_variable" href="Reaction_8cc.html#adec064332fb7f7c5788d798dafbd9c7d">root</a> -= <a class="code hl_variable" href="Reaction_8cc.html#a30506dbffb6fb7641083ec5db1bab356">qb</a> * <a class="code hl_variable" href="Reaction_8cc.html#addc5f96b125bcc4afc42a5a44472c9d7">r_meas</a> / TMath::Cos(alpha) / TMath::Cos(alpha);</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>    </div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="Reaction_8cc.html#adec064332fb7f7c5788d798dafbd9c7d">root</a>;</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>    </div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>}</div>
</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span> </div>
<div class="foldopen" id="foldopen00059" data-start="{" data-end="}">
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno"><a class="line" href="Reaction_8cc.html#a96d07aa9cdab7337d6f6c58a4330ff50">   59</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="Reaction_8cc.html#a96d07aa9cdab7337d6f6c58a4330ff50">butler_function</a>( <span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *<a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a> ){</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>    </div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <span class="comment">// Equation to solve for z, LHS = 0</span></div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a> = x[0];</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>    <span class="keywordtype">double</span> z_meas = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[0];</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#addc5f96b125bcc4afc42a5a44472c9d7">r_meas</a> = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[1];</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#aace2d484b0e3651abd108f04803d316c">p</a> = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[2];   <span class="comment">//  p</span></div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#a30506dbffb6fb7641083ec5db1bab356">qb</a> = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[3];  <span class="comment">//  qb / 2*pi</span></div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    </div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <span class="comment">// From Sam Bennett&#39;s first derivation, modified by A. Ceulemans</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    <span class="keywordtype">double</span> theta_lab = TMath::ACos( <a class="code hl_variable" href="Reaction_8cc.html#a30506dbffb6fb7641083ec5db1bab356">qb</a> * <a class="code hl_variable" href="Reaction_8cc.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a> / <a class="code hl_variable" href="Reaction_8cc.html#aace2d484b0e3651abd108f04803d316c">p</a> );</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <span class="keywordtype">double</span> r_max = TMath::Abs( 2.0 * <a class="code hl_variable" href="Reaction_8cc.html#aace2d484b0e3651abd108f04803d316c">p</a> * TMath::Sin( theta_lab ) / ( <a class="code hl_variable" href="Reaction_8cc.html#a30506dbffb6fb7641083ec5db1bab356">qb</a> * TMath::TwoPi()) );</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    <span class="keywordtype">double</span> psi = 2 * TMath::ASin( <a class="code hl_variable" href="Reaction_8cc.html#addc5f96b125bcc4afc42a5a44472c9d7">r_meas</a> / r_max );</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#adec064332fb7f7c5788d798dafbd9c7d">root</a> = z_meas - <a class="code hl_variable" href="Reaction_8cc.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a> * ( 1.0 - psi / TMath::TwoPi() );</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>    </div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="Reaction_8cc.html#adec064332fb7f7c5788d798dafbd9c7d">root</a>;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>    </div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>}</div>
</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span> </div>
<div class="foldopen" id="foldopen00083" data-start="{" data-end="}">
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno"><a class="line" href="Reaction_8cc.html#a5e52f3b24f4e4b40f286508257368253">   83</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="Reaction_8cc.html#a5e52f3b24f4e4b40f286508257368253">butler_derivative</a>( <span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *<a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a> ){</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    </div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>    <span class="comment">// Create the original function and solve the derivative</span></div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    std::unique_ptr&lt;TF1&gt; func = std::make_unique&lt;TF1&gt;( <span class="stringliteral">&quot;butler_function&quot;</span>, <a class="code hl_function" href="Reaction_8cc.html#a96d07aa9cdab7337d6f6c58a4330ff50">butler_function</a>, 0.0, TMath::PiOver2(), 4 );</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span>    <span class="keywordflow">return</span> func-&gt;Derivative( x[0], <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a> );</div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    </div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>}</div>
</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="foldopen" id="foldopen00096" data-start="{" data-end="}">
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno"><a class="line" href="Reaction_8cc.html#ab735a6fa7ba6047d143b13bd1bb35939">   96</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="Reaction_8cc.html#ab735a6fa7ba6047d143b13bd1bb35939">theta_cm_function</a>( <span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *<a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a> ){</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    </div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    <span class="comment">// Input to the function</span></div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>    <span class="keywordtype">double</span> theta_cm = x[0];</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    <span class="keywordtype">double</span> z_meas = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[0];</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#addc5f96b125bcc4afc42a5a44472c9d7">r_meas</a> = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[1];</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>    <span class="keywordtype">double</span> Ex = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[2];</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#a30506dbffb6fb7641083ec5db1bab356">qb</a> = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[3]; <span class="comment">//  over 2*pi</span></div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    <span class="keywordtype">double</span> T1 = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[4];</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    <span class="keywordtype">double</span> m1 = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[5];</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>    <span class="keywordtype">double</span> m2 = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[6];</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>    <span class="keywordtype">double</span> m3 = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[7];</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>    <span class="keywordtype">double</span> m4 = <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a>[8];</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    </div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>    <span class="comment">// Invariant mass = total energy in centre of mass frame</span></div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>    <span class="keywordtype">double</span> Etot_cm = m1*m1 + m2*m2;</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>    Etot_cm += 2.0 * ( T1 + m1 ) * m2;</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    Etot_cm = TMath::Sqrt( Etot_cm );</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>    </div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>    <span class="comment">// Work out what gamma and beta are</span></div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>    <span class="keywordtype">double</span> E_lab = T1 + m1 + m2;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>    <span class="keywordtype">double</span> gamma = E_lab / Etot_cm;</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    <span class="keywordtype">double</span> beta = TMath::Sqrt( 1.0 - 1.0 / TMath::Power( gamma, 2.0 ) );</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    <span class="comment">// What about the energy of the ejectile after the collision?</span></div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    <span class="keywordtype">double</span> e3_cm = TMath::Power( Etot_cm, 2.0 );</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    e3_cm -= TMath::Power( m4 + Ex, 2.0 );</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>    e3_cm += TMath::Power( m3, 2.0 );</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>    e3_cm /= 2.0 * Etot_cm;</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>    </div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>    <span class="comment">// Now the momentum and velocity of the ejectile</span></div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    <span class="keywordtype">double</span> p3_cm = TMath::Power( e3_cm, 2.0 );</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    p3_cm -= TMath::Power( m3, 2.0 );</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>    p3_cm = TMath::Sqrt( p3_cm );</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>    </div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>    <span class="comment">// From Daniel Clarke:</span></div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>    <span class="comment">//double p_lab = beta * E_lab;</span></div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>    <span class="keywordtype">double</span> theta_lab = p3_cm * TMath::Sin( TMath::Pi() - theta_cm );</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>    theta_lab /= p3_cm * TMath::Cos( TMath::Pi() - theta_cm ) + beta * e3_cm;</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>    theta_lab /= gamma;</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>    theta_lab = TMath::ATan( theta_lab );</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>    <span class="keywordflow">if</span>( theta_lab &lt; 0 ) theta_lab = TMath::Pi() + theta_lab;</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>    </div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>    <span class="comment">// Energy of ejectile in the lab</span></div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>    <span class="keywordtype">double</span> e3_lab = gamma * beta * p3_cm * TMath::Cos( TMath::Pi() - theta_cm );</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    e3_lab += gamma * e3_cm;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    <span class="keywordtype">double</span> p3_lab = TMath::Sqrt( e3_lab*e3_lab - m3*m3 );</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>    </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>    <span class="comment">// Maximum radius of particle, z position and missing orbit fraction (psi)</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>    <span class="keywordtype">double</span> r_max = TMath::Abs( 2.0 * p3_lab * TMath::Sin( theta_lab ) / ( <a class="code hl_variable" href="Reaction_8cc.html#a30506dbffb6fb7641083ec5db1bab356">qb</a> * TMath::TwoPi()) );</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a> = p3_lab * TMath::Cos( theta_lab ) / <a class="code hl_variable" href="Reaction_8cc.html#a30506dbffb6fb7641083ec5db1bab356">qb</a>;</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>    <span class="keywordtype">double</span> psi = 2.0 * TMath::ASin( <a class="code hl_variable" href="Reaction_8cc.html#addc5f96b125bcc4afc42a5a44472c9d7">r_meas</a> / r_max );</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>    </div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>    <span class="comment">// This is the equation to find the root of</span></div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="Reaction_8cc.html#adec064332fb7f7c5788d798dafbd9c7d">root</a> = z_meas - <a class="code hl_variable" href="Reaction_8cc.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a> * ( 1.0 - psi / TMath::TwoPi() );</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>    </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="Reaction_8cc.html#adec064332fb7f7c5788d798dafbd9c7d">root</a>;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    </div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>}</div>
</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span> </div>
<div class="foldopen" id="foldopen00161" data-start="{" data-end="}">
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno"><a class="line" href="Reaction_8cc.html#ae060f89e91da50f4921a6cefd17b86d5">  161</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="Reaction_8cc.html#ae060f89e91da50f4921a6cefd17b86d5">theta_cm_derivative</a>( <span class="keywordtype">double</span> *x, <span class="keywordtype">double</span> *<a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a> ){</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>    </div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>    <span class="comment">// Create the original function and solve the derivative</span></div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>    std::unique_ptr&lt;TF1&gt; func = std::make_unique&lt;TF1&gt;( <span class="stringliteral">&quot;theta_cm_function&quot;</span>, <a class="code hl_function" href="Reaction_8cc.html#ab735a6fa7ba6047d143b13bd1bb35939">theta_cm_function</a>, 0.0, TMath::Pi(), 9 );</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    <span class="keywordflow">return</span> func-&gt;Derivative( x[0], <a class="code hl_variable" href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a> );</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>    </div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>}</div>
</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span> </div>
<div class="foldopen" id="foldopen00176" data-start="{" data-end="}">
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno"><a class="line" href="classISSReaction.html#a4ee669e7a5f1e10359588e2818391fdb">  176</a></span><a class="code hl_function" href="classISSReaction.html#a4ee669e7a5f1e10359588e2818391fdb">ISSReaction::ISSReaction</a>( std::string filename, std::shared_ptr&lt;ISSSettings&gt; <a class="code hl_variable" href="iss__sort_8cc.html#aef2e709b38e28fdbbfe36870c344b223">myset</a>, <span class="keywordtype">bool</span> source ){</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>    </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>    <span class="comment">// Alpha energies from quadruple alpha source</span></div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    <a class="code hl_variable" href="classISSReaction.html#a895f215673d89b129f50254e79c47d49">alpha_energies</a>.push_back( 3182.69 );</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    <a class="code hl_variable" href="classISSReaction.html#a895f215673d89b129f50254e79c47d49">alpha_energies</a>.push_back( 5148.31 );</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    <a class="code hl_variable" href="classISSReaction.html#a895f215673d89b129f50254e79c47d49">alpha_energies</a>.push_back( 5478.62 );</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    <a class="code hl_variable" href="classISSReaction.html#a895f215673d89b129f50254e79c47d49">alpha_energies</a>.push_back( 5795.04 );</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    </div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    <span class="comment">// Setup the ROOT finder algorithms</span></div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span><span class="preprocessor">#ifdef butler_algorithm</span></div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>    <span class="comment">// Root finder algorithm - The Peter Butler method</span></div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>    <span class="keywordtype">double</span> low_limit = <a class="code hl_variable" href="classISSReaction.html#a024ad9bb0691b6b55faa72a8246f7232">z0</a>;</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>    <span class="keywordtype">double</span> upp_limit = <a class="code hl_variable" href="classISSReaction.html#a024ad9bb0691b6b55faa72a8246f7232">z0</a>;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>    <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#a024ad9bb0691b6b55faa72a8246f7232">z0</a> &lt; 0.0 ) low_limit -= 600.0;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>    <span class="keywordflow">else</span> upp_limit += 600.0;</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>    <a class="code hl_variable" href="classISSReaction.html#a5819db85711395799ad4d040a0415ba2">fa</a> = <span class="keyword">new</span> TF1( <span class="stringliteral">&quot;butler_function&quot;</span>,   <a class="code hl_function" href="Reaction_8cc.html#a96d07aa9cdab7337d6f6c58a4330ff50">butler_function</a>,   low_limit, upp_limit, 4 );</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>    <a class="code hl_variable" href="classISSReaction.html#a40ede1141847b9a90798eeb907490996">fb</a> = <span class="keyword">new</span> TF1( <span class="stringliteral">&quot;butler_derivative&quot;</span>, <a class="code hl_function" href="Reaction_8cc.html#a5e52f3b24f4e4b40f286508257368253">butler_derivative</a>, low_limit, upp_limit, 4 );</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>    <span class="comment">// Root finder algorithm - for alpha like Ryan Tang does</span></div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>    <a class="code hl_variable" href="classISSReaction.html#a5819db85711395799ad4d040a0415ba2">fa</a> = <span class="keyword">new</span> TF1( <span class="stringliteral">&quot;alpha_function&quot;</span>,   alpha_function,   0.0, TMath::PiOver2(), 4 );</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>    <a class="code hl_variable" href="classISSReaction.html#a40ede1141847b9a90798eeb907490996">fb</a> = <span class="keyword">new</span> TF1( <span class="stringliteral">&quot;alpha_derivative&quot;</span>, <a class="code hl_function" href="Reaction_8cc.html#aabf34ec196861bf46e08d4db1cdefa00">alpha_derivative</a>, 0.0, TMath::PiOver2(), 4 );</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    <a class="code hl_variable" href="classISSReaction.html#a843c40e11d87b4f692be73d940c71399">rf</a> = std::make_unique&lt;ROOT::Math::RootFinder&gt;( ROOT::Math::RootFinder::kGSL_NEWTON );</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    </div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <span class="comment">// Root finder for the simulation function</span></div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    <a class="code hl_variable" href="classISSReaction.html#a9a12b81efcfe420e51f5c7eee374fd18">fsim</a> = <span class="keyword">new</span> TF1( <span class="stringliteral">&quot;theta_cm_function&quot;</span>,   <a class="code hl_function" href="Reaction_8cc.html#ab735a6fa7ba6047d143b13bd1bb35939">theta_cm_function</a>,   0.0, TMath::Pi(), 9 );</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>    <a class="code hl_variable" href="classISSReaction.html#ac1f129ae2c5512d6d05073d3f9e27b6a">dsim</a> = <span class="keyword">new</span> TF1( <span class="stringliteral">&quot;theta_cm_derivative&quot;</span>, <a class="code hl_function" href="Reaction_8cc.html#ae060f89e91da50f4921a6cefd17b86d5">theta_cm_derivative</a>, 0.0, TMath::Pi(), 9 );</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    <a class="code hl_variable" href="classISSReaction.html#ad10963ba32970b7ff3c303bdd0c7d642">rfsim</a> = std::make_unique&lt;ROOT::Math::RootFinder&gt;( ROOT::Math::RootFinder::kGSL_NEWTON );</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>    </div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>    <span class="comment">// Read in mass tables</span></div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>    <a class="code hl_function" href="classISSReaction.html#a40017cb95551a1d2045137aca76fd425">ReadMassTables</a>();</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>    </div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>    <span class="comment">// Check if it&#39;s a source run</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>    <a class="code hl_variable" href="classISSReaction.html#aa6d60a463ad5e3a9ab70adf3a7d4929f">flag_source</a> = source;</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>    </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>    <span class="comment">// Get the info from the user input</span></div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>    <a class="code hl_variable" href="classISSReaction.html#a35b6c40984615e7195549ff27492a3ed">set</a> = <a class="code hl_variable" href="iss__sort_8cc.html#aef2e709b38e28fdbbfe36870c344b223">myset</a>;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>    <a class="code hl_function" href="classISSReaction.html#a9499ba48104aaf6baf36df40f049feb5">SetFile</a>( filename );</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>    <a class="code hl_function" href="classISSReaction.html#a893499127cdda06ebd65b452ce196842">ReadReaction</a>();</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span> </div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>}</div>
</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span><span class="comment">//ISSReaction::ISSReaction( ISSReaction &amp;t ){</span></div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span><span class="comment">//</span></div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span><span class="comment">//  set = t.GetSettings();</span></div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span><span class="comment">//</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span><span class="comment">//  SetFile( t.GetFileName() );</span></div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span><span class="comment">//</span></div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span><span class="comment">//  Beam = t.CopyBeam();</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span><span class="comment">//  Target = t.CopyTarget();</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span><span class="comment">//  Ejectile = t.CopyEjectile();</span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span><span class="comment">//  Recoil = t.CopyRecoil();</span></div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span><span class="comment">//</span></div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span><span class="comment">//  ame_be = t.GetMassTables();</span></div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span><span class="comment">//  Mfield = t.GetField();</span></div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span><span class="comment">//</span></div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span><span class="comment">//  z0 = t.GetArrayDistance();</span></div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span><span class="comment">//  deadlayer = t.GetArrayDeadlayer();</span></div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span><span class="comment">//</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span><span class="comment">//  elum_z = t.GetELUMDistance();</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span><span class="comment">//  elum_rin = t.GetELUMInnerRadius();</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span><span class="comment">//  elum_rout = t.GetELUMOuterRadius();</span></div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span><span class="comment">//  elum_deadlayer = t.GetELUMDeadlayer();</span></div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span><span class="comment">//</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span><span class="comment">//  EBIS_On = t.GetEBISOnTime();</span></div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span><span class="comment">//  EBIS_Off = t.GetEBISOffTime();</span></div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span><span class="comment">//  EBIS_ratio = t.GetEBISFillRatio();</span></div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span><span class="comment">//</span></div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span><span class="comment">//  t1_min_time = t.GetT1MinTime();</span></div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span><span class="comment">//  t1_max_time = t.GetT1MaxTime();</span></div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span><span class="comment">//</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span><span class="comment">//  x_offset = t.GetOffsetX();</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span><span class="comment">//  y_offset = t.GetOffsetY();</span></div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span><span class="comment">//</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span><span class="comment">//  flag_source = t.IsSource();</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span><span class="comment">//</span></div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span><span class="comment">//  nrecoilcuts = t.GetNumberOfRecoilCuts();</span></div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span><span class="comment">//  nevszcuts = t.GetNumberOfEvsZCuts();</span></div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span><span class="comment">//</span></div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span><span class="comment">//  // Copy the cuts</span></div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span><span class="comment">//  for( unsigned int i = 0; i &lt; nrecoilcuts; ++i )</span></div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span><span class="comment">//      recoil_cut.push_back( t.GetRecoilCut(i) );</span></div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span><span class="comment">//</span></div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span><span class="comment">//  for( unsigned int i = 0; i &lt; nevszcuts; ++i )</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span><span class="comment">//      e_vs_z_cut.push_back( t.GetEvsZCut(i) );</span></div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span><span class="comment">//</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span><span class="comment">//</span></div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span><span class="comment">//  // Get the stopping powers in TGraphs</span></div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span><span class="comment">//  stopping = true;</span></div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span><span class="comment">//  for( unsigned int i = 0; i &lt; 6; ++i ) {</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span><span class="comment">//      gStopping.push_back( std::make_unique&lt;TGraph&gt;() );</span></div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span><span class="comment">//      gRange.push_back( std::make_unique&lt;TGraph&gt;() );</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span><span class="comment">//  }</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span><span class="comment">//</span></div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span><span class="comment">//  if( !flag_source ) {</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span><span class="comment">//      stopping &amp;= ReadStoppingPowers( Beam.GetIsotope(), Target.GetIsotope(), gStopping[0], gRange[0] );</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span><span class="comment">//      stopping &amp;= ReadStoppingPowers( Ejectile.GetIsotope(), Target.GetIsotope(), gStopping[1], gRange[1] );</span></div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span><span class="comment">//  }</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span><span class="comment">//  stopping &amp;= ReadStoppingPowers( Ejectile.GetIsotope(), &quot;Al&quot;, gStopping[2], gRange[2] );</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span><span class="comment">//</span></div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span><span class="comment">//  // Get the electric and nuclear stopping powers for the PHC in a TGraph</span></div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span><span class="comment">//  phcurves = true;</span></div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span><span class="comment">//  phcurves &amp;= ReadStoppingPowers( Ejectile.GetIsotope(), &quot;Si&quot;, gStopping[3], gRange[3], true, false ); // electric only from SRIM files</span></div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span><span class="comment">//  phcurves &amp;= ReadStoppingPowers( Ejectile.GetIsotope(), &quot;Si&quot;, gStopping[4], gRange[4], false, true ); // nuclear only from SRIM files</span></div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span><span class="comment">//  phcurves &amp;= ReadStoppingPowers( Ejectile.GetIsotope(), &quot;Si&quot;, gStopping[5], gRange[5] );              // total stopping from SRIM files</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span><span class="comment">//</span></div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span><span class="comment">//  // Get the PHC data in a TGraph</span></div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span><span class="comment">//  gPHC = std::make_unique&lt;TGraph&gt;();</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span><span class="comment">//  gPHC_inv = std::make_unique&lt;TGraph&gt;();</span></div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span><span class="comment">//  CalculatePulseHeightCorrection( Ejectile.GetIsotope() );</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span><span class="comment">//</span></div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span><span class="comment">//  // Root finder for the simulation function</span></div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span><span class="comment">//  t.CopyMinimisationFunction( fa );</span></div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span><span class="comment">//  t.CopyMinimisationDerivative( fb );</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span><span class="comment">//  rf = std::make_unique&lt;ROOT::Math::RootFinder&gt;( ROOT::Math::RootFinder::kGSL_NEWTON );</span></div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span><span class="comment">//  rfsim = std::make_unique&lt;ROOT::Math::RootFinder&gt;( ROOT::Math::RootFinder::kGSL_NEWTON );</span></div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span><span class="comment">//  fsim = new TF1( &quot;theta_cm_function&quot;,   theta_cm_function,   0.0, TMath::Pi(), 9 );</span></div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span><span class="comment">//  dsim = new TF1( &quot;theta_cm_derivative&quot;, theta_cm_derivative, 0.0, TMath::Pi(), 9 );</span></div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span><span class="comment">//</span></div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span><span class="comment">//  // TODO: copy the time gates</span></div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span><span class="comment">//</span></div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span><span class="comment">//}</span></div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span> </div>
<div class="foldopen" id="foldopen00307" data-start="{" data-end="}">
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno"><a class="line" href="classISSReaction.html#a95297d2ce63c688a3a8878a4dc5f5e46">  307</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classISSReaction.html#a95297d2ce63c688a3a8878a4dc5f5e46">ISSReaction::AddBindingEnergy</a>( <span class="keywordtype">short</span> Ai, <span class="keywordtype">short</span> Zi, TString ame_be_str ) {</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    </div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    <span class="comment">// A key for the isotope</span></div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    std::string isotope_key;</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    isotope_key = std::to_string( Ai ) + <a class="code hl_variable" href="Reaction_8hh.html#a35cdfd07c72746ef0de43531a2eff02b">gElName</a>.at( Zi );</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>    </div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>    <span class="comment">// Remove # from AME data and replace with decimal point</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    <span class="keywordflow">if</span> ( ame_be_str.Contains(<span class="stringliteral">&quot;#&quot;</span>) )</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>        ame_be_str.ReplaceAll(<span class="stringliteral">&quot;#&quot;</span>,<span class="stringliteral">&quot;.&quot;</span>);</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>    </div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    <span class="comment">// An * means there is no data, fill with a 0</span></div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>    <span class="keywordflow">if</span> ( ame_be_str.Contains(<span class="stringliteral">&quot;*&quot;</span>) )</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        <a class="code hl_variable" href="classISSReaction.html#ae584fb00618d238d9e3012c40e3f1ea4">ame_be</a>.insert( std::make_pair( isotope_key, 0 ) );</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>    </div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>    <span class="comment">// Otherwise add the real data</span></div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>        <a class="code hl_variable" href="classISSReaction.html#ae584fb00618d238d9e3012c40e3f1ea4">ame_be</a>.insert( std::make_pair( isotope_key, ame_be_str.Atof() ) );</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>    </div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>    </div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>}</div>
</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span> </div>
<div class="foldopen" id="foldopen00332" data-start="{" data-end="}">
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno"><a class="line" href="classISSReaction.html#a40017cb95551a1d2045137aca76fd425">  332</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classISSReaction.html#a40017cb95551a1d2045137aca76fd425">ISSReaction::ReadMassTables</a>() {</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>    </div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>    <span class="comment">// Input data file is in the source code</span></div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    <span class="comment">// AME_FILE is passed as a definition at compilation time in Makefile</span></div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    std::ifstream input_file;</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>    input_file.open( <a class="code hl_define" href="Reaction_8hh.html#af7b227b46086539a512daa3acc327be3">AME_FILE</a> );</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    </div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>    std::string line, BE_str, N_str, Z_str;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    std::string startline = <span class="stringliteral">&quot;1N-Z&quot;</span>;</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>    </div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>    <span class="keywordtype">short</span> Ai, Zi, Ni;</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>    </div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>    <span class="comment">// Loop over the file</span></div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    <span class="keywordflow">if</span>( input_file.is_open() ){</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>        </div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>        <span class="comment">// Read first line</span></div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>        std::getline( input_file, line );</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>        </div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>        <span class="comment">// Look for start of data</span></div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>        <span class="keywordflow">while</span>( line.substr( 0, startline.size() ) != startline ){</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>            </div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>            <span class="comment">// Read next line, but break if it&#39;s the end of the file</span></div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>            <span class="keywordflow">if</span>( !std::getline( input_file, line ) ){</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>                </div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;Can&#39;t read mass tables from &quot;</span>;</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>                std::cout &lt;&lt; <a class="code hl_define" href="Reaction_8hh.html#af7b227b46086539a512daa3acc327be3">AME_FILE</a> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>                exit(1);</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>                </div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>            }</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>            </div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>        }</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>        </div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>        <span class="comment">// Read one more nonsense line with the units on</span></div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>        std::getline( input_file, line );</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>        </div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>        <span class="comment">// Now process the data</span></div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>        <span class="keywordflow">while</span>( std::getline( input_file, line ) ){</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>            </div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>            <span class="comment">// Get mass excess from the line</span></div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>            N_str = line.substr( 5, 5 );</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>            Z_str = line.substr( 9, 5 );</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>            BE_str = line.substr( 54, 13 );</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>            </div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>            <span class="comment">// Get N and Z</span></div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>            Ni = std::stoi( N_str );</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>            Zi = std::stoi( Z_str );</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>            Ai = Ni + Zi;</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>            </div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>            <span class="comment">// Add mass value</span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>            <a class="code hl_function" href="classISSReaction.html#a95297d2ce63c688a3a8878a4dc5f5e46">AddBindingEnergy</a>( Ai, Zi, BE_str );</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>            </div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>        }</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>        </div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>    }</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    </div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>        </div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Mass tables file doesn&#39;t exist: &quot;</span> &lt;&lt; <a class="code hl_define" href="Reaction_8hh.html#af7b227b46086539a512daa3acc327be3">AME_FILE</a> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>        exit(1);</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>        </div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    }</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    </div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>    </div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>}</div>
</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="foldopen" id="foldopen00402" data-start="{" data-end="}">
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno"><a class="line" href="classISSReaction.html#a893499127cdda06ebd65b452ce196842">  402</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classISSReaction.html#a893499127cdda06ebd65b452ce196842">ISSReaction::ReadReaction</a>() {</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>    </div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>    TEnv *config = <span class="keyword">new</span> TEnv( <a class="code hl_variable" href="classISSReaction.html#a376b78b49e6539283816c3c3db9e5558">fInputFile</a>.data() );</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>    </div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>    std::string isotope_key;</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>    </div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    <span class="comment">// Magnetic field stuff</span></div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>    <a class="code hl_variable" href="classISSReaction.html#a5a60a17f7906086726d355d9c4cdf5dd">Mfield</a> = config-&gt;GetValue( <span class="stringliteral">&quot;Mfield&quot;</span>, 2.0 );</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>    </div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>    <span class="comment">// Detector to target distances and dead layer of Si</span></div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>    <a class="code hl_variable" href="classISSReaction.html#a024ad9bb0691b6b55faa72a8246f7232">z0</a> = config-&gt;GetValue( <span class="stringliteral">&quot;ArrayDistance&quot;</span>, -100.0 );</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>    <a class="code hl_variable" href="classISSReaction.html#a344c739edf79c6c6e25094cacfca8b28">deadlayer</a> = config-&gt;GetValue( <span class="stringliteral">&quot;ArrayDeadlayer&quot;</span>, 0.0004 ); <span class="comment">// units of mm of Al</span></div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    </div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>    <span class="comment">// Get particle properties</span></div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>    <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#ae28a54b8dda483771cf50e58b6b1aafb">SetA</a>( config-&gt;GetValue( <span class="stringliteral">&quot;BeamA&quot;</span>, 30 ) );</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#a49edeb3017dd90592f00c4d6b8c347f1">SetZ</a>( config-&gt;GetValue( <span class="stringliteral">&quot;BeamZ&quot;</span>, 12 ) );</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>    <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() &lt; 0 || <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() &gt;= (<span class="keywordtype">int</span>)<a class="code hl_variable" href="Reaction_8hh.html#a35cdfd07c72746ef0de43531a2eff02b">gElName</a>.size() ){</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>        </div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Not a recognised element with Z = &quot;</span>;</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>        std::cout &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() &lt;&lt; <span class="stringliteral">&quot; (beam)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>        exit(1);</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>        </div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span>    }</div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>    <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#aa6ea6e3af3e2e18146debfadf908335a">SetBindingEnergy</a>( <a class="code hl_variable" href="classISSReaction.html#ae584fb00618d238d9e3012c40e3f1ea4">ame_be</a>.at( <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>() ) );</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>    </div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>    <a class="code hl_variable" href="classISSReaction.html#acd2c7f71be4c423656d8b0efb606d45b">Eb</a> = config-&gt;GetValue( <span class="stringliteral">&quot;BeamE&quot;</span>, 8520.0 ); <span class="comment">// in keV/u</span></div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    <a class="code hl_variable" href="classISSReaction.html#acd2c7f71be4c423656d8b0efb606d45b">Eb</a> *= <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#a22a34635ef2860c9b6a88af5875d5c43">GetMass_u</a>(); <span class="comment">// keV</span></div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#abafb553ba2ed67375a75e3a864f52842">SetEnergyLab</a>( <a class="code hl_variable" href="classISSReaction.html#acd2c7f71be4c423656d8b0efb606d45b">Eb</a> ); <span class="comment">// keV</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    </div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#ae28a54b8dda483771cf50e58b6b1aafb">SetA</a>( config-&gt;GetValue( <span class="stringliteral">&quot;TargetA&quot;</span>, 2 ) );</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#a49edeb3017dd90592f00c4d6b8c347f1">SetZ</a>( config-&gt;GetValue( <span class="stringliteral">&quot;TargetZ&quot;</span>, 1 ) );</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#abafb553ba2ed67375a75e3a864f52842">SetEnergyLab</a>( 0.0 );</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>    <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() &lt; 0 || <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() &gt;= (<span class="keywordtype">int</span>)<a class="code hl_variable" href="Reaction_8hh.html#a35cdfd07c72746ef0de43531a2eff02b">gElName</a>.size() ){</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>        </div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Not a recognised element with Z = &quot;</span>;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>        std::cout &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() &lt;&lt; <span class="stringliteral">&quot; (target)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>        exit(1);</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>        </div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    }</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#aa6ea6e3af3e2e18146debfadf908335a">SetBindingEnergy</a>( <a class="code hl_variable" href="classISSReaction.html#ae584fb00618d238d9e3012c40e3f1ea4">ame_be</a>.at( <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>() ) );</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    </div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ae28a54b8dda483771cf50e58b6b1aafb">SetA</a>( config-&gt;GetValue( <span class="stringliteral">&quot;EjectileA&quot;</span>, 1 ) );</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a49edeb3017dd90592f00c4d6b8c347f1">SetZ</a>( config-&gt;GetValue( <span class="stringliteral">&quot;EjectileZ&quot;</span>, 1 ) );</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>    <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() &lt; 0 || <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() &gt;= (<span class="keywordtype">int</span>)<a class="code hl_variable" href="Reaction_8hh.html#a35cdfd07c72746ef0de43531a2eff02b">gElName</a>.size() ){</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>        </div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Not a recognised element with Z = &quot;</span>;</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>        std::cout &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() &lt;&lt; <span class="stringliteral">&quot; (ejectile)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>        exit(1);</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>        </div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    }</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#aa6ea6e3af3e2e18146debfadf908335a">SetBindingEnergy</a>( <a class="code hl_variable" href="classISSReaction.html#ae584fb00618d238d9e3012c40e3f1ea4">ame_be</a>.at( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>() ) );</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>    </div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>    <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#ae28a54b8dda483771cf50e58b6b1aafb">SetA</a>( config-&gt;GetValue( <span class="stringliteral">&quot;RecoilA&quot;</span>, 31 ) );</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>    <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a49edeb3017dd90592f00c4d6b8c347f1">SetZ</a>( config-&gt;GetValue( <span class="stringliteral">&quot;RecoilZ&quot;</span>, 12 ) );</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>    <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() &lt; 0 || <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() &gt;= (<span class="keywordtype">int</span>)<a class="code hl_variable" href="Reaction_8hh.html#a35cdfd07c72746ef0de43531a2eff02b">gElName</a>.size() ){</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>        </div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Not a recognised element with Z = &quot;</span>;</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>        std::cout &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() &lt;&lt; <span class="stringliteral">&quot; (recoil)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>        exit(1);</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>        </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>    }</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#aa6ea6e3af3e2e18146debfadf908335a">SetBindingEnergy</a>( <a class="code hl_variable" href="classISSReaction.html#ae584fb00618d238d9e3012c40e3f1ea4">ame_be</a>.at( <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>() ) );</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>    </div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>    <span class="comment">// Get recoil energy cut</span></div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>    <a class="code hl_variable" href="classISSReaction.html#ac912744a547580b017ac078ab88cb597">nrecoilcuts</a> = <a class="code hl_variable" href="classISSReaction.html#a35b6c40984615e7195549ff27492a3ed">set</a>-&gt;GetNumberOfRecoilSectors();</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>    <a class="code hl_variable" href="classISSReaction.html#a3519ad8827535df9af318cb271c2788a">recoil_cut</a>.resize( <a class="code hl_variable" href="classISSReaction.html#ac912744a547580b017ac078ab88cb597">nrecoilcuts</a> );</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>    <a class="code hl_variable" href="classISSReaction.html#adb9512f5ccfd619926bdeca3390f6c39">recoilcutfile</a>.resize( <a class="code hl_variable" href="classISSReaction.html#ac912744a547580b017ac078ab88cb597">nrecoilcuts</a> );</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>    <a class="code hl_variable" href="classISSReaction.html#aee8d77de7342c200a7576b281236825a">recoilcutname</a>.resize( <a class="code hl_variable" href="classISSReaction.html#ac912744a547580b017ac078ab88cb597">nrecoilcuts</a> );</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classISSReaction.html#ac912744a547580b017ac078ab88cb597">nrecoilcuts</a>; ++i ) {</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>        </div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>        <a class="code hl_variable" href="classISSReaction.html#adb9512f5ccfd619926bdeca3390f6c39">recoilcutfile</a>.at(i) = config-&gt;GetValue( Form( <span class="stringliteral">&quot;RecoilCut_%d.File&quot;</span>, i ), <span class="stringliteral">&quot;NULL&quot;</span> );</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>        <a class="code hl_variable" href="classISSReaction.html#aee8d77de7342c200a7576b281236825a">recoilcutname</a>.at(i) = config-&gt;GetValue( Form( <span class="stringliteral">&quot;RecoilCut_%d.Name&quot;</span>, i ), <span class="stringliteral">&quot;CUTG&quot;</span> );</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>        </div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>        <span class="comment">// Check if it is given by the user</span></div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>        <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#adb9512f5ccfd619926bdeca3390f6c39">recoilcutfile</a>.at(i) != <span class="stringliteral">&quot;NULL&quot;</span> ) {</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>            </div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>            TFile *recoil_file = <span class="keyword">new</span> TFile( <a class="code hl_variable" href="classISSReaction.html#adb9512f5ccfd619926bdeca3390f6c39">recoilcutfile</a>.at(i).data(), <span class="stringliteral">&quot;READ&quot;</span> );</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>            <span class="keywordflow">if</span>( recoil_file-&gt;IsZombie() )</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t open &quot;</span> &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#adb9512f5ccfd619926bdeca3390f6c39">recoilcutfile</a>.at(i) &lt;&lt; <span class="stringliteral">&quot; correctly&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>            </div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>                </div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>                <span class="keywordflow">if</span>( !recoil_file-&gt;GetListOfKeys()-&gt;Contains( <a class="code hl_variable" href="classISSReaction.html#aee8d77de7342c200a7576b281236825a">recoilcutname</a>.at(i).data() ) )</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t find &quot;</span> &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#aee8d77de7342c200a7576b281236825a">recoilcutname</a>.at(i) &lt;&lt; <span class="stringliteral">&quot; in &quot;</span> &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#adb9512f5ccfd619926bdeca3390f6c39">recoilcutfile</a>.at(i) &lt;&lt; std::endl;</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>                    <a class="code hl_variable" href="classISSReaction.html#a3519ad8827535df9af318cb271c2788a">recoil_cut</a>.at(i) = std::make_shared&lt;TCutG&gt;( *<span class="keyword">static_cast&lt;</span>TCutG*<span class="keyword">&gt;</span>( recoil_file-&gt;Get( <a class="code hl_variable" href="classISSReaction.html#aee8d77de7342c200a7576b281236825a">recoilcutname</a>.at(i).data() )-&gt;Clone() ) );</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>                </div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>            }</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>            </div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span>            recoil_file-&gt;Close();</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>            </div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>        }</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>        </div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>        <span class="comment">// Assign an empty cut file if none is given, so the code doesn&#39;t crash</span></div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>        <span class="keywordflow">if</span>( !<a class="code hl_variable" href="classISSReaction.html#a3519ad8827535df9af318cb271c2788a">recoil_cut</a>.at(i) ) <a class="code hl_variable" href="classISSReaction.html#a3519ad8827535df9af318cb271c2788a">recoil_cut</a>.at(i) = std::make_shared&lt;TCutG&gt;();</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>        </div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>    }</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>    </div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>    <span class="comment">// Get E versus z cuts</span></div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>    <a class="code hl_variable" href="classISSReaction.html#acd39d4d715b6635ebc1548872210b007">nevszcuts</a> = config-&gt;GetValue( <span class="stringliteral">&quot;NumberOfEvsZCuts&quot;</span>, 1 );</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>    <a class="code hl_variable" href="classISSReaction.html#ad84c32fc1188533e5da2ee8407cc13af">e_vs_z_cut</a>.resize( <a class="code hl_variable" href="classISSReaction.html#acd39d4d715b6635ebc1548872210b007">nevszcuts</a> );</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>    <a class="code hl_variable" href="classISSReaction.html#ab8e40b35d77220f697c8a46fee95522f">evszcutfile</a>.resize( <a class="code hl_variable" href="classISSReaction.html#acd39d4d715b6635ebc1548872210b007">nevszcuts</a> );</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>    <a class="code hl_variable" href="classISSReaction.html#a04a1fd09e0469d805fa94df73765dec6">evszcutname</a>.resize( <a class="code hl_variable" href="classISSReaction.html#acd39d4d715b6635ebc1548872210b007">nevszcuts</a> );</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="classISSReaction.html#acd39d4d715b6635ebc1548872210b007">nevszcuts</a>; ++i ) {</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>        </div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>        <a class="code hl_variable" href="classISSReaction.html#ab8e40b35d77220f697c8a46fee95522f">evszcutfile</a>.at(i) = config-&gt;GetValue( Form( <span class="stringliteral">&quot;EvsZCut_%d.File&quot;</span>, i ), <span class="stringliteral">&quot;NULL&quot;</span> );</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>        <a class="code hl_variable" href="classISSReaction.html#a04a1fd09e0469d805fa94df73765dec6">evszcutname</a>.at(i) = config-&gt;GetValue( Form( <span class="stringliteral">&quot;EvsZCut_%d.Name&quot;</span>, i ), <span class="stringliteral">&quot;CUTG&quot;</span> );</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>        </div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>        <span class="comment">// Check if it is given by the user</span></div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span>        <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#ab8e40b35d77220f697c8a46fee95522f">evszcutfile</a>.at(i) != <span class="stringliteral">&quot;NULL&quot;</span> ) {</div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>            </div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>            TFile *e_vs_z_file = <span class="keyword">new</span> TFile( <a class="code hl_variable" href="classISSReaction.html#ab8e40b35d77220f697c8a46fee95522f">evszcutfile</a>.at(i).data(), <span class="stringliteral">&quot;READ&quot;</span> );</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>            <span class="keywordflow">if</span>( e_vs_z_file-&gt;IsZombie() )</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t open &quot;</span> &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#ab8e40b35d77220f697c8a46fee95522f">evszcutfile</a>.at(i) &lt;&lt; <span class="stringliteral">&quot; correctly&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>            </div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>                </div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>                <span class="keywordflow">if</span>( !e_vs_z_file-&gt;GetListOfKeys()-&gt;Contains( <a class="code hl_variable" href="classISSReaction.html#a04a1fd09e0469d805fa94df73765dec6">evszcutname</a>.at(i).data() ) )</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>                    std::cout &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t find &quot;</span> &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#a04a1fd09e0469d805fa94df73765dec6">evszcutname</a>.at(i) &lt;&lt; <span class="stringliteral">&quot; in &quot;</span> &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#ab8e40b35d77220f697c8a46fee95522f">evszcutfile</a>.at(i) &lt;&lt; std::endl;</div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>                <span class="keywordflow">else</span></div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>                    <a class="code hl_variable" href="classISSReaction.html#ad84c32fc1188533e5da2ee8407cc13af">e_vs_z_cut</a>.at(i) = std::make_shared&lt;TCutG&gt;( *<span class="keyword">static_cast&lt;</span>TCutG*<span class="keyword">&gt;</span>( e_vs_z_file-&gt;Get( <a class="code hl_variable" href="classISSReaction.html#a04a1fd09e0469d805fa94df73765dec6">evszcutname</a>.at(i).data() )-&gt;Clone() ) );</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>                </div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>            }</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>            </div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>            e_vs_z_file-&gt;Close();</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>            </div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>        }</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>        </div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>        <span class="comment">// Assign an empty cut file if none is given, so the code doesn&#39;t crash</span></div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>        <span class="keywordflow">if</span>( !<a class="code hl_variable" href="classISSReaction.html#ad84c32fc1188533e5da2ee8407cc13af">e_vs_z_cut</a>.at(i) ) <a class="code hl_variable" href="classISSReaction.html#ad84c32fc1188533e5da2ee8407cc13af">e_vs_z_cut</a>.at(i) = std::make_shared&lt;TCutG&gt;();</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>        </div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>    }</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>    </div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>    <span class="comment">// EBIS time window</span></div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>    <span class="keywordtype">double</span> tmp_on = config-&gt;GetValue( <span class="stringliteral">&quot;EBIS.On&quot;</span>, 1.2e6 );       <span class="comment">// normally 1.2 ms in slow extraction</span></div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span>    <span class="keywordtype">double</span> tmp_off = config-&gt;GetValue( <span class="stringliteral">&quot;EBIS.Off&quot;</span>, 2.52e7 );    <span class="comment">// this allows an off window 20 times bigger than on</span></div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>    <a class="code hl_variable" href="classISSReaction.html#afa52f1d5e98b64c32f5931bb4e7a38fe">EBIS_On</a> = config-&gt;GetValue( <span class="stringliteral">&quot;EBIS_On&quot;</span>, tmp_on );    <span class="comment">// backwards compatibility</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>    <a class="code hl_variable" href="classISSReaction.html#a9d0dc889d9edd419b9aa99fa0ae38cbb">EBIS_Off</a> = config-&gt;GetValue( <span class="stringliteral">&quot;EBIS_Off&quot;</span>, tmp_off ); <span class="comment">// backwards compatibility window 20 times bigger than on</span></div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>    <a class="code hl_variable" href="classISSReaction.html#a1306203fa1f40d6541fdc4c2e052b8a0">EBIS_ratio</a> = config-&gt;GetValue( <span class="stringliteral">&quot;EBIS.FillRatio&quot;</span>, <a class="code hl_function" href="classISSReaction.html#aa37e457510dc2ef79dbe6c36dd8e4a9f">GetEBISTimeRatio</a>() );  <span class="comment">// this is the measured ratio of EBIS On/off. Default is just the time window ratio</span></div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>    </div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>    <span class="comment">// T1 time window</span></div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>    <a class="code hl_variable" href="classISSReaction.html#af675ea3ac3749a12c0e7bb6b05c1657b">t1_min_time</a> = config-&gt;GetValue( <span class="stringliteral">&quot;T1.Min&quot;</span>, 0.0 );    <span class="comment">// default = 0</span></div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>    <a class="code hl_variable" href="classISSReaction.html#abab36c9b636d932ce4fa0382cb9450ab">t1_max_time</a> = config-&gt;GetValue( <span class="stringliteral">&quot;T1.Max&quot;</span>, 1.2e9 );  <span class="comment">// default = 1.2 seconds</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>    </div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>    <span class="comment">// Laser mode: 0 = off, 1 = on, 2 = on/off (default)</span></div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>    <a class="code hl_variable" href="classISSReaction.html#ab91898a11ed53a3150f9c3809e2f2001">laser_mode</a> = config-&gt;GetValue( <span class="stringliteral">&quot;LaserMode&quot;</span>, 2 );</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>    </div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>    <span class="comment">// Histogramming options</span></div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span>    <a class="code hl_variable" href="classISSReaction.html#a874a6794d00162864859e686147fa1e9">array_hist_mode</a> = config-&gt;GetValue( <span class="stringliteral">&quot;Hists.ArrayMode&quot;</span>, 0 ); <span class="comment">// default = 0 (require n-side), others: 1 (p-side only)</span></div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>    <a class="code hl_variable" href="classISSReaction.html#a3e37d91233f4c426a6a2ced39c6f5632">rxtree_flag</a> = config-&gt;GetValue( <span class="stringliteral">&quot;Hists.OutputTree&quot;</span>, 0 ); <span class="comment">// default = 0 (off); 1 or true to enable the output tree</span></div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span> </div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>    </div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>    <span class="comment">// Array-Recoil time windows</span></div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>    <a class="code hl_variable" href="classISSReaction.html#a71000771f2de3911b1c2e83006b70372">array_recoil_prompt</a>[0] = config-&gt;GetValue( <span class="stringliteral">&quot;ArrayRecoil_PromptTime.Min&quot;</span>, -300 );    <span class="comment">// lower limit for array-recoil prompt time difference</span></div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>    <a class="code hl_variable" href="classISSReaction.html#a71000771f2de3911b1c2e83006b70372">array_recoil_prompt</a>[1] = config-&gt;GetValue( <span class="stringliteral">&quot;ArrayRecoil_PromptTime.Max&quot;</span>, 300 );     <span class="comment">// upper limit for array-recoil prompt time difference</span></div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>    <a class="code hl_variable" href="classISSReaction.html#a548c7232ebd368f5f6c237bd4179cbdf">array_recoil_random</a>[0] = config-&gt;GetValue( <span class="stringliteral">&quot;ArrayRecoil_RandomTime.Min&quot;</span>, 600 );     <span class="comment">// lower limit for array-recoil random time difference</span></div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>    <a class="code hl_variable" href="classISSReaction.html#a548c7232ebd368f5f6c237bd4179cbdf">array_recoil_random</a>[1] = config-&gt;GetValue( <span class="stringliteral">&quot;ArrayRecoil_RandomTime.Max&quot;</span>, 1200 );    <span class="comment">// upper limit for array-recoil random time difference</span></div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>    </div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>    <span class="comment">// Array-Recoil fill ratios</span></div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>    <a class="code hl_variable" href="classISSReaction.html#a6dbed1a57a850eae76bd9c0275dfe7f3">array_recoil_ratio</a> = config-&gt;GetValue( <span class="stringliteral">&quot;ArrayRecoil_FillRatio&quot;</span>, <a class="code hl_function" href="classISSReaction.html#ae05f6c7c66ad83124da9617d7d3342ba">GetArrayRecoilTimeRatio</a>() );</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>    </div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>    <span class="comment">// ELUM-Recoil time windows</span></div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>    <a class="code hl_variable" href="classISSReaction.html#a2d20defa409a7ba5aeab76ae4aaf5ec0">elum_recoil_prompt</a>[0] = config-&gt;GetValue( <span class="stringliteral">&quot;ElumRecoil_PromptTime.Min&quot;</span>, -300 );  <span class="comment">// lower limit for array-recoil prompt time difference</span></div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>    <a class="code hl_variable" href="classISSReaction.html#a2d20defa409a7ba5aeab76ae4aaf5ec0">elum_recoil_prompt</a>[1] = config-&gt;GetValue( <span class="stringliteral">&quot;ElumRecoil_PromptTime.Max&quot;</span>, 300 );       <span class="comment">// upper limit for array-recoil prompt time difference</span></div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>    <a class="code hl_variable" href="classISSReaction.html#aea5baed953c7ad206f2bb7fc951baf1a">elum_recoil_random</a>[0] = config-&gt;GetValue( <span class="stringliteral">&quot;ElumRecoil_RandomTime.Min&quot;</span>, 600 );       <span class="comment">// lower limit for array-recoil random time difference</span></div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>    <a class="code hl_variable" href="classISSReaction.html#aea5baed953c7ad206f2bb7fc951baf1a">elum_recoil_random</a>[1] = config-&gt;GetValue( <span class="stringliteral">&quot;ElumRecoil_RandomTime.Max&quot;</span>, 1200 );  <span class="comment">// upper limit for array-recoil random time difference</span></div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>    </div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>    <span class="comment">// ELUM-Recoil fill ratios</span></div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>    <a class="code hl_variable" href="classISSReaction.html#a36c61a67fd69cd78d0800da598f730ce">elum_recoil_ratio</a> = config-&gt;GetValue( <span class="stringliteral">&quot;ElumRecoil_FillRatio&quot;</span>, <a class="code hl_function" href="classISSReaction.html#a607c106d914e9619cbee5351ea8fa437">GetElumRecoilTimeRatio</a>() );</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>    </div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>    <span class="comment">// Target thickness and offsets</span></div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    <a class="code hl_variable" href="classISSReaction.html#aafcc62d779e00337aa5defd11d6abc3d">target_thickness</a> = config-&gt;GetValue( <span class="stringliteral">&quot;TargetThickness&quot;</span>, 0.200 ); <span class="comment">// units of mg/cm^2</span></div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>    <a class="code hl_variable" href="classISSReaction.html#ab5d66ec25b61e0b6a6a0c3590b007fef">x_offset</a> = config-&gt;GetValue( <span class="stringliteral">&quot;TargetOffset.X&quot;</span>, 0.0 );   <span class="comment">// of course this should be 0.0 if you centre the beam! Units of mm, vertical</span></div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    <a class="code hl_variable" href="classISSReaction.html#ad74e98af4ec57c4319a57d7d30d28475">y_offset</a> = config-&gt;GetValue( <span class="stringliteral">&quot;TargetOffset.Y&quot;</span>, 0.0 );   <span class="comment">// of course this should be 0.0 if you centre the beam! Units of mm, horizontal</span></div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>    </div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>    <span class="comment">// ELUM geometry</span></div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>    <a class="code hl_variable" href="classISSReaction.html#af0020ca1f58ef4bc2bfd2da5e6be56f5">elum_z</a>          = config-&gt;GetValue( <span class="stringliteral">&quot;ELUM.Distance&quot;</span>, -1.0 ); <span class="comment">// units of mm</span></div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>    <a class="code hl_variable" href="classISSReaction.html#a1380ab0fc0280a85824c4a9e48b5900e">elum_rin</a>        = config-&gt;GetValue( <span class="stringliteral">&quot;ELUM.InnerRadius&quot;</span>, 24.0 ); <span class="comment">// units of mm</span></div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>    <a class="code hl_variable" href="classISSReaction.html#ab41c921c55f7ff81e0faa8466c3cc160">elum_rout</a>       = config-&gt;GetValue( <span class="stringliteral">&quot;ELUM.OuterRadius&quot;</span>, 48.0 ); <span class="comment">// units of mm</span></div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>    <a class="code hl_variable" href="classISSReaction.html#a33a6620f6b099925581e883a1f6cf304">elum_deadlayer</a>  = config-&gt;GetValue( <span class="stringliteral">&quot;ELUM.Deadlayer&quot;</span>, 0.00095 ); <span class="comment">// units of mm of Si equivalent</span></div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>    </div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>    <span class="comment">// If it&#39;s a source run, we can ignore most of that</span></div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    <span class="comment">// or better still, initialise everything and overwrite what we need</span></div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>    <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#aa6d60a463ad5e3a9ab70adf3a7d4929f">flag_source</a> ){</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>        </div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>        <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ae28a54b8dda483771cf50e58b6b1aafb">SetA</a>(4);</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>        <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a49edeb3017dd90592f00c4d6b8c347f1">SetZ</a>(2);</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>        <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#aa6ea6e3af3e2e18146debfadf908335a">SetBindingEnergy</a>( <a class="code hl_variable" href="classISSReaction.html#ae584fb00618d238d9e3012c40e3f1ea4">ame_be</a>.at( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>() ) );</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>        <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#abafb553ba2ed67375a75e3a864f52842">SetEnergyLab</a>(0.0); <span class="comment">// prevent any CM/Lab transformation</span></div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>        <a class="code hl_variable" href="classISSReaction.html#aafcc62d779e00337aa5defd11d6abc3d">target_thickness</a> = 0.0; <span class="comment">// no energy loss in target/source?</span></div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>        </div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>    }</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>    </div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>    <span class="comment">// Get the stopping powers in TGraphs</span></div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>    <a class="code hl_variable" href="classISSReaction.html#a9cfe688464099d479b5a299e89378783">stopping</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; 6; ++i ) {</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>        <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>.push_back( std::make_unique&lt;TGraph&gt;() );</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>        <a class="code hl_variable" href="classISSReaction.html#ab046d9c215f2be2f43f3af6d2cb3fcc4">gRange</a>.push_back( std::make_unique&lt;TGraph&gt;() );</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>    }</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>    </div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>    <span class="keywordflow">if</span>( !<a class="code hl_variable" href="classISSReaction.html#aa6d60a463ad5e3a9ab70adf3a7d4929f">flag_source</a> ) {</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>        <a class="code hl_variable" href="classISSReaction.html#a9cfe688464099d479b5a299e89378783">stopping</a> &amp;= <a class="code hl_function" href="classISSReaction.html#ab3971fa9b0c406b88590283d27710cf7">ReadStoppingPowers</a>( <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>(), <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>(), <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[0], <a class="code hl_variable" href="classISSReaction.html#ab046d9c215f2be2f43f3af6d2cb3fcc4">gRange</a>[0] );</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>        <a class="code hl_variable" href="classISSReaction.html#a9cfe688464099d479b5a299e89378783">stopping</a> &amp;= <a class="code hl_function" href="classISSReaction.html#ab3971fa9b0c406b88590283d27710cf7">ReadStoppingPowers</a>( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>(), <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>(), <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[1], <a class="code hl_variable" href="classISSReaction.html#ab046d9c215f2be2f43f3af6d2cb3fcc4">gRange</a>[1] );</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>    }</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>    <a class="code hl_variable" href="classISSReaction.html#a9cfe688464099d479b5a299e89378783">stopping</a> &amp;= <a class="code hl_function" href="classISSReaction.html#ab3971fa9b0c406b88590283d27710cf7">ReadStoppingPowers</a>( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>(), <span class="stringliteral">&quot;Al&quot;</span>, <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[2], <a class="code hl_variable" href="classISSReaction.html#ab046d9c215f2be2f43f3af6d2cb3fcc4">gRange</a>[2] );</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>    </div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>    <span class="comment">// Get the electric and nuclear stopping powers for the PHC in a TGraph</span></div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>    <a class="code hl_variable" href="classISSReaction.html#a6a3030f5c356fe2df1db672ed72e2bd9">phcurves</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>    <a class="code hl_variable" href="classISSReaction.html#a6a3030f5c356fe2df1db672ed72e2bd9">phcurves</a> &amp;= <a class="code hl_function" href="classISSReaction.html#ab3971fa9b0c406b88590283d27710cf7">ReadStoppingPowers</a>( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>(), <span class="stringliteral">&quot;Si&quot;</span>, <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[3], <a class="code hl_variable" href="classISSReaction.html#ab046d9c215f2be2f43f3af6d2cb3fcc4">gRange</a>[3], <span class="keyword">true</span>, <span class="keyword">false</span> ); <span class="comment">// electric only from SRIM files</span></div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>    <a class="code hl_variable" href="classISSReaction.html#a6a3030f5c356fe2df1db672ed72e2bd9">phcurves</a> &amp;= <a class="code hl_function" href="classISSReaction.html#ab3971fa9b0c406b88590283d27710cf7">ReadStoppingPowers</a>( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>(), <span class="stringliteral">&quot;Si&quot;</span>, <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[4], <a class="code hl_variable" href="classISSReaction.html#ab046d9c215f2be2f43f3af6d2cb3fcc4">gRange</a>[4], <span class="keyword">false</span>, <span class="keyword">true</span> ); <span class="comment">// nuclear only from SRIM files</span></div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>    <a class="code hl_variable" href="classISSReaction.html#a6a3030f5c356fe2df1db672ed72e2bd9">phcurves</a> &amp;= <a class="code hl_function" href="classISSReaction.html#ab3971fa9b0c406b88590283d27710cf7">ReadStoppingPowers</a>( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>(), <span class="stringliteral">&quot;Si&quot;</span>, <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[5], <a class="code hl_variable" href="classISSReaction.html#ab046d9c215f2be2f43f3af6d2cb3fcc4">gRange</a>[5] );              <span class="comment">// total stopping from SRIM files</span></div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>    </div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>    <span class="comment">// Get the PHC data in a TGraph</span></div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>    <a class="code hl_variable" href="classISSReaction.html#a49f9b17ebdb624e42438bf555afd262a">gPHC</a> = std::make_unique&lt;TGraph&gt;();</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>    <a class="code hl_variable" href="classISSReaction.html#a0d8699a45c40e404ad7dfbd7b221ed7a">gPHC_inv</a> = std::make_unique&lt;TGraph&gt;();</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>    <a class="code hl_function" href="classISSReaction.html#a02b9af4c92541a2dd44e20169ed0447b">CalculatePulseHeightCorrection</a>( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>() );</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>    </div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>    <span class="comment">// Some diagnostics and info</span></div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>    <span class="keywordflow">if</span>( !<a class="code hl_variable" href="classISSReaction.html#aa6d60a463ad5e3a9ab70adf3a7d4929f">flag_source</a> ) {</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>        </div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>        std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot; +++  &quot;</span>;</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>        std::cout &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>() &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>() &lt;&lt; <span class="stringliteral">&quot;,&quot;</span>;</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>        std::cout &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>() &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">GetIsotope</a>();</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;  +++&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Q-value = &quot;</span> &lt;&lt; <a class="code hl_function" href="classISSReaction.html#a35f8209fb91d3decb1a1e582d64c8b4b">GetQvalue</a>()*0.001 &lt;&lt; <span class="stringliteral">&quot; MeV&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Incoming beam energy = &quot;</span>;</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>        std::cout &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>()*0.001 &lt;&lt; <span class="stringliteral">&quot; MeV&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Target thickness = &quot;</span>;</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>        std::cout &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#aafcc62d779e00337aa5defd11d6abc3d">target_thickness</a> &lt;&lt; <span class="stringliteral">&quot; mg/cm^2&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>        </div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>    }</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>    <span class="keywordflow">else</span> std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot; +++  Alpha Source Run  +++&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    </div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>    <span class="comment">// Calculate the energy loss</span></div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>    <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#a9cfe688464099d479b5a299e89378783">stopping</a> ){</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>        </div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>        <span class="comment">// But only if it&#39;s not a source run</span></div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>        <span class="keywordflow">if</span>( !<a class="code hl_variable" href="classISSReaction.html#aa6d60a463ad5e3a9ab70adf3a7d4929f">flag_source</a> ) {</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span>            </div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>            <span class="keywordtype">double</span> eloss = <a class="code hl_function" href="classISSReaction.html#a7e33613ce6e80c530333cf96aac9a340">GetEnergyLoss</a>( <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>(), 0.5 * <a class="code hl_variable" href="classISSReaction.html#aafcc62d779e00337aa5defd11d6abc3d">target_thickness</a>, <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[0] );</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>            <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#abafb553ba2ed67375a75e3a864f52842">SetEnergyLab</a>( <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>() - eloss );</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;Beam energy at centre of target = &quot;</span>;</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>            std::cout &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>()*0.001 &lt;&lt; <span class="stringliteral">&quot; MeV&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>            </div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>        }</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>        </div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    }</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>    <span class="keywordflow">else</span> std::cout &lt;&lt; <span class="stringliteral">&quot;Stopping powers not calculated&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>    </div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>    </div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>    <span class="comment">// Do some ELUM calculations</span></div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>    <span class="keywordtype">double</span> theta_cm_inner,  theta_cm_outer,  theta_cm_centre;</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>    <span class="keywordtype">double</span> theta_lab_inner, theta_lab_outer, theta_lab_centre;</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>    <span class="keywordtype">double</span> energy_inner,    energy_outer,    energy_centre;</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>    <span class="keywordtype">double</span> enloss_inner,    enloss_outer,    enloss_centre;</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>    <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#af0020ca1f58ef4bc2bfd2da5e6be56f5">elum_z</a> &gt; 0 &amp;&amp; !<a class="code hl_variable" href="classISSReaction.html#aa6d60a463ad5e3a9ab70adf3a7d4929f">flag_source</a> ) {</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>        </div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>        <span class="comment">// Remember the real ejectile information</span></div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>        <span class="keywordtype">int</span> tmpA = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a73d728c684110e70aca43354ffd6cc9f">GetA</a>();</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>        <span class="keywordtype">int</span> tmpZ = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>();</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>        <span class="keywordtype">double</span> tmpBE = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a02d0437ad0bda323e37046aeb6147eb4">GetBindingEnergy</a>();</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>        <span class="keywordtype">int</span> tmpA2 = <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a73d728c684110e70aca43354ffd6cc9f">GetA</a>();</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>        <span class="keywordtype">int</span> tmpZ2 = <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>();</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>        <span class="keywordtype">double</span> tmpBE2 = <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a02d0437ad0bda323e37046aeb6147eb4">GetBindingEnergy</a>();</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>        </div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>        <span class="comment">// Then pretend we have elastic scattering</span></div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>        <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ae28a54b8dda483771cf50e58b6b1aafb">SetA</a>( <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#a73d728c684110e70aca43354ffd6cc9f">GetA</a>() );</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>        <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a49edeb3017dd90592f00c4d6b8c347f1">SetZ</a>( <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() );</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>        <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#aa6ea6e3af3e2e18146debfadf908335a">SetBindingEnergy</a>( <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#a02d0437ad0bda323e37046aeb6147eb4">GetBindingEnergy</a>() );</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>        <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#ae28a54b8dda483771cf50e58b6b1aafb">SetA</a>( <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#a73d728c684110e70aca43354ffd6cc9f">GetA</a>() );</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>        <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a49edeb3017dd90592f00c4d6b8c347f1">SetZ</a>( <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() );</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>        <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#aa6ea6e3af3e2e18146debfadf908335a">SetBindingEnergy</a>( <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#a02d0437ad0bda323e37046aeb6147eb4">GetBindingEnergy</a>() );</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>        </div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>        <span class="comment">//std::cout &lt;&lt; std::endl &lt;&lt; &quot; +++  &quot;;</span></div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>        <span class="comment">//std::cout &lt;&lt; Beam.GetIsotope() &lt;&lt; &quot;(&quot; &lt;&lt; Target.GetIsotope() &lt;&lt; &quot;,&quot;;</span></div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>        <span class="comment">//std::cout &lt;&lt; Ejectile.GetIsotope() &lt;&lt; &quot;)&quot; &lt;&lt; Recoil.GetIsotope();</span></div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>        <span class="comment">//std::cout &lt;&lt; &quot;  +++&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>        <span class="comment">//std::cout &lt;&lt; &quot;Q-value = &quot; &lt;&lt; GetQvalue()*0.001 &lt;&lt; &quot; MeV&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>        </div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span>        <span class="comment">// Define interaction position of the inner/outer edges and centre</span></div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>        TVector3 elum_inner_hit( <a class="code hl_variable" href="classISSReaction.html#a1380ab0fc0280a85824c4a9e48b5900e">elum_rin</a>,  0.0, <a class="code hl_variable" href="classISSReaction.html#af0020ca1f58ef4bc2bfd2da5e6be56f5">elum_z</a> );</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>        TVector3 elum_outer_hit( <a class="code hl_variable" href="classISSReaction.html#ab41c921c55f7ff81e0faa8466c3cc160">elum_rout</a>, 0.0, <a class="code hl_variable" href="classISSReaction.html#af0020ca1f58ef4bc2bfd2da5e6be56f5">elum_z</a> );</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>        TVector3 elum_centre_hit( 0.5*(<a class="code hl_variable" href="classISSReaction.html#ab41c921c55f7ff81e0faa8466c3cc160">elum_rout</a>+<a class="code hl_variable" href="classISSReaction.html#a1380ab0fc0280a85824c4a9e48b5900e">elum_rin</a>), 0.0, <a class="code hl_variable" href="classISSReaction.html#af0020ca1f58ef4bc2bfd2da5e6be56f5">elum_z</a> );</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>        </div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>        <span class="comment">// Simulate the elastic scattering reaction - inner</span></div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>        <a class="code hl_function" href="classISSReaction.html#a4241c6500ce557254dfcbeadb1e60cdb">SimulateReaction</a>( elum_inner_hit );</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>        theta_cm_inner  = <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a16942178bd108e04c0d3766e09c8df54">GetThetaCM</a>();</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>        theta_lab_inner = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac2d9c9dbfe276acc8006766ceb30796b">GetThetaLab</a>();</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>        energy_inner = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>();</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>        enloss_inner = <a class="code hl_function" href="classISSReaction.html#a7e33613ce6e80c530333cf96aac9a340">GetEnergyLoss</a>( energy_inner,</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>                                     <a class="code hl_variable" href="classISSReaction.html#a33a6620f6b099925581e883a1f6cf304">elum_deadlayer</a> / TMath::Abs( TMath::Cos( theta_lab_inner ) ),</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>                                     <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[2] );</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>        </div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>        <span class="comment">// Simulate the elastic scattering reaction - outer</span></div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>        <a class="code hl_function" href="classISSReaction.html#a4241c6500ce557254dfcbeadb1e60cdb">SimulateReaction</a>( elum_outer_hit );</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>        theta_cm_outer  = <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a16942178bd108e04c0d3766e09c8df54">GetThetaCM</a>();</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>        theta_lab_outer = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac2d9c9dbfe276acc8006766ceb30796b">GetThetaLab</a>();</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>        energy_outer = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>();</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>        enloss_outer = <a class="code hl_function" href="classISSReaction.html#a7e33613ce6e80c530333cf96aac9a340">GetEnergyLoss</a>( energy_outer,</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>                                     <a class="code hl_variable" href="classISSReaction.html#a33a6620f6b099925581e883a1f6cf304">elum_deadlayer</a> / TMath::Abs( TMath::Cos( theta_lab_outer ) ),</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>                                     <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[2] );</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>        </div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>        <span class="comment">// Simulate the elastic scattering reaction - centre</span></div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>        <a class="code hl_function" href="classISSReaction.html#a4241c6500ce557254dfcbeadb1e60cdb">SimulateReaction</a>( elum_centre_hit );</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>        theta_cm_centre  = <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a16942178bd108e04c0d3766e09c8df54">GetThetaCM</a>();</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>        theta_lab_centre = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac2d9c9dbfe276acc8006766ceb30796b">GetThetaLab</a>();</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>        energy_centre = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>();</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>        enloss_centre = <a class="code hl_function" href="classISSReaction.html#a7e33613ce6e80c530333cf96aac9a340">GetEnergyLoss</a>( energy_centre,</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>                                      <a class="code hl_variable" href="classISSReaction.html#a33a6620f6b099925581e883a1f6cf304">elum_deadlayer</a> / TMath::Abs( TMath::Cos( theta_lab_centre ) ),</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>                                      <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[2] );</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>        </div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>        <span class="comment">// Change ejectile and recoils back again</span></div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>        <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ae28a54b8dda483771cf50e58b6b1aafb">SetA</a>( tmpA );</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>        <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a49edeb3017dd90592f00c4d6b8c347f1">SetZ</a>( tmpZ );</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>        <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#aa6ea6e3af3e2e18146debfadf908335a">SetBindingEnergy</a>( tmpBE );</div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>        <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#ae28a54b8dda483771cf50e58b6b1aafb">SetA</a>( tmpA2 );</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>        <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a49edeb3017dd90592f00c4d6b8c347f1">SetZ</a>( tmpZ2 );</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>        <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#aa6ea6e3af3e2e18146debfadf908335a">SetBindingEnergy</a>( tmpBE2 );</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>        </div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>        std::cout &lt;&lt; std::setprecision(5);</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;ELUM found at &quot;</span> &lt;&lt; <a class="code hl_variable" href="classISSReaction.html#af0020ca1f58ef4bc2bfd2da5e6be56f5">elum_z</a> &lt;&lt; <span class="stringliteral">&quot; mm&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>        std::cout &lt;&lt; <span class="stringliteral">&quot; θ_cm = &quot;</span> &lt;&lt; theta_cm_centre * TMath::RadToDeg();</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>        std::cout &lt;&lt; <span class="stringliteral">&quot; degrees; E_lab = &quot;</span> &lt;&lt; energy_centre &lt;&lt; <span class="stringliteral">&quot; keV; E_det = &quot;</span>;</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>        std::cout &lt;&lt; energy_centre - enloss_centre &lt;&lt; <span class="stringliteral">&quot; keV&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; theta_cm_inner * TMath::RadToDeg();</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>        std::cout &lt;&lt; <span class="stringliteral">&quot; &lt; θ_cm  &lt; &quot;</span> &lt;&lt; theta_cm_outer * TMath::RadToDeg();</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>        std::cout &lt;&lt; <span class="stringliteral">&quot; degrees&quot;</span> &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; energy_inner;</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>        std::cout &lt;&lt; <span class="stringliteral">&quot; &lt; E_lab &lt; &quot;</span> &lt;&lt; energy_outer &lt;&lt; <span class="stringliteral">&quot; keV&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; energy_inner - enloss_inner &lt;&lt; <span class="stringliteral">&quot; &lt; E_det &lt; &quot;</span>;</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>        std::cout &lt;&lt; energy_outer - enloss_outer &lt;&lt; <span class="stringliteral">&quot; keV &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>        </div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>    }</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>    </div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>    <span class="comment">// Finished</span></div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>    <span class="keyword">delete</span> config;</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>    </div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>}</div>
</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span> </div>
<div class="foldopen" id="foldopen00749" data-start="{" data-end="}">
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno"><a class="line" href="classISSReaction.html#a7e33613ce6e80c530333cf96aac9a340">  749</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classISSReaction.html#a7e33613ce6e80c530333cf96aac9a340">ISSReaction::GetEnergyLoss</a>( <span class="keywordtype">double</span> Ei, <span class="keywordtype">double</span> dist, std::unique_ptr&lt;TGraph&gt; &amp;<a class="code hl_variable" href="z__to__angle__simulator_8cc.html#ab17935dd73a49ff6d8a06026a1950a0a">g</a> ) {</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>    </div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Nmeshpoints = 50; <span class="comment">// number of steps to take in integration</span></div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>    <span class="keywordtype">double</span> dx = dist/(double)Nmeshpoints;</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>    <span class="keywordtype">double</span> E = Ei;</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>    </div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>    <span class="comment">// Create a spline for the provided TGraph</span></div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>    <span class="comment">// Use akima spline to make energy loss graph smoother</span></div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>    std::unique_ptr&lt;TSpline3&gt; spline = std::make_unique&lt;TSpline3&gt;(<span class="stringliteral">&quot;spline&quot;</span>, <a class="code hl_variable" href="z__to__angle__simulator_8cc.html#ab17935dd73a49ff6d8a06026a1950a0a">g</a>.get(), <span class="stringliteral">&quot;akima&quot;</span>);</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; Nmeshpoints; i++ ) {</div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span> </div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>        <span class="keywordtype">double</span> eloss = spline-&gt;Eval(E) * dx;</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>        <span class="keywordflow">if</span>( eloss &gt; E &amp;&amp; eloss &gt; 0 ) eloss = E; <span class="comment">// incase we are &quot;stopped&quot;</span></div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span> </div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>        E -= eloss;</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>        <span class="keywordflow">if</span>( E &lt; 100. &amp;&amp; eloss &gt; 0 ) <span class="keywordflow">break</span>; <span class="comment">// when we fall below 100 keV we assume maximum energy loss</span></div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span> </div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>    }</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span> </div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>    <span class="keywordflow">return</span> Ei - E;</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>    </div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>}</div>
</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span> </div>
<div class="foldopen" id="foldopen00782" data-start="{" data-end="}">
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno"><a class="line" href="classISSReaction.html#adcc8a162077804557bb31ebae606c3ad">  782</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classISSReaction.html#adcc8a162077804557bb31ebae606c3ad">ISSReaction::GetNuclearEnergyLoss</a>( <span class="keywordtype">double</span> Ei, <span class="keywordtype">double</span> range, std::unique_ptr&lt;TGraph&gt; &amp;gn, std::unique_ptr&lt;TGraph&gt; &amp;gtot ) {</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>    </div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Nmeshpoints = 200; <span class="comment">// number of steps to take in integration</span></div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>    <span class="keywordtype">double</span> dx = range/(double)Nmeshpoints;</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>    <span class="keywordtype">double</span> E = Ei;</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>    <span class="keywordtype">double</span> En = 0;</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span> </div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>    <span class="comment">// Create splines for the provided TGraphs</span></div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>    std::unique_ptr&lt;TSpline3&gt; splineTot = std::make_unique&lt;TSpline3&gt;(<span class="stringliteral">&quot;splineTot&quot;</span>, gtot.get(), <span class="stringliteral">&quot;akima&quot;</span>); <span class="comment">// Use akima spline to make energy loss graph smoother - BRJ</span></div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>    std::unique_ptr&lt;TSpline3&gt; splineN   = std::make_unique&lt;TSpline3&gt;(<span class="stringliteral">&quot;splineN&quot;</span>, gn.get(), <span class="stringliteral">&quot;akima&quot;</span>); <span class="comment">// Use akima spline to make energy loss graph smoother - BRJ</span></div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>    </div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; Nmeshpoints; i++ ) {</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>        <span class="keywordflow">if</span>( E &lt; 0.5 ) <span class="keywordflow">break</span>; <span class="comment">// when we fall below 0.5 keV we assume we&#39;re stopped</span></div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>        E -= splineTot-&gt;Eval(E) * dx;</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>        En += splineN-&gt;Eval(E) * dx;</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>    }</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>    </div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>    <span class="keywordflow">return</span> En;</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>    </div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>}</div>
</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span> </div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span> </div>
<div class="foldopen" id="foldopen00815" data-start="{" data-end="}">
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno"><a class="line" href="classISSReaction.html#ab3971fa9b0c406b88590283d27710cf7">  815</a></span><span class="keywordtype">bool</span> <a class="code hl_function" href="classISSReaction.html#ab3971fa9b0c406b88590283d27710cf7">ISSReaction::ReadStoppingPowers</a>( std::string isotope1, std::string isotope2,</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>                                     std::unique_ptr&lt;TGraph&gt; &amp;<a class="code hl_variable" href="z__to__angle__simulator_8cc.html#ab17935dd73a49ff6d8a06026a1950a0a">g</a>, std::unique_ptr&lt;TGraph&gt; &amp;r,</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>                                     <span class="keywordtype">bool</span> electriconly, <span class="keywordtype">bool</span> nuclearonly ) {</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>    </div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>    </div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>    <span class="comment">// Change target material depending on species</span></div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>    <span class="keywordflow">if</span>( isotope2 == <span class="stringliteral">&quot;1H&quot;</span> ) isotope2 = <span class="stringliteral">&quot;CH2&quot;</span>;</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>    <span class="keywordflow">if</span>( isotope2 == <span class="stringliteral">&quot;2H&quot;</span> ) isotope2 = <span class="stringliteral">&quot;CD2&quot;</span>;</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>    <span class="keywordflow">if</span>( isotope2 == <span class="stringliteral">&quot;3H&quot;</span> ) isotope2 = <span class="stringliteral">&quot;tTi&quot;</span>;</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>    </div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>    <span class="comment">// Make title for stopping</span></div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>    std::string title = <span class="stringliteral">&quot;Stopping powers for &quot;</span>;</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>    title += isotope1 + <span class="stringliteral">&quot; in &quot;</span> + isotope2;</div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>    title += <span class="stringliteral">&quot;;&quot;</span> + isotope1 + <span class="stringliteral">&quot; energy [keV];&quot;</span>;</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span>    title += <span class="stringliteral">&quot;Energy loss in &quot;</span> + isotope2;</div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>    <span class="keywordflow">if</span>( isotope2 == <span class="stringliteral">&quot;Si&quot;</span> || isotope2 == <span class="stringliteral">&quot;Al&quot;</span> ) title += <span class="stringliteral">&quot; [keV/mm]&quot;</span>;</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>    <span class="keywordflow">else</span> title += <span class="stringliteral">&quot; [keV/(mg/cm^{2})]&quot;</span>;</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>    <a class="code hl_variable" href="z__to__angle__simulator_8cc.html#ab17935dd73a49ff6d8a06026a1950a0a">g</a>-&gt;SetTitle( title.c_str() );</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>    </div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>    <span class="comment">// Make title for range</span></div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>    title = <span class="stringliteral">&quot;Range of &quot;</span>;</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>    title += isotope1 + <span class="stringliteral">&quot; in &quot;</span> + isotope2;</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>    title += <span class="stringliteral">&quot;;&quot;</span> + isotope1 + <span class="stringliteral">&quot; energy [keV];&quot;</span>;</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>    title += <span class="stringliteral">&quot;Range in &quot;</span> + isotope2;</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span>    title += <span class="stringliteral">&quot; [mm]&quot;</span>;</div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>    r-&gt;SetTitle( title.c_str() );</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>    </div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>    <span class="comment">// Start graphs fresh</span></div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>    <a class="code hl_variable" href="z__to__angle__simulator_8cc.html#ab17935dd73a49ff6d8a06026a1950a0a">g</a>-&gt;Set(0);</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span>    r-&gt;Set(0);</div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>    </div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>    <span class="comment">// Keep things quiet from ROOT</span></div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>    gErrorIgnoreLevel = kWarning;</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>    </div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>    <span class="comment">// Open the data file</span></div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>    <span class="comment">// SRIM_DIR is defined at compilation and is in source code</span></div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>    std::string srimfilename = std::string( <a class="code hl_define" href="Reaction_8hh.html#a1ecc51e007dc445274ddb9227fe8cea8">SRIM_DIR</a> ) + <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>    srimfilename += isotope1 + <span class="stringliteral">&quot;_&quot;</span> + isotope2 + <span class="stringliteral">&quot;.txt&quot;</span>;</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>    </div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>    std::ifstream input_file;</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>    input_file.open( srimfilename, std::ios::in );</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>    </div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>    <span class="comment">// If it fails to open print an error</span></div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>    <span class="keywordflow">if</span>( !input_file.is_open() ) {</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>        </div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;Cannot open &quot;</span> &lt;&lt; srimfilename &lt;&lt; std::endl;</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>        </div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>    }</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>    </div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>    </div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>    std::string line, units, length, tmp_str;</div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>    std::stringstream line_ss;</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>    <span class="keywordtype">double</span> En, nucl, elec, total, range, tmp_dbl;</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>    </div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>    <span class="comment">// Test file format</span></div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>    std::getline( input_file, line );</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>    <span class="keywordflow">if</span>( line.substr( 3, 5 ) == <span class="stringliteral">&quot;=====&quot;</span> ) {</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>        </div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>        <span class="comment">// Advance</span></div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>        <span class="keywordflow">while</span>( std::getline( input_file, line ) &amp;&amp; !input_file.eof() ) {</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span>            </div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>            <span class="comment">// Skip over the really short lines</span></div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>            <span class="keywordflow">if</span>( line.length() &lt; 10 ) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>            </div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>            <span class="comment">// Check for the start of the data</span></div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>            <span class="keywordflow">if</span>( line.substr( 3, 5 ) == <span class="stringliteral">&quot;-----&quot;</span> ) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>            </div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>        }</div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span>        </div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>    }</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>        </div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;Not a srim file: &quot;</span> &lt;&lt; srimfilename &lt;&lt; std::endl;</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>        </div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>    }</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>    </div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>    <span class="comment">// Read in the data</span></div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>    <span class="keywordflow">while</span>( std::getline( input_file, line ) &amp;&amp; !input_file.eof() ) {</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>        </div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>        <span class="comment">// Skip over the really short lines</span></div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>        <span class="keywordflow">if</span>( line.length() &lt; 10 ) <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>        </div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>        <span class="comment">// If we&#39;ve reached the end, stop</span></div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>        <span class="keywordflow">if</span>( line.substr( 3, 9 ) == <span class="stringliteral">&quot;---------&quot;</span> ) <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>        </div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>        <span class="comment">// Read in data</span></div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>        line_ss.clear();</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>        line_ss.str(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>        line_ss &lt;&lt; line;</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>        line_ss &gt;&gt; En &gt;&gt; units &gt;&gt; elec &gt;&gt; nucl &gt;&gt; range &gt;&gt; length &gt;&gt; tmp_dbl &gt;&gt; tmp_str;</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>        </div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>        <span class="keywordflow">if</span>( units == <span class="stringliteral">&quot;eV&quot;</span> ) En *= 1E-3;</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( units == <span class="stringliteral">&quot;keV&quot;</span> ) En *= 1E0;</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( units == <span class="stringliteral">&quot;MeV&quot;</span> ) En *= 1E3;</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( units == <span class="stringliteral">&quot;GeV&quot;</span> ) En *= 1E6;</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span>        </div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>        <span class="keywordflow">if</span>( length == <span class="stringliteral">&quot;A&quot;</span> ) range *= 1E-7;</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( length == <span class="stringliteral">&quot;um&quot;</span> ) range *= 1E-3;</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( length == <span class="stringliteral">&quot;mm&quot;</span> ) range *= 1E0;</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( length == <span class="stringliteral">&quot;m&quot;</span> ) range *= 1E3;</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( length == <span class="stringliteral">&quot;km&quot;</span> ) range *= 1E6;</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>        </div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>        <span class="keywordflow">if</span>( electriconly ) total = elec; <span class="comment">// electric stopping only</span></div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span>( nuclearonly ) total = nucl; <span class="comment">// nuclear stopping only</span></div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>        <span class="keywordflow">else</span> total = nucl + elec ; <span class="comment">// in some units, conversion done later</span></div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>        </div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>        <a class="code hl_variable" href="z__to__angle__simulator_8cc.html#ab17935dd73a49ff6d8a06026a1950a0a">g</a>-&gt;SetPoint( <a class="code hl_variable" href="z__to__angle__simulator_8cc.html#ab17935dd73a49ff6d8a06026a1950a0a">g</a>-&gt;GetN(), En, total );</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>        r-&gt;SetPoint( <a class="code hl_variable" href="z__to__angle__simulator_8cc.html#ab17935dd73a49ff6d8a06026a1950a0a">g</a>-&gt;GetN(), En, range );</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>        </div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>    }</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>    </div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>    <span class="comment">// Get next line and check there are conversion factors</span></div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>    std::getline( input_file, line );</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>    <span class="keywordflow">if</span>( line.substr( 0, 9 ) != <span class="stringliteral">&quot; Multiply&quot;</span> ){</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>        </div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;Couldn&#39;t get conversion factors from &quot;</span>;</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>        std::cerr &lt;&lt; srimfilename &lt;&lt; std::endl;</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>        </div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>    }</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>    std::getline( input_file, line ); <span class="comment">// next line is just ------</span></div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>    </div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>    <span class="comment">// Get conversion factors</span></div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>    <span class="keywordtype">double</span> conv, conv_keVum, conv_MeVmgcm2;</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>    std::getline( input_file, line ); <span class="comment">// first conversion is eV / Angstrom</span></div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>    std::getline( input_file, line ); <span class="comment">// keV / micron</span></div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>    conv_keVum = std::stod( line.substr( 0, 15 ) );</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>    std::getline( input_file, line ); <span class="comment">// MeV / mm</span></div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>    std::getline( input_file, line ); <span class="comment">// keV / (ug/cm2)</span></div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>    std::getline( input_file, line ); <span class="comment">// MeV / (mg/cm2)</span></div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>    conv_MeVmgcm2 = std::stod( line.substr( 0, 15 ) );</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>    </div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>    <span class="comment">// Now convert all the points in the plot</span></div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>    <span class="keywordflow">if</span>( isotope2 == <span class="stringliteral">&quot;Si&quot;</span> || isotope2 == <span class="stringliteral">&quot;Al&quot;</span> ) conv = conv_keVum * 1E3; <span class="comment">// silicon/aluminium thickness in mm, energy in keV</span></div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>    <span class="keywordflow">else</span> conv = conv_MeVmgcm2 * 1E3; <span class="comment">// target thickness in mg/cm2, energy in keV</span></div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>    <span class="keywordflow">for</span>( Int_t i = 0; i &lt; <a class="code hl_variable" href="z__to__angle__simulator_8cc.html#ab17935dd73a49ff6d8a06026a1950a0a">g</a>-&gt;GetN(); ++i ){</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>        </div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>        <a class="code hl_variable" href="z__to__angle__simulator_8cc.html#ab17935dd73a49ff6d8a06026a1950a0a">g</a>-&gt;GetPoint( i, En, total );</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>        <a class="code hl_variable" href="z__to__angle__simulator_8cc.html#ab17935dd73a49ff6d8a06026a1950a0a">g</a>-&gt;SetPoint( i, En, total*conv );</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>        </div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span>    }</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>    </div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>    <span class="comment">// Draw the plot and save it somewhere</span></div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>    std::unique_ptr&lt;TCanvas&gt; c = std::make_unique&lt;TCanvas&gt;();</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>    c-&gt;SetLogx();</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>    <a class="code hl_variable" href="z__to__angle__simulator_8cc.html#ab17935dd73a49ff6d8a06026a1950a0a">g</a>-&gt;Draw(<span class="stringliteral">&quot;A*&quot;</span>);</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>    std::string pdfname = srimfilename.substr( 0, srimfilename.find_last_of(<span class="stringliteral">&quot;.&quot;</span>) );</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>    <span class="keywordflow">if</span>( electriconly ) pdfname += <span class="stringliteral">&quot;_dedx_e.pdf&quot;</span>;</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( nuclearonly ) pdfname += <span class="stringliteral">&quot;_dedx_n.pdf&quot;</span>;</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>    <span class="keywordflow">else</span> pdfname += <span class="stringliteral">&quot;_dedx.pdf&quot;</span>;</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>    c-&gt;SaveAs( pdfname.c_str() );</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>    <span class="comment">//c-&gt;SetLogy();</span></div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>    r-&gt;Draw(<span class="stringliteral">&quot;A*&quot;</span>);</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>    pdfname = srimfilename.substr( 0, srimfilename.find_last_of(<span class="stringliteral">&quot;.&quot;</span>) ) + <span class="stringliteral">&quot;_range.pdf&quot;</span>;</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>    c-&gt;SaveAs( pdfname.c_str() );</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>    </div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>    input_file.close();</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>    </div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>    <span class="comment">// ROOT can be noisy again</span></div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>    gErrorIgnoreLevel = kInfo;</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>    </div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>    </div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>}</div>
</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span> </div>
<div class="foldopen" id="foldopen00988" data-start="{" data-end="}">
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno"><a class="line" href="classISSReaction.html#a0b99deb1a1d464c460c5f72bb2900955">  988</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classISSReaction.html#a0b99deb1a1d464c460c5f72bb2900955">ISSReaction::GetPulseHeightCorrection</a>( <span class="keywordtype">double</span> Ei, <span class="keywordtype">bool</span> detected ) {</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>    </div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>    <span class="comment">// If we failed to read the data, return a zero correction value</span></div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>    <span class="keywordflow">if</span>( !<a class="code hl_variable" href="classISSReaction.html#a6a3030f5c356fe2df1db672ed72e2bd9">phcurves</a> ) <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>    </div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>    <span class="keywordflow">if</span>( detected ) <span class="keywordflow">return</span> <a class="code hl_variable" href="classISSReaction.html#a0d8699a45c40e404ad7dfbd7b221ed7a">gPHC_inv</a>-&gt;Eval(Ei); <span class="comment">// get actual ion energy from PH (detected energy)</span></div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>    <span class="keywordflow">else</span> <span class="keywordflow">return</span> <a class="code hl_variable" href="classISSReaction.html#a49f9b17ebdb624e42438bf555afd262a">gPHC</a>-&gt;Eval(Ei); <span class="comment">// get PH for actual ion energy</span></div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>    </div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>}</div>
</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span> </div>
<div class="foldopen" id="foldopen01000" data-start="{" data-end="}">
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"><a class="line" href="classISSReaction.html#a02b9af4c92541a2dd44e20169ed0447b"> 1000</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classISSReaction.html#a02b9af4c92541a2dd44e20169ed0447b">ISSReaction::CalculatePulseHeightCorrection</a>( std::string isotope ) {</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>    </div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>    </div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>    <span class="comment">// Make titles</span></div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>    std::string title = <span class="stringliteral">&quot;Pulse height corrections for &quot;</span>;</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>    title += isotope;</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>    title += <span class="stringliteral">&quot;;&quot;</span> + isotope + <span class="stringliteral">&quot; energy after dead layer [keV];&quot;</span>;</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>    title += <span class="stringliteral">&quot;Deposited energy [keV/#mum]&quot;</span>;</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>    std::string title_inv = <span class="stringliteral">&quot;Pulse height corrections for &quot;</span>;</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>    title_inv += isotope;</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>    title_inv += <span class="stringliteral">&quot;;Deposited energy [keV/#mum];&quot;</span>;</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>    title_inv += isotope + <span class="stringliteral">&quot; energy after dead layer [keV]&quot;</span>;</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>    </div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>    <span class="comment">// Initialise an empty TGraph</span></div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>    <a class="code hl_variable" href="classISSReaction.html#a49f9b17ebdb624e42438bf555afd262a">gPHC</a>-&gt;SetTitle( title.c_str() );</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>    <a class="code hl_variable" href="classISSReaction.html#a0d8699a45c40e404ad7dfbd7b221ed7a">gPHC_inv</a>-&gt;SetTitle( title_inv.c_str() );</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>    </div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span>    <span class="comment">// Keep things quiet from ROOT</span></div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>    gErrorIgnoreLevel = kWarning;</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>    </div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>    <span class="comment">// Read in the data to a temporary graph</span></div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>    std::unique_ptr&lt;TGraph&gt; gRes = std::make_unique&lt;TGraph&gt;();</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span>    </div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>    <span class="comment">// Calculate the stopping</span></div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>    <span class="keywordtype">double</span> E, Emax = 100e3;</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>    <span class="keywordtype">double</span> range, dEdx_n, dEdx_e;</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>    </div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>    <span class="comment">// number of steps to take in integration</span></div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> Nmeshpoints = 2e4;</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span>    <span class="keywordtype">double</span> dE = Emax/(double)Nmeshpoints;</div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>    <span class="keywordtype">double</span> Edet = 0.0;</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>    </div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span>    <span class="comment">// Create splines for the TGraphs used in the calculation</span></div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>    std::unique_ptr&lt;TSpline3&gt; splineRange         = std::make_unique&lt;TSpline3&gt;(<span class="stringliteral">&quot;splineRange&quot;</span>, <a class="code hl_variable" href="classISSReaction.html#ab046d9c215f2be2f43f3af6d2cb3fcc4">gRange</a>[3].get(), <span class="stringliteral">&quot;akima&quot;</span>); <span class="comment">// // Use akima spline to make phc smoother</span></div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>    std::unique_ptr&lt;TSpline3&gt; splineStoppingPower = std::make_unique&lt;TSpline3&gt;(<span class="stringliteral">&quot;splineStoppingPower&quot;</span>, <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[3].get(), <span class="stringliteral">&quot;akima&quot;</span>); <span class="comment">//Use akima spline to make phc smoother</span></div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>    </div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>    </div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>    <span class="comment">// Do the numerical integration</span></div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>    <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; Nmeshpoints; i++ ){</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>        </div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>        E = (double)i + 0.5;</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>        E *= dE;</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>        </div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span>        <span class="comment">// Evaluate stopping powers and range</span></div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>        range = splineRange-&gt;Eval(E);</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>        dEdx_e = splineStoppingPower-&gt;Eval(E);</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>        </div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>        <span class="comment">// Calculate the nuclear stopping</span></div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>        <span class="comment">// TODO: this is inefficient, but still only takes a couple of seconds</span></div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>        <span class="comment">// ideally the integrated nuclear energy loss versus energy would be</span></div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>        <span class="comment">// calculated only once and stored as a TGraph or something. Who cares?</span></div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>        dEdx_n = <a class="code hl_function" href="classISSReaction.html#adcc8a162077804557bb31ebae606c3ad">GetNuclearEnergyLoss</a>( E, range, <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[4], <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[5] );</div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>        </div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span>        <span class="comment">// From W. N. Lennard et al. NIM A248 (1986) 454</span></div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>        <span class="keywordtype">double</span> PHC = <a class="code hl_variable" href="Reaction_8hh.html#aa07e932fa1af90883412b0528b733569">e0_Si</a> - <a class="code hl_variable" href="Reaction_8hh.html#a559fda855a43e409dd7ab7e24e915c4e">k_Si</a> * dEdx_e;</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>        PHC = <a class="code hl_variable" href="Reaction_8hh.html#aa07e932fa1af90883412b0528b733569">e0_Si</a> / PHC;</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>        Edet += dE * PHC;</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>        </div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>        <span class="comment">//if( E &gt; 2000. &amp;&amp; E &lt; 2010. ) {</span></div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>        <span class="comment">//  std::cout &lt;&lt; &quot;Energy = &quot; &lt;&lt; E &lt;&lt; &quot; keV&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span>        <span class="comment">//  std::cout &lt;&lt; &quot;Range = &quot; &lt;&lt; range &lt;&lt; &quot; mm&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>        <span class="comment">//  std::cout &lt;&lt; &quot;dEdx_e = &quot; &lt;&lt; dEdx_e &lt;&lt; &quot; keV/mm&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>        <span class="comment">//  std::cout &lt;&lt; &quot;dEdx_n = &quot; &lt;&lt; dEdx_n &lt;&lt; &quot; keV&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>        <span class="comment">//  std::cout &lt;&lt; &quot;PHC = &quot; &lt;&lt; PHC &lt;&lt; &quot; keV&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>        <span class="comment">//  std::cout &lt;&lt; &quot;Edet = &quot; &lt;&lt; Edet &lt;&lt; &quot; keV&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span>        <span class="comment">//}</span></div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>        </div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>        <a class="code hl_variable" href="classISSReaction.html#a49f9b17ebdb624e42438bf555afd262a">gPHC</a>-&gt;SetPoint( <a class="code hl_variable" href="classISSReaction.html#a49f9b17ebdb624e42438bf555afd262a">gPHC</a>-&gt;GetN(), E + dEdx_n, Edet );</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>        <a class="code hl_variable" href="classISSReaction.html#a0d8699a45c40e404ad7dfbd7b221ed7a">gPHC_inv</a>-&gt;SetPoint( <a class="code hl_variable" href="classISSReaction.html#a0d8699a45c40e404ad7dfbd7b221ed7a">gPHC_inv</a>-&gt;GetN(), Edet, E + dEdx_n );</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>        gRes-&gt;SetPoint( gRes-&gt;GetN(), E + dEdx_n, Edet - E - dEdx_n );</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>        </div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span>    }</div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>    </div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>    <span class="comment">// Draw the plot and save it somewhere</span></div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>    std::unique_ptr&lt;TCanvas&gt; c = std::make_unique&lt;TCanvas&gt;();</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>    <span class="comment">//c-&gt;SetLogx();</span></div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>    <span class="comment">//c-&gt;SetLogy();</span></div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>    gRes-&gt;Draw(<span class="stringliteral">&quot;AP&quot;</span>);</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>    gRes-&gt;GetYaxis()-&gt;SetTitle(<span class="stringliteral">&quot;E_{detected} - E_{0} (keV)&quot;</span>);</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>    gRes-&gt;GetXaxis()-&gt;SetTitle(<span class="stringliteral">&quot;E_{0} (keV)&quot;</span>);</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>    std::string pdfname = std::string( <a class="code hl_define" href="Reaction_8hh.html#a1ecc51e007dc445274ddb9227fe8cea8">SRIM_DIR</a> ) + <span class="stringliteral">&quot;/&quot;</span> + isotope + <span class="stringliteral">&quot;_phc.pdf&quot;</span>;</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>    c-&gt;SaveAs( pdfname.c_str() );</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>    </div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>    <span class="comment">// These lines make root files for PH residual and eloss for the isotope that is read in</span></div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>    </div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>    std::string tfilenameroot = std::string( <a class="code hl_define" href="Reaction_8hh.html#a1ecc51e007dc445274ddb9227fe8cea8">SRIM_DIR</a> ) + <span class="stringliteral">&quot;/&quot;</span> + isotope + <span class="stringliteral">&quot;_phc.root&quot;</span>;</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>    TFile *tfile = <span class="keyword">new</span> TFile(tfilenameroot.c_str(),<span class="stringliteral">&quot;recreate&quot;</span>);</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>    gRes-&gt;Write(<span class="stringliteral">&quot;gRes&quot;</span>);</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>    tfile-&gt;Close();</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>    </div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>    <span class="comment">// ROOT can be noisy again</span></div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>    gErrorIgnoreLevel = kInfo;</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>    </div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>}</div>
</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span> </div>
<div class="foldopen" id="foldopen01105" data-start="{" data-end="}">
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"><a class="line" href="classISSReaction.html#ad75dff2c1bbc19c8fbba6aa8a4e17ffd"> 1105</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classISSReaction.html#ad75dff2c1bbc19c8fbba6aa8a4e17ffd">ISSReaction::SimulateEmission</a>( <span class="keywordtype">double</span> en, <span class="keywordtype">double</span> theta_lab, <span class="keywordtype">double</span> phi_lab, <span class="keywordtype">int</span> detector ){</div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>    </div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>    <span class="comment">// Set the energy and lab angle</span></div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#abafb553ba2ed67375a75e3a864f52842">SetEnergyLab</a>( en );</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#aca07c0149651d78693825c9003be08a7">SetThetaLab</a>( theta_lab );</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>    phi_lab *= 1.0; <span class="comment">// to prevent compiler warning (we don&#39;t use it here atm)</span></div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>    </div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>    <span class="comment">// z when returning to axis</span></div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>    <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a>  = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#abed1e6b453f7d590e76d3596b0bce6ac">GetBeta</a>() * TMath::Cos( theta_lab );</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>    <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> *= TMath::TwoPi() * <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842a20ceab0eaa3c64dddb83ceac0c86">GetMass</a>();</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>    <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> /= (double)<a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() * <a class="code hl_function" href="classISSReaction.html#ad19626b55d856b809f89846a8b409a13">GetField_corr</a>();</div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>    </div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>    <span class="comment">// Centre of mass velocity/energy</span></div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>    <span class="keywordtype">double</span> v3_cm_para = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#abed1e6b453f7d590e76d3596b0bce6ac">GetBeta</a>() * TMath::Cos( theta_lab );</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>    v3_cm_para -= <a class="code hl_function" href="classISSReaction.html#a19f1f95b0c8e3074e79d9509bb06f2bb">GetBeta</a>();</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>    <span class="keywordtype">double</span> v3_cm_perp = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#abed1e6b453f7d590e76d3596b0bce6ac">GetBeta</a>() * TMath::Sin( theta_lab );</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>    <span class="keywordtype">double</span> v3_cm = TMath::Sqrt( v3_cm_para * v3_cm_para +  v3_cm_perp * v3_cm_perp );</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>    <a class="code hl_variable" href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">e3_cm</a> = ( v3_cm * v3_cm + 1.0 ) * <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842a20ceab0eaa3c64dddb83ceac0c86">GetMass</a>() * <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842a20ceab0eaa3c64dddb83ceac0c86">GetMass</a>();</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>    <a class="code hl_variable" href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">e3_cm</a> = TMath::Sqrt( <a class="code hl_variable" href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">e3_cm</a> );</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac397cd64652ba7d6604c1a6c4c64edcf">SetEnergyTotCM</a>( <a class="code hl_variable" href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">e3_cm</a> );</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>    </div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>    <span class="comment">// Centre of mass angle</span></div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="classISSReaction.html#ab41686e457e6cdb32b225c5bcbbcf0ab">theta_cm</a> = TMath::ASin( v3_cm_perp / v3_cm );</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a277528b6ca85b6f07045ae34151bdf58">SetThetaCM</a>( <a class="code hl_variable" href="classISSReaction.html#ab41686e457e6cdb32b225c5bcbbcf0ab">theta_cm</a> );</div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>    </div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>    <span class="comment">// cyclotron radius</span></div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>    <span class="keywordtype">double</span> r_cyc = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#af22545627c83f6fae593712e542f5229">GetMomentumLab</a>() * TMath::Sin( theta_lab );</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>    r_cyc /= (double)<a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() * <a class="code hl_function" href="classISSReaction.html#ad19626b55d856b809f89846a8b409a13">GetField_corr</a>();</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>    </div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>    <span class="comment">// measured z distance needs radius of detection</span></div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>    <span class="comment">// TODO: this will depend on the phi emission angle</span></div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>    <span class="keywordtype">double</span> r_det = <a class="code hl_variable" href="ISSEvts_8hh.html#a2d3721b60d5268ab0f4fd5e063589def">array_radius</a>; <span class="comment">// for now just assume standard detector radius</span></div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>    <span class="keywordtype">double</span> omega = TMath::TwoPi() - 2.0 * TMath::ASin( 0.5 * r_det / r_cyc );</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span>    <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> = <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> * omega / TMath::TwoPi();</div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>    </div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>    <span class="comment">// Calculate the energy lost in the target</span></div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>    <span class="keywordtype">double</span> dist = 0.5 * <a class="code hl_variable" href="classISSReaction.html#aafcc62d779e00337aa5defd11d6abc3d">target_thickness</a> / TMath::Abs( TMath::Sin( theta_lab ) );</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>    <span class="keywordtype">double</span> eloss = <a class="code hl_function" href="classISSReaction.html#a7e33613ce6e80c530333cf96aac9a340">GetEnergyLoss</a>( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>(), dist, <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[1] );</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#abafb553ba2ed67375a75e3a864f52842">SetEnergyLab</a>( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>() - eloss );</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>    </div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>    <span class="comment">// Calculate the energy loss in the deadlayer</span></div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>    <span class="keywordflow">if</span>( detector == 0 )</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span>        dist = <a class="code hl_variable" href="classISSReaction.html#a344c739edf79c6c6e25094cacfca8b28">deadlayer</a> / TMath::Abs( TMath::Cos( theta_lab - TMath::PiOver2() ) );</div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( detector == 1 )</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>        dist = <a class="code hl_variable" href="classISSReaction.html#a33a6620f6b099925581e883a1f6cf304">elum_deadlayer</a> / TMath::Abs( TMath::Sin( theta_lab - TMath::PiOver2() ) );</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>    eloss = <a class="code hl_function" href="classISSReaction.html#a7e33613ce6e80c530333cf96aac9a340">GetEnergyLoss</a>( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>(), dist, <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[2] );</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#abafb553ba2ed67375a75e3a864f52842">SetEnergyLab</a>( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>() - eloss );</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>    </div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>();</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>    </div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>}</div>
</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span> </div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span> </div>
<div class="foldopen" id="foldopen01166" data-start="{" data-end="}">
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"><a class="line" href="classISSReaction.html#aa6c11b3484ae6c3317fca74023e57803"> 1166</a></span><span class="keywordtype">double</span> <a class="code hl_function" href="classISSReaction.html#aa6c11b3484ae6c3317fca74023e57803">ISSReaction::SimulateDecay</a>( TVector3 vec, <span class="keywordtype">double</span> en, <span class="keywordtype">int</span> detector ){</div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>    </div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>    <span class="comment">// Apply the X and Y offsets directly to the TVector3 input</span></div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span>    <span class="comment">// We move the array opposite to the target, which replicates the same</span></div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>    <span class="comment">// geometrical shift that is observed with respect to the beam</span></div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>    vec.SetX( vec.X() - <a class="code hl_variable" href="classISSReaction.html#ab5d66ec25b61e0b6a6a0c3590b007fef">x_offset</a> );</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span>    vec.SetY( vec.Y() - <a class="code hl_variable" href="classISSReaction.html#ad74e98af4ec57c4319a57d7d30d28475">y_offset</a> );</div>
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"> 1173</span>    </div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>    <span class="comment">// Set the input parameters, might use them in another function</span></div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#abafb553ba2ed67375a75e3a864f52842">SetEnergyLab</a>(en);          <span class="comment">// ejectile energy in keV</span></div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>    <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> = vec.Z();                   <span class="comment">// measured z in mm</span></div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span>    <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#a024ad9bb0691b6b55faa72a8246f7232">z0</a> &lt; 0 ) {                      <span class="comment">// upstream</span></div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>        <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> = <a class="code hl_variable" href="classISSReaction.html#a024ad9bb0691b6b55faa72a8246f7232">z0</a> - <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a>;</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>        <a class="code hl_variable" href="classISSReaction.html#ac027b99074dbd0dc7024c5717353bcbf">phi_meas</a> = TMath::TwoPi() - vec.Phi();</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>    }</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span>    <span class="keywordflow">else</span> {                              <span class="comment">// downstream</span></div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>        <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> += <a class="code hl_variable" href="classISSReaction.html#a024ad9bb0691b6b55faa72a8246f7232">z0</a>;</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>        <a class="code hl_variable" href="classISSReaction.html#ac027b99074dbd0dc7024c5717353bcbf">phi_meas</a> = vec.Phi();</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>    }</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>    </div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>    <span class="comment">//------------------------//</span></div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span>    <span class="comment">// Kinematics calculation //</span></div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>    <span class="comment">//------------------------//</span></div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[0] = <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a>;                                     <span class="comment">// z in mm</span></div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[1] = vec.Perp();                                 <span class="comment">// r_meas in mm</span></div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[2] = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#af22545627c83f6fae593712e542f5229">GetMomentumLab</a>();                  <span class="comment">// p3</span></div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[3] = (double)<a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() * <a class="code hl_function" href="classISSReaction.html#ad19626b55d856b809f89846a8b409a13">GetField_corr</a>();  <span class="comment">// qb</span></div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[3] /= TMath::TwoPi();                            <span class="comment">// qb/2pi</span></div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>    </div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span>    <span class="comment">// Set parameters</span></div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>    <a class="code hl_variable" href="classISSReaction.html#a5819db85711395799ad4d040a0415ba2">fa</a>-&gt;SetParameters( <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a> );</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>    <a class="code hl_variable" href="classISSReaction.html#a40ede1141847b9a90798eeb907490996">fb</a>-&gt;SetParameters( <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a> );</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>    </div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>    <span class="comment">// Build the function and derivative, then solve for z</span></div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span>    gErrorIgnoreLevel = kBreak; <span class="comment">// suppress warnings and errors, but not breaks</span></div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>    ROOT::Math::GradFunctor1D wf( *<a class="code hl_variable" href="classISSReaction.html#a5819db85711395799ad4d040a0415ba2">fa</a>, *<a class="code hl_variable" href="classISSReaction.html#a40ede1141847b9a90798eeb907490996">fb</a> );</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>    <a class="code hl_variable" href="classISSReaction.html#a843c40e11d87b4f692be73d940c71399">rf</a>-&gt;SetFunction( wf, <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> );</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span>    <a class="code hl_variable" href="classISSReaction.html#a843c40e11d87b4f692be73d940c71399">rf</a>-&gt;Solve( 500, 1e-5, 1e-6 );</div>
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"> 1204</span>    </div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>    <span class="comment">// Check result</span></div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>    <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#a843c40e11d87b4f692be73d940c71399">rf</a>-&gt;Status() ){</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span>        <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> = TMath::QuietNaN();</div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>    }</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>    <span class="keywordflow">else</span> <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> = <a class="code hl_variable" href="classISSReaction.html#a843c40e11d87b4f692be73d940c71399">rf</a>-&gt;Root();</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>    gErrorIgnoreLevel = kInfo; <span class="comment">// print info and above again</span></div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>    </div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>    <span class="comment">// Calculate the lab angle from z position (Butler method)</span></div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>    <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a>  = (double)<a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() * <a class="code hl_function" href="classISSReaction.html#ad19626b55d856b809f89846a8b409a13">GetField_corr</a>();     <span class="comment">// qb</span></div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>    <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> /= TMath::TwoPi();                            <span class="comment">// qb/2pi</span></div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>    <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> *= <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> / <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#af22545627c83f6fae593712e542f5229">GetMomentumLab</a>();             <span class="comment">// * z/p</span></div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>    <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a>  = TMath::ASin( <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> );</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#aca07c0149651d78693825c9003be08a7">SetThetaLab</a>( TMath::PiOver2() + <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> );</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>    </div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>    <span class="comment">// Phi - TODO: this depends on direction of the field!</span></div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>    <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#ac027b99074dbd0dc7024c5717353bcbf">phi_meas</a> &lt; 0 ) <a class="code hl_variable" href="classISSReaction.html#ac027b99074dbd0dc7024c5717353bcbf">phi_meas</a> += TMath::TwoPi();</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>    <a class="code hl_variable" href="classISSReaction.html#ac23c3b2dede3a7ef6959d3fbcd848dcd">phi</a> = <a class="code hl_variable" href="classISSReaction.html#ac027b99074dbd0dc7024c5717353bcbf">phi_meas</a> * <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> / <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> + TMath::Pi();</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span>    <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#ac23c3b2dede3a7ef6959d3fbcd848dcd">phi</a> &gt; TMath::TwoPi() ) <a class="code hl_variable" href="classISSReaction.html#ac23c3b2dede3a7ef6959d3fbcd848dcd">phi</a> -= TMath::TwoPi();</div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>    </div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>    <span class="comment">// Calculate the energy loss</span></div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>    <span class="comment">// Distance is postive because energy is lost</span></div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>    <span class="keywordtype">double</span> dist = 0.0;</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>    <span class="keywordflow">if</span>( detector == 0 )</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>        dist = <a class="code hl_variable" href="classISSReaction.html#a344c739edf79c6c6e25094cacfca8b28">deadlayer</a> / TMath::Abs( TMath::Cos( <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> ) );</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>( detector == 1 )</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>        dist = <a class="code hl_variable" href="classISSReaction.html#a33a6620f6b099925581e883a1f6cf304">elum_deadlayer</a> / TMath::Abs( TMath::Sin( <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> ) );</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>    <span class="keywordtype">double</span> eloss = <a class="code hl_function" href="classISSReaction.html#a7e33613ce6e80c530333cf96aac9a340">GetEnergyLoss</a>( en, dist, <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[2] );</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>    </div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>    <span class="comment">//std::cout &lt;&lt; &quot;z = &quot; &lt;&lt; z_meas &lt;&lt; &quot; mm, angle = &quot;;</span></div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>    <span class="comment">//std::cout &lt;&lt; alpha*TMath::RadToDeg() &lt;&lt; &quot; deg, dead layer = &quot;;</span></div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>    <span class="comment">//std::cout &lt;&lt; dist*1e3 &lt;&lt; &quot; µm: &quot; &lt;&lt; en &lt;&lt; &quot; - &quot; &lt;&lt; eloss &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>    </div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>    <span class="keywordflow">return</span> en - eloss;</div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>    </div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span>}</div>
</div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span> </div>
<div class="foldopen" id="foldopen01247" data-start="{" data-end="}">
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"><a class="line" href="classISSReaction.html#a4241c6500ce557254dfcbeadb1e60cdb"> 1247</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classISSReaction.html#a4241c6500ce557254dfcbeadb1e60cdb">ISSReaction::SimulateReaction</a>( TVector3 vec ){</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>    </div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>    <span class="comment">// Apply the X and Y offsets directly to the TVector3 input</span></div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>    <span class="comment">// We move the array opposite to the target, which replicates the same</span></div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>    <span class="comment">// geometrical shift that is observed with respect to the beam</span></div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>    vec.SetX( vec.X() - <a class="code hl_variable" href="classISSReaction.html#ab5d66ec25b61e0b6a6a0c3590b007fef">x_offset</a> );</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>    vec.SetY( vec.Y() - <a class="code hl_variable" href="classISSReaction.html#ad74e98af4ec57c4319a57d7d30d28475">y_offset</a> );</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>    </div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>    <span class="comment">// Set the input parameters, might use them in another function</span></div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span>    <span class="comment">//Ejectile.SetEnergyLab(en);        // ejectile energy in keV</span></div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>    <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> = vec.Z();                   <span class="comment">// measured z in mm</span></div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>    <a class="code hl_variable" href="classISSReaction.html#afec1cbc2566feb68d42d352d51e86169">r_meas</a> = vec.Perp();                <span class="comment">// measured radius</span></div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>    </div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>    <span class="comment">//------------------------//</span></div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span>    <span class="comment">// Kinematics calculation //</span></div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>    <span class="comment">//------------------------//</span></div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[0] = <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a>;                                     <span class="comment">// z in mm</span></div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[1] = <a class="code hl_variable" href="classISSReaction.html#afec1cbc2566feb68d42d352d51e86169">r_meas</a>;                                     <span class="comment">// r_meas in mm</span></div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[2] = <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a57bcd669578c370986e213f251c8c958">GetEx</a>();                             <span class="comment">// Ex</span></div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[3] = (double)<a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() * <a class="code hl_function" href="classISSReaction.html#ad19626b55d856b809f89846a8b409a13">GetField_corr</a>();  <span class="comment">// qb</span></div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[3] /= TMath::TwoPi();                            <span class="comment">// qb/2pi</span></div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[4] = <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>();                        <span class="comment">// beam energy</span></div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[5] = <a class="code hl_variable" href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">Beam</a>.<a class="code hl_function" href="classISSParticle.html#a842a20ceab0eaa3c64dddb83ceac0c86">GetMass</a>();</div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[6] = <a class="code hl_variable" href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">Target</a>.<a class="code hl_function" href="classISSParticle.html#a842a20ceab0eaa3c64dddb83ceac0c86">GetMass</a>();</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[7] = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842a20ceab0eaa3c64dddb83ceac0c86">GetMass</a>();</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[8] = <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a842a20ceab0eaa3c64dddb83ceac0c86">GetMass</a>();</div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>    </div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>    <span class="comment">//for( int i = 0; i &lt; 9; ++i )</span></div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>    <span class="comment">//  std::cout &lt;&lt; &quot;params[&quot; &lt;&lt; i &lt;&lt; &quot;] = &quot; &lt;&lt; params[i] &lt;&lt; &quot;;&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span>    </div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>    <span class="comment">// Set parameters</span></div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>    <a class="code hl_variable" href="classISSReaction.html#a9a12b81efcfe420e51f5c7eee374fd18">fsim</a>-&gt;SetParameters( <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a> );</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>    <a class="code hl_variable" href="classISSReaction.html#ac1f129ae2c5512d6d05073d3f9e27b6a">dsim</a>-&gt;SetParameters( <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a> );</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>    </div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>    <span class="comment">// Build the theta_cm function, then solve</span></div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>    gErrorIgnoreLevel = kBreak; <span class="comment">// suppress warnings and errors, but not breaks</span></div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>    ROOT::Math::GradFunctor1D wf( *<a class="code hl_variable" href="classISSReaction.html#a9a12b81efcfe420e51f5c7eee374fd18">fsim</a>, *<a class="code hl_variable" href="classISSReaction.html#ac1f129ae2c5512d6d05073d3f9e27b6a">dsim</a> );</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>    <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#ad10963ba32970b7ff3c303bdd0c7d642">rfsim</a>-&gt;SetFunction( wf, TMath::PiOver4() ) ) {</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>        <a class="code hl_variable" href="classISSReaction.html#ad10963ba32970b7ff3c303bdd0c7d642">rfsim</a>-&gt;Solve( 500, 1e-5, 1e-6 );</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>        <a class="code hl_variable" href="classISSReaction.html#ab41686e457e6cdb32b225c5bcbbcf0ab">theta_cm</a> = <a class="code hl_variable" href="classISSReaction.html#ad10963ba32970b7ff3c303bdd0c7d642">rfsim</a>-&gt;Root();</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>    }</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>    <span class="keywordflow">else</span> <a class="code hl_variable" href="classISSReaction.html#ab41686e457e6cdb32b225c5bcbbcf0ab">theta_cm</a> = TMath::QuietNaN();</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>    gErrorIgnoreLevel = kInfo; <span class="comment">// print info and above again</span></div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>    </div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span>    <span class="comment">// Set the theta_cm of the ejectile</span></div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a277528b6ca85b6f07045ae34151bdf58">SetThetaCM</a>( TMath::Pi() - <a class="code hl_variable" href="classISSReaction.html#ab41686e457e6cdb32b225c5bcbbcf0ab">theta_cm</a> );</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>    <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a277528b6ca85b6f07045ae34151bdf58">SetThetaCM</a>( <a class="code hl_variable" href="classISSReaction.html#ab41686e457e6cdb32b225c5bcbbcf0ab">theta_cm</a> );</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>    </div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>    <span class="comment">// What about the energy of the ejectile after the collision?</span></div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>    <a class="code hl_variable" href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">e3_cm</a> = TMath::Power( <a class="code hl_function" href="classISSReaction.html#a4634045d6c30df4996f3632f9b8d0046">GetEnergyTotCM</a>(), 2.0 );</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>    <a class="code hl_variable" href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">e3_cm</a> -= TMath::Power( <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a842a20ceab0eaa3c64dddb83ceac0c86">GetMass</a>() + <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a57bcd669578c370986e213f251c8c958">GetEx</a>(), 2.0 );</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>    <a class="code hl_variable" href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">e3_cm</a> += TMath::Power( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842a20ceab0eaa3c64dddb83ceac0c86">GetMass</a>(), 2.0 );</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span>    <a class="code hl_variable" href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">e3_cm</a> /= 2.0 * <a class="code hl_function" href="classISSReaction.html#a4634045d6c30df4996f3632f9b8d0046">GetEnergyTotCM</a>();</div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac397cd64652ba7d6604c1a6c4c64edcf">SetEnergyTotCM</a>( <a class="code hl_variable" href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">e3_cm</a> );</div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>    </div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span>    <span class="comment">// From Daniel Clarke:</span></div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>    <span class="keywordtype">double</span> theta_lab = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a07b98dafa1c81ff76f849d1ea79d49bf">GetMomentumCM</a>() * TMath::Sin( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a16942178bd108e04c0d3766e09c8df54">GetThetaCM</a>() );</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>    theta_lab /= <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a07b98dafa1c81ff76f849d1ea79d49bf">GetMomentumCM</a>() * TMath::Cos( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a16942178bd108e04c0d3766e09c8df54">GetThetaCM</a>() ) + <a class="code hl_function" href="classISSReaction.html#a19f1f95b0c8e3074e79d9509bb06f2bb">GetBeta</a>() * <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ab338e58a9f995a1277dffac949e25c02">GetEnergyTotCM</a>();</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>    theta_lab /= <a class="code hl_function" href="classISSReaction.html#a7c5b735a73fb55aee805a12c7a7cdb0c">GetGamma</a>();</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span>    theta_lab = TMath::ATan( theta_lab );</div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#aca07c0149651d78693825c9003be08a7">SetThetaLab</a>( theta_lab );</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>    </div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>    <span class="comment">// Energy of ejectile in the lab</span></div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>    <span class="keywordtype">double</span> e3_lab = TMath::Cos( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a16942178bd108e04c0d3766e09c8df54">GetThetaCM</a>() );</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span>    e3_lab *= <a class="code hl_function" href="classISSReaction.html#a19f1f95b0c8e3074e79d9509bb06f2bb">GetBeta</a>() * <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a07b98dafa1c81ff76f849d1ea79d49bf">GetMomentumCM</a>();</div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>    e3_lab += <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ab338e58a9f995a1277dffac949e25c02">GetEnergyTotCM</a>();</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>    e3_lab *= <a class="code hl_function" href="classISSReaction.html#a7c5b735a73fb55aee805a12c7a7cdb0c">GetGamma</a>();</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#abafb553ba2ed67375a75e3a864f52842">SetEnergyLab</a>( e3_lab - <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842a20ceab0eaa3c64dddb83ceac0c86">GetMass</a>() );</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span>    </div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>}</div>
</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span> </div>
<div class="foldopen" id="foldopen01324" data-start="{" data-end="}">
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"><a class="line" href="classISSReaction.html#af09b6b1b50e23050ab80afeff489181f"> 1324</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="classISSReaction.html#af09b6b1b50e23050ab80afeff489181f">ISSReaction::MakeReaction</a>( TVector3 vec, <span class="keywordtype">double</span> en ){</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>    </div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>    <span class="comment">// Apply the X and Y offsets directly to the TVector3 input</span></div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span>    <span class="comment">// We move the array opposite to the target, which replicates the same</span></div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>    <span class="comment">// geometrical shift that is observed with respect to the beam</span></div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>    vec.SetX( vec.X() - <a class="code hl_variable" href="classISSReaction.html#ab5d66ec25b61e0b6a6a0c3590b007fef">x_offset</a> );</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>    vec.SetY( vec.Y() - <a class="code hl_variable" href="classISSReaction.html#ad74e98af4ec57c4319a57d7d30d28475">y_offset</a> );</div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>    </div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>    <span class="comment">// Set the input parameters, might use them in another function</span></div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>    <span class="comment">//Ejectile.SetEnergyLab(en);        // ejectile energy in keV</span></div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>    <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> = vec.Z();                   <span class="comment">// measured z in mm</span></div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>    <a class="code hl_variable" href="classISSReaction.html#afec1cbc2566feb68d42d352d51e86169">r_meas</a> = vec.Perp();                <span class="comment">// measured radius</span></div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>    <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#a024ad9bb0691b6b55faa72a8246f7232">z0</a> &lt; 0 ) {                      <span class="comment">// upstream</span></div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>        <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> = <a class="code hl_variable" href="classISSReaction.html#a024ad9bb0691b6b55faa72a8246f7232">z0</a> - <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a>;</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>        <a class="code hl_variable" href="classISSReaction.html#ac027b99074dbd0dc7024c5717353bcbf">phi_meas</a> = TMath::TwoPi() - vec.Phi();</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>    }</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>    <span class="keywordflow">else</span> {                              <span class="comment">// downstream</span></div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>        <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> += <a class="code hl_variable" href="classISSReaction.html#a024ad9bb0691b6b55faa72a8246f7232">z0</a>;</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>        <a class="code hl_variable" href="classISSReaction.html#ac027b99074dbd0dc7024c5717353bcbf">phi_meas</a> = vec.Phi();</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>    }</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span> </div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>    <span class="comment">// Pulse height conversion to proton energy using RDP</span></div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span>    en = <a class="code hl_function" href="classISSReaction.html#a0b99deb1a1d464c460c5f72bb2900955">GetPulseHeightCorrection</a>( en, <span class="keyword">true</span> );</div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>    <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#abafb553ba2ed67375a75e3a864f52842">SetEnergyLab</a>(en);</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>    </div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>    <span class="comment">//------------------------//</span></div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>    <span class="comment">// Kinematics calculation //</span></div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span>    <span class="comment">//------------------------//</span></div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[0] = <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a>;                                     <span class="comment">// z in mm</span></div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[1] = <a class="code hl_variable" href="classISSReaction.html#afec1cbc2566feb68d42d352d51e86169">r_meas</a>;                                     <span class="comment">// r_meas in mm</span></div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[2] = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#af22545627c83f6fae593712e542f5229">GetMomentumLab</a>();                  <span class="comment">// p</span></div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[3] = (double)<a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() * <a class="code hl_function" href="classISSReaction.html#ad19626b55d856b809f89846a8b409a13">GetField_corr</a>();  <span class="comment">// qb</span></div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>    <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[3] /= TMath::TwoPi();                            <span class="comment">// qb/2pi</span></div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>    </div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>    <span class="comment">//for( unsigned int i = 0; i &lt; 4; ++i )</span></div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>    <span class="comment">//  std::cout &lt;&lt; &quot;params[&quot; &lt;&lt; i &lt;&lt; &quot;] = &quot; &lt;&lt; params[i] &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>    </div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>    <span class="comment">// Apply the energy loss correction and solve again</span></div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>    <span class="comment">// Keep going for 50 iterations or until we are better than 0.01% change</span></div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> iter = 0;</div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>    gErrorIgnoreLevel = kBreak; <span class="comment">// suppress warnings and errors, but not breaks</span></div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>    </div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span><span class="preprocessor">#ifdef butler_algorithm</span></div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>    <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> = <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a>;</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>    <span class="keywordtype">double</span> z_prev = 0.0;</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>    </div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span>    <span class="keywordflow">while</span>( TMath::Abs( ( <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> - z_prev ) / <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> ) &gt; 0.00001 &amp;&amp; iter &lt; 50 ) {</div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>        </div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>        <span class="comment">// Calculate the lab angle from z position (Butler method)</span></div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>        <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a>  = (double)<a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() * <a class="code hl_function" href="classISSReaction.html#ad19626b55d856b809f89846a8b409a13">GetField_corr</a>();     <span class="comment">// qb</span></div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>        <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> /= TMath::TwoPi();                            <span class="comment">// qb/2pi</span></div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>        <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> *= <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a>;                                         <span class="comment">// * z</span></div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span>        <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> /= <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#af22545627c83f6fae593712e542f5229">GetMomentumLab</a>();                 <span class="comment">// over p</span></div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>        <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a>  = TMath::ASin( <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> );</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>        </div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>        <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> = TMath::PiOver4();</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>        <span class="keywordtype">double</span> alpha_prev = 9999.;</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span>        </div>
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"> 1383</span>        <span class="keywordflow">while</span>( TMath::Abs( ( <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> - alpha_prev ) / <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> ) &gt; 0.0001 &amp;&amp; iter &lt; 50 ) {</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>            </div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>            <span class="comment">// Distance is negative because energy needs to be recovered</span></div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>            <span class="comment">// First we recover the energy lost in the Si dead layer</span></div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>            <span class="keywordtype">double</span> dist = -1.0 * <a class="code hl_variable" href="classISSReaction.html#a344c739edf79c6c6e25094cacfca8b28">deadlayer</a> / TMath::Abs( TMath::Cos( <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> ) );</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span>            <span class="keywordtype">double</span> eloss = <a class="code hl_function" href="classISSReaction.html#a7e33613ce6e80c530333cf96aac9a340">GetEnergyLoss</a>( en, dist, <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[2] );</div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>            <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#abafb553ba2ed67375a75e3a864f52842">SetEnergyLab</a>( en - eloss );</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>            </div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>            <span class="comment">// Then we recover the energy lost in the target</span></div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>            dist = -0.5 * <a class="code hl_variable" href="classISSReaction.html#aafcc62d779e00337aa5defd11d6abc3d">target_thickness</a> / TMath::Abs( TMath::Sin( <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> ) );</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>            eloss = <a class="code hl_function" href="classISSReaction.html#a7e33613ce6e80c530333cf96aac9a340">GetEnergyLoss</a>( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>(), dist, <a class="code hl_variable" href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">gStopping</a>[1] );</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>            <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#abafb553ba2ed67375a75e3a864f52842">SetEnergyLab</a>( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">GetEnergyLab</a>() - eloss );</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>            </div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>            <span class="comment">// Set parameters</span></div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>            <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a>[2] = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#af22545627c83f6fae593712e542f5229">GetMomentumLab</a>(); <span class="comment">// p</span></div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>            <a class="code hl_variable" href="classISSReaction.html#a5819db85711395799ad4d040a0415ba2">fa</a>-&gt;SetParameters( <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a> );</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>            <a class="code hl_variable" href="classISSReaction.html#a40ede1141847b9a90798eeb907490996">fb</a>-&gt;SetParameters( <a class="code hl_variable" href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">params</a> );</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span>            ROOT::Math::GradFunctor1D wf( *<a class="code hl_variable" href="classISSReaction.html#a5819db85711395799ad4d040a0415ba2">fa</a>, *<a class="code hl_variable" href="classISSReaction.html#a40ede1141847b9a90798eeb907490996">fb</a> );</div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>            </div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span><span class="preprocessor">#ifdef butler_algorithm</span></div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>            <span class="comment">// Use Butler&#39;s method and solve the root</span></div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>            z_prev = <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a>;</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>            <a class="code hl_variable" href="classISSReaction.html#a843c40e11d87b4f692be73d940c71399">rf</a>-&gt;SetFunction( wf, <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> );</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>            <a class="code hl_variable" href="classISSReaction.html#a843c40e11d87b4f692be73d940c71399">rf</a>-&gt;Solve( 500, 1e-5, 1e-6 );</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>            </div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>            <span class="comment">// Check result</span></div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>            <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#a843c40e11d87b4f692be73d940c71399">rf</a>-&gt;Status() ){</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>                <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> = TMath::QuietNaN();</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>            }</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>            <span class="keywordflow">else</span> <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> = <a class="code hl_variable" href="classISSReaction.html#a843c40e11d87b4f692be73d940c71399">rf</a>-&gt;Root();</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>            <span class="comment">// Build the alpha function and derivative, then solve</span></div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>            alpha_prev = <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a>;</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>            <a class="code hl_variable" href="classISSReaction.html#a843c40e11d87b4f692be73d940c71399">rf</a>-&gt;SetFunction( wf, 0.2 * TMath::Pi() ); <span class="comment">// with derivatives</span></div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>            <a class="code hl_variable" href="classISSReaction.html#a843c40e11d87b4f692be73d940c71399">rf</a>-&gt;Solve( 500, 1e-5, 1e-6 );</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>            </div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>            <span class="comment">// Check result</span></div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>            <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#a843c40e11d87b4f692be73d940c71399">rf</a>-&gt;Status() ){</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>                <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> = TMath::QuietNaN();</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>            }</div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>            <span class="keywordflow">else</span> <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> = <a class="code hl_variable" href="classISSReaction.html#a843c40e11d87b4f692be73d940c71399">rf</a>-&gt;Root();</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>            </div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span>            iter++;</div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span>            </div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>        }</div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>        </div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>        gErrorIgnoreLevel = kInfo; <span class="comment">// print info and above again</span></div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>        </div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span><span class="preprocessor">#ifdef butler_algorithm</span></div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span>        <span class="comment">// Calculate the lab angle from z position (Butler method)</span></div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>        <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a>  = (double)<a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">GetZ</a>() * <a class="code hl_function" href="classISSReaction.html#ad19626b55d856b809f89846a8b409a13">GetField_corr</a>();     <span class="comment">// qb</span></div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>        <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> /= TMath::TwoPi();                            <span class="comment">// qb/2pi</span></div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>        <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> *= <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a>;                                         <span class="comment">// * z</span></div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span>        <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> /= <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#af22545627c83f6fae593712e542f5229">GetMomentumLab</a>();                 <span class="comment">// over p</span></div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>        <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a>  = TMath::ASin( <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> );</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>        <span class="keywordtype">double</span> theta_lab = <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a>;</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span>        <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> &lt; 0 ) theta_lab += TMath::PiOver2();</div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>        <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#aca07c0149651d78693825c9003be08a7">SetThetaLab</a>( theta_lab );</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span><span class="preprocessor">#else</span></div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span>        <span class="comment">// Get the real z value at beam axis and lab angle (alpha method)</span></div>
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"> 1447</span>        <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> &lt; 0 ) <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> = <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> - <a class="code hl_variable" href="classISSReaction.html#afec1cbc2566feb68d42d352d51e86169">r_meas</a> * TMath::Tan( <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> );</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>        <span class="keywordflow">else</span> <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> = <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> + <a class="code hl_variable" href="classISSReaction.html#afec1cbc2566feb68d42d352d51e86169">r_meas</a> * TMath::Tan( <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> );</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>        <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#aca07c0149651d78693825c9003be08a7">SetThetaLab</a>( TMath::PiOver2() + <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> );</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>        </div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span>        <span class="comment">// Total energy of ejectile in centre of mass</span></div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>        <a class="code hl_variable" href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">e3_cm</a> = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ad32946b48929b71d7795f7322eeacb3d">GetEnergyTotLab</a>();</div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>        <a class="code hl_variable" href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">e3_cm</a> -= <a class="code hl_function" href="classISSReaction.html#a19f1f95b0c8e3074e79d9509bb06f2bb">GetBeta</a>() * <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#af22545627c83f6fae593712e542f5229">GetMomentumLab</a>() * TMath::Sin( <a class="code hl_variable" href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">alpha</a> );</div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>        <a class="code hl_variable" href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">e3_cm</a> *= <a class="code hl_function" href="classISSReaction.html#a7c5b735a73fb55aee805a12c7a7cdb0c">GetGamma</a>();</div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>        <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac397cd64652ba7d6604c1a6c4c64edcf">SetEnergyTotCM</a>( <a class="code hl_variable" href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">e3_cm</a> );</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span>        <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#ac397cd64652ba7d6604c1a6c4c64edcf">SetEnergyTotCM</a>( <a class="code hl_function" href="classISSReaction.html#a4634045d6c30df4996f3632f9b8d0046">GetEnergyTotCM</a>() - <a class="code hl_variable" href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">e3_cm</a> );</div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span>        </div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>        <span class="comment">// Theta_CM</span></div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>        <a class="code hl_variable" href="classISSReaction.html#ab41686e457e6cdb32b225c5bcbbcf0ab">theta_cm</a>  = <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ab338e58a9f995a1277dffac949e25c02">GetEnergyTotCM</a>();</div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>        <a class="code hl_variable" href="classISSReaction.html#ab41686e457e6cdb32b225c5bcbbcf0ab">theta_cm</a> -= <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ad32946b48929b71d7795f7322eeacb3d">GetEnergyTotLab</a>() / <a class="code hl_function" href="classISSReaction.html#a7c5b735a73fb55aee805a12c7a7cdb0c">GetGamma</a>();</div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>        <a class="code hl_variable" href="classISSReaction.html#ab41686e457e6cdb32b225c5bcbbcf0ab">theta_cm</a> /= <a class="code hl_function" href="classISSReaction.html#a19f1f95b0c8e3074e79d9509bb06f2bb">GetBeta</a>() * <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a07b98dafa1c81ff76f849d1ea79d49bf">GetMomentumCM</a>();</div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span>        <a class="code hl_variable" href="classISSReaction.html#ab41686e457e6cdb32b225c5bcbbcf0ab">theta_cm</a>  = TMath::ACos( <a class="code hl_variable" href="classISSReaction.html#ab41686e457e6cdb32b225c5bcbbcf0ab">theta_cm</a> );</div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span>        <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a277528b6ca85b6f07045ae34151bdf58">SetThetaCM</a>( <a class="code hl_variable" href="classISSReaction.html#ab41686e457e6cdb32b225c5bcbbcf0ab">theta_cm</a> );</div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span>        <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a277528b6ca85b6f07045ae34151bdf58">SetThetaCM</a>( TMath::Pi() - <a class="code hl_variable" href="classISSReaction.html#ab41686e457e6cdb32b225c5bcbbcf0ab">theta_cm</a> );</div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>        </div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>        <span class="comment">// Ex</span></div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>        <a class="code hl_variable" href="classISSReaction.html#a78838665b64cf7f500a1f2cad723cc16">Ex</a>  = TMath::Power( <a class="code hl_function" href="classISSReaction.html#a4634045d6c30df4996f3632f9b8d0046">GetEnergyTotCM</a>(), 2.0 );</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>        <a class="code hl_variable" href="classISSReaction.html#a78838665b64cf7f500a1f2cad723cc16">Ex</a> -= 2.0 * <a class="code hl_function" href="classISSReaction.html#a4634045d6c30df4996f3632f9b8d0046">GetEnergyTotCM</a>() * <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ab338e58a9f995a1277dffac949e25c02">GetEnergyTotCM</a>();</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>        <a class="code hl_variable" href="classISSReaction.html#a78838665b64cf7f500a1f2cad723cc16">Ex</a> += TMath::Power( <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#a842a20ceab0eaa3c64dddb83ceac0c86">GetMass</a>(), 2.0 );</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>        <a class="code hl_variable" href="classISSReaction.html#a78838665b64cf7f500a1f2cad723cc16">Ex</a>  = TMath::Sqrt( <a class="code hl_variable" href="classISSReaction.html#a78838665b64cf7f500a1f2cad723cc16">Ex</a> ) - <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#a842a20ceab0eaa3c64dddb83ceac0c86">GetMass</a>();</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>        <a class="code hl_variable" href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">Recoil</a>.<a class="code hl_function" href="classISSParticle.html#ac87d4befe0492e01b2e5b02a5adc1cfe">SetEx</a>( <a class="code hl_variable" href="classISSReaction.html#a78838665b64cf7f500a1f2cad723cc16">Ex</a> );</div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>        <a class="code hl_variable" href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">Ejectile</a>.<a class="code hl_function" href="classISSParticle.html#ac87d4befe0492e01b2e5b02a5adc1cfe">SetEx</a>( 0.0 );</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span>        </div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span>        <span class="comment">// Phi - TODO: This depends on the direction of the field!</span></div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>        <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#ac027b99074dbd0dc7024c5717353bcbf">phi_meas</a> &lt; 0 ) <a class="code hl_variable" href="classISSReaction.html#ac027b99074dbd0dc7024c5717353bcbf">phi_meas</a> += TMath::TwoPi();</div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>        <a class="code hl_variable" href="classISSReaction.html#ac23c3b2dede3a7ef6959d3fbcd848dcd">phi</a> = <a class="code hl_variable" href="classISSReaction.html#ac027b99074dbd0dc7024c5717353bcbf">phi_meas</a> * <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> / <a class="code hl_variable" href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">z_meas</a> + TMath::Pi();</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span>        <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#ac23c3b2dede3a7ef6959d3fbcd848dcd">phi</a> &gt; TMath::TwoPi() ) <a class="code hl_variable" href="classISSReaction.html#ac23c3b2dede3a7ef6959d3fbcd848dcd">phi</a> -= TMath::TwoPi();</div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span> </div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span>        </div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>        <span class="comment">// Debug output</span></div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>        <span class="keywordflow">if</span>( <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> &gt; 0 || <a class="code hl_variable" href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">z</a> &lt; 0 ){</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>            </div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>            <span class="comment">//std::cout &lt;&lt; &quot;z_meas = &quot; &lt;&lt; z_meas &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>            <span class="comment">//std::cout &lt;&lt; &quot;z_corr = &quot; &lt;&lt; z &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>            <span class="comment">//std::cout &lt;&lt; &quot;Ep = &quot; &lt;&lt; en &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>            <span class="comment">//std::cout &lt;&lt; &quot;alpha = &quot; &lt;&lt; alpha*TMath::RadToDeg() &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>            <span class="comment">//std::cout &lt;&lt; &quot;e3_cm = &quot; &lt;&lt; e3_cm &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>            <span class="comment">//std::cout &lt;&lt; &quot;e4_cm = &quot; &lt;&lt; Recoil.GetEnergyTotCM() &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>            <span class="comment">//std::cout &lt;&lt; &quot;etot_cm = &quot; &lt;&lt; GetEnergyTotCM() &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>            <span class="comment">//std::cout &lt;&lt; &quot;etot_lab = &quot; &lt;&lt; GetEnergyTotLab() &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span>            <span class="comment">//std::cout &lt;&lt; &quot;gamma = &quot; &lt;&lt; GetGamma() &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>            <span class="comment">//std::cout &lt;&lt; &quot;beta = &quot; &lt;&lt; GetBeta() &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span>            <span class="comment">//std::cout &lt;&lt; &quot;theta_cm = &quot; &lt;&lt; Recoil.GetThetaCM()*TMath::RadToDeg() &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>            <span class="comment">//std::cout &lt;&lt; &quot;Ex = &quot; &lt;&lt; Recoil.GetEx() &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>            <span class="comment">//std::cout &lt;&lt; std::endl;</span></div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span>            </div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>        }</div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span>        </div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>        </div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span>    }</div>
</div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>    </div>
<div class="ttc" id="aISSEvts_8hh_html_a2d3721b60d5268ab0f4fd5e063589def"><div class="ttname"><a href="ISSEvts_8hh.html#a2d3721b60d5268ab0f4fd5e063589def">array_radius</a></div><div class="ttdeci">const double array_radius</div><div class="ttdoc">radius to top surface of silicon (mm)</div><div class="ttdef"><b>Definition</b> <a href="ISSEvts_8hh_source.html#l00019">ISSEvts.hh:19</a></div></div>
<div class="ttc" id="aReaction_8cc_html_a2c077925a79d718068f85cbd7da5e1f9"><div class="ttname"><a href="Reaction_8cc.html#a2c077925a79d718068f85cbd7da5e1f9">params</a></div><div class="ttdeci">double * params</div><div class="ttdef"><b>Definition</b> <a href="#l00016">Reaction.cc:16</a></div></div>
<div class="ttc" id="aReaction_8cc_html_a30506dbffb6fb7641083ec5db1bab356"><div class="ttname"><a href="Reaction_8cc.html#a30506dbffb6fb7641083ec5db1bab356">qb</a></div><div class="ttdeci">double qb</div><div class="ttdef"><b>Definition</b> <a href="#l00023">Reaction.cc:23</a></div></div>
<div class="ttc" id="aReaction_8cc_html_a5e52f3b24f4e4b40f286508257368253"><div class="ttname"><a href="Reaction_8cc.html#a5e52f3b24f4e4b40f286508257368253">butler_derivative</a></div><div class="ttdeci">double butler_derivative(double *x, double *params)</div><div class="ttdef"><b>Definition</b> <a href="#l00083">Reaction.cc:83</a></div></div>
<div class="ttc" id="aReaction_8cc_html_a6516d0b611c080f9672b582640509a02"><div class="ttname"><a href="Reaction_8cc.html#a6516d0b611c080f9672b582640509a02">ClassImp</a></div><div class="ttdeci">ClassImp(ISSParticle) ClassImp(ISSReaction) ClassImp(ISSRxEvent) ClassImp(ISSRxInfo) double alpha_function(double *x</div></div>
<div class="ttc" id="aReaction_8cc_html_a96d07aa9cdab7337d6f6c58a4330ff50"><div class="ttname"><a href="Reaction_8cc.html#a96d07aa9cdab7337d6f6c58a4330ff50">butler_function</a></div><div class="ttdeci">double butler_function(double *x, double *params)</div><div class="ttdef"><b>Definition</b> <a href="#l00059">Reaction.cc:59</a></div></div>
<div class="ttc" id="aReaction_8cc_html_aabf34ec196861bf46e08d4db1cdefa00"><div class="ttname"><a href="Reaction_8cc.html#aabf34ec196861bf46e08d4db1cdefa00">alpha_derivative</a></div><div class="ttdeci">double alpha_derivative(double *x, double *params)</div><div class="ttdef"><b>Definition</b> <a href="#l00038">Reaction.cc:38</a></div></div>
<div class="ttc" id="aReaction_8cc_html_aace2d484b0e3651abd108f04803d316c"><div class="ttname"><a href="Reaction_8cc.html#aace2d484b0e3651abd108f04803d316c">p</a></div><div class="ttdeci">double p</div><div class="ttdef"><b>Definition</b> <a href="#l00022">Reaction.cc:22</a></div></div>
<div class="ttc" id="aReaction_8cc_html_ab3e6ed577a7c669c19de1f9c1b46c872"><div class="ttname"><a href="Reaction_8cc.html#ab3e6ed577a7c669c19de1f9c1b46c872">z</a></div><div class="ttdeci">double z</div><div class="ttdef"><b>Definition</b> <a href="#l00020">Reaction.cc:20</a></div></div>
<div class="ttc" id="aReaction_8cc_html_ab735a6fa7ba6047d143b13bd1bb35939"><div class="ttname"><a href="Reaction_8cc.html#ab735a6fa7ba6047d143b13bd1bb35939">theta_cm_function</a></div><div class="ttdeci">double theta_cm_function(double *x, double *params)</div><div class="ttdef"><b>Definition</b> <a href="#l00096">Reaction.cc:96</a></div></div>
<div class="ttc" id="aReaction_8cc_html_addc5f96b125bcc4afc42a5a44472c9d7"><div class="ttname"><a href="Reaction_8cc.html#addc5f96b125bcc4afc42a5a44472c9d7">r_meas</a></div><div class="ttdeci">double r_meas</div><div class="ttdef"><b>Definition</b> <a href="#l00021">Reaction.cc:21</a></div></div>
<div class="ttc" id="aReaction_8cc_html_adec064332fb7f7c5788d798dafbd9c7d"><div class="ttname"><a href="Reaction_8cc.html#adec064332fb7f7c5788d798dafbd9c7d">root</a></div><div class="ttdeci">double root</div><div class="ttdef"><b>Definition</b> <a href="#l00025">Reaction.cc:25</a></div></div>
<div class="ttc" id="aReaction_8cc_html_ae060f89e91da50f4921a6cefd17b86d5"><div class="ttname"><a href="Reaction_8cc.html#ae060f89e91da50f4921a6cefd17b86d5">theta_cm_derivative</a></div><div class="ttdeci">double theta_cm_derivative(double *x, double *params)</div><div class="ttdef"><b>Definition</b> <a href="#l00161">Reaction.cc:161</a></div></div>
<div class="ttc" id="aReaction_8hh_html"><div class="ttname"><a href="Reaction_8hh.html">Reaction.hh</a></div></div>
<div class="ttc" id="aReaction_8hh_html_a1ecc51e007dc445274ddb9227fe8cea8"><div class="ttname"><a href="Reaction_8hh.html#a1ecc51e007dc445274ddb9227fe8cea8">SRIM_DIR</a></div><div class="ttdeci">#define SRIM_DIR</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00045">Reaction.hh:45</a></div></div>
<div class="ttc" id="aReaction_8hh_html_a35cdfd07c72746ef0de43531a2eff02b"><div class="ttname"><a href="Reaction_8hh.html#a35cdfd07c72746ef0de43531a2eff02b">gElName</a></div><div class="ttdeci">const std::vector&lt; std::string &gt; gElName</div><div class="ttdoc">Symbols for each element in the nuclear chart.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00056">Reaction.hh:56</a></div></div>
<div class="ttc" id="aReaction_8hh_html_a559fda855a43e409dd7ab7e24e915c4e"><div class="ttname"><a href="Reaction_8hh.html#a559fda855a43e409dd7ab7e24e915c4e">k_Si</a></div><div class="ttdeci">const double k_Si</div><div class="ttdoc">k value - mm/e-h pair for PHD in silicon</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00052">Reaction.hh:52</a></div></div>
<div class="ttc" id="aReaction_8hh_html_aa07e932fa1af90883412b0528b733569"><div class="ttname"><a href="Reaction_8hh.html#aa07e932fa1af90883412b0528b733569">e0_Si</a></div><div class="ttdeci">const double e0_Si</div><div class="ttdoc">epsilon_0 for silicon for PHD in keV</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00053">Reaction.hh:53</a></div></div>
<div class="ttc" id="aReaction_8hh_html_af7b227b46086539a512daa3acc327be3"><div class="ttname"><a href="Reaction_8hh.html#af7b227b46086539a512daa3acc327be3">AME_FILE</a></div><div class="ttdeci">#define AME_FILE</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00042">Reaction.hh:42</a></div></div>
<div class="ttc" id="aclassISSParticle_html"><div class="ttname"><a href="classISSParticle.html">ISSParticle</a></div><div class="ttdoc">Stores information about individual particles in a given reaction.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00079">Reaction.hh:79</a></div></div>
<div class="ttc" id="aclassISSParticle_html_a02d0437ad0bda323e37046aeb6147eb4"><div class="ttname"><a href="classISSParticle.html#a02d0437ad0bda323e37046aeb6147eb4">ISSParticle::GetBindingEnergy</a></div><div class="ttdeci">double GetBindingEnergy()</div><div class="ttdoc">Calculates N = A - Z.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00091">Reaction.hh:91</a></div></div>
<div class="ttc" id="aclassISSParticle_html_a07b98dafa1c81ff76f849d1ea79d49bf"><div class="ttname"><a href="classISSParticle.html#a07b98dafa1c81ff76f849d1ea79d49bf">ISSParticle::GetMomentumCM</a></div><div class="ttdeci">double GetMomentumCM()</div><div class="ttdoc">Calculates the total momentum in the Lab frame.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00133">Reaction.hh:133</a></div></div>
<div class="ttc" id="aclassISSParticle_html_a16942178bd108e04c0d3766e09c8df54"><div class="ttname"><a href="classISSParticle.html#a16942178bd108e04c0d3766e09c8df54">ISSParticle::GetThetaCM</a></div><div class="ttdeci">double GetThetaCM()</div><div class="ttdoc">Getter for the total energy in the CM frame.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00094">Reaction.hh:94</a></div></div>
<div class="ttc" id="aclassISSParticle_html_a22a34635ef2860c9b6a88af5875d5c43"><div class="ttname"><a href="classISSParticle.html#a22a34635ef2860c9b6a88af5875d5c43">ISSParticle::GetMass_u</a></div><div class="ttdeci">double GetMass_u()</div><div class="ttdoc">Setter for Ex.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00109">Reaction.hh:109</a></div></div>
<div class="ttc" id="aclassISSParticle_html_a277528b6ca85b6f07045ae34151bdf58"><div class="ttname"><a href="classISSParticle.html#a277528b6ca85b6f07045ae34151bdf58">ISSParticle::SetThetaCM</a></div><div class="ttdeci">void SetThetaCM(double mytheta)</div><div class="ttdoc">Setter for Ecm_tot.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00104">Reaction.hh:104</a></div></div>
<div class="ttc" id="aclassISSParticle_html_a49edeb3017dd90592f00c4d6b8c347f1"><div class="ttname"><a href="classISSParticle.html#a49edeb3017dd90592f00c4d6b8c347f1">ISSParticle::SetZ</a></div><div class="ttdeci">void SetZ(int myZ)</div><div class="ttdoc">Setter for A.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00100">Reaction.hh:100</a></div></div>
<div class="ttc" id="aclassISSParticle_html_a57bcd669578c370986e213f251c8c958"><div class="ttname"><a href="classISSParticle.html#a57bcd669578c370986e213f251c8c958">ISSParticle::GetEx</a></div><div class="ttdeci">double GetEx()</div><div class="ttdoc">Getter for ThetaLab.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00096">Reaction.hh:96</a></div></div>
<div class="ttc" id="aclassISSParticle_html_a73d728c684110e70aca43354ffd6cc9f"><div class="ttname"><a href="classISSParticle.html#a73d728c684110e70aca43354ffd6cc9f">ISSParticle::GetA</a></div><div class="ttdeci">int GetA()</div><div class="ttdoc">Destructor.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00088">Reaction.hh:88</a></div></div>
<div class="ttc" id="aclassISSParticle_html_a842812781d7a5660599fc48e410265f3"><div class="ttname"><a href="classISSParticle.html#a842812781d7a5660599fc48e410265f3">ISSParticle::GetIsotope</a></div><div class="ttdeci">std::string GetIsotope()</div><div class="ttdoc">Returns mass in keV/c^2.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00120">Reaction.hh:120</a></div></div>
<div class="ttc" id="aclassISSParticle_html_a842a20ceab0eaa3c64dddb83ceac0c86"><div class="ttname"><a href="classISSParticle.html#a842a20ceab0eaa3c64dddb83ceac0c86">ISSParticle::GetMass</a></div><div class="ttdeci">double GetMass()</div><div class="ttdoc">Returns mass in u.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00113">Reaction.hh:113</a></div></div>
<div class="ttc" id="aclassISSParticle_html_a9e4770911da89a9ace8b8c10e4b408d3"><div class="ttname"><a href="classISSParticle.html#a9e4770911da89a9ace8b8c10e4b408d3">ISSParticle::GetZ</a></div><div class="ttdeci">int GetZ()</div><div class="ttdoc">Getter for A.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00089">Reaction.hh:89</a></div></div>
<div class="ttc" id="aclassISSParticle_html_aa6ea6e3af3e2e18146debfadf908335a"><div class="ttname"><a href="classISSParticle.html#aa6ea6e3af3e2e18146debfadf908335a">ISSParticle::SetBindingEnergy</a></div><div class="ttdeci">void SetBindingEnergy(double myBE)</div><div class="ttdoc">Setter for Z.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00101">Reaction.hh:101</a></div></div>
<div class="ttc" id="aclassISSParticle_html_ab338e58a9f995a1277dffac949e25c02"><div class="ttname"><a href="classISSParticle.html#ab338e58a9f995a1277dffac949e25c02">ISSParticle::GetEnergyTotCM</a></div><div class="ttdeci">double GetEnergyTotCM()</div><div class="ttdoc">Getter for the Elab; Ek = (γ-1)m0.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00093">Reaction.hh:93</a></div></div>
<div class="ttc" id="aclassISSParticle_html_abafb553ba2ed67375a75e3a864f52842"><div class="ttname"><a href="classISSParticle.html#abafb553ba2ed67375a75e3a864f52842">ISSParticle::SetEnergyLab</a></div><div class="ttdeci">void SetEnergyLab(double myElab)</div><div class="ttdoc">Setter for bindingE.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00102">Reaction.hh:102</a></div></div>
<div class="ttc" id="aclassISSParticle_html_abed1e6b453f7d590e76d3596b0bce6ac"><div class="ttname"><a href="classISSParticle.html#abed1e6b453f7d590e76d3596b0bce6ac">ISSParticle::GetBeta</a></div><div class="ttdeci">double GetBeta()</div><div class="ttdoc">Calculates the gamma factor: Etot = γm0.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00141">Reaction.hh:141</a></div></div>
<div class="ttc" id="aclassISSParticle_html_ac2d9c9dbfe276acc8006766ceb30796b"><div class="ttname"><a href="classISSParticle.html#ac2d9c9dbfe276acc8006766ceb30796b">ISSParticle::GetThetaLab</a></div><div class="ttdeci">double GetThetaLab()</div><div class="ttdoc">Getter for ThetaCM.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00095">Reaction.hh:95</a></div></div>
<div class="ttc" id="aclassISSParticle_html_ac397cd64652ba7d6604c1a6c4c64edcf"><div class="ttname"><a href="classISSParticle.html#ac397cd64652ba7d6604c1a6c4c64edcf">ISSParticle::SetEnergyTotCM</a></div><div class="ttdeci">void SetEnergyTotCM(double myEcm)</div><div class="ttdoc">Setter for Elab.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00103">Reaction.hh:103</a></div></div>
<div class="ttc" id="aclassISSParticle_html_ac87d4befe0492e01b2e5b02a5adc1cfe"><div class="ttname"><a href="classISSParticle.html#ac87d4befe0492e01b2e5b02a5adc1cfe">ISSParticle::SetEx</a></div><div class="ttdeci">void SetEx(double myEx)</div><div class="ttdoc">Setter for ThetaLab.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00106">Reaction.hh:106</a></div></div>
<div class="ttc" id="aclassISSParticle_html_ac93aac54cf779684284ad053c00fc3a6"><div class="ttname"><a href="classISSParticle.html#ac93aac54cf779684284ad053c00fc3a6">ISSParticle::GetEnergyLab</a></div><div class="ttdeci">double GetEnergyLab()</div><div class="ttdoc">Getter for bindingE.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00092">Reaction.hh:92</a></div></div>
<div class="ttc" id="aclassISSParticle_html_aca07c0149651d78693825c9003be08a7"><div class="ttname"><a href="classISSParticle.html#aca07c0149651d78693825c9003be08a7">ISSParticle::SetThetaLab</a></div><div class="ttdeci">void SetThetaLab(double mytheta)</div><div class="ttdoc">Setter for ThetaCM.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00105">Reaction.hh:105</a></div></div>
<div class="ttc" id="aclassISSParticle_html_ad32946b48929b71d7795f7322eeacb3d"><div class="ttname"><a href="classISSParticle.html#ad32946b48929b71d7795f7322eeacb3d">ISSParticle::GetEnergyTotLab</a></div><div class="ttdeci">double GetEnergyTotLab()</div><div class="ttdoc">Produces the isotope symbol including mass number e.g. 208Pb.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00124">Reaction.hh:124</a></div></div>
<div class="ttc" id="aclassISSParticle_html_ae28a54b8dda483771cf50e58b6b1aafb"><div class="ttname"><a href="classISSParticle.html#ae28a54b8dda483771cf50e58b6b1aafb">ISSParticle::SetA</a></div><div class="ttdeci">void SetA(int myA)</div><div class="ttdoc">Getter for Ex.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00099">Reaction.hh:99</a></div></div>
<div class="ttc" id="aclassISSParticle_html_af22545627c83f6fae593712e542f5229"><div class="ttname"><a href="classISSParticle.html#af22545627c83f6fae593712e542f5229">ISSParticle::GetMomentumLab</a></div><div class="ttdeci">double GetMomentumLab()</div><div class="ttdoc">Calculates the total energy in the lab frame: Etot = Ek + m0 = γm0.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00129">Reaction.hh:129</a></div></div>
<div class="ttc" id="aclassISSReaction_html"><div class="ttname"><a href="classISSReaction.html">ISSReaction</a></div><div class="ttdoc">Reads in the reaction file in ROOT's TConfig format. And also to do the physics stuff for the reactio...</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00171">Reaction.hh:171</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a024ad9bb0691b6b55faa72a8246f7232"><div class="ttname"><a href="classISSReaction.html#a024ad9bb0691b6b55faa72a8246f7232">ISSReaction::z0</a></div><div class="ttdeci">double z0</div><div class="ttdoc">Distance between the array and first silicon wafer.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00375">Reaction.hh:375</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a02b9af4c92541a2dd44e20169ed0447b"><div class="ttname"><a href="classISSReaction.html#a02b9af4c92541a2dd44e20169ed0447b">ISSReaction::CalculatePulseHeightCorrection</a></div><div class="ttdeci">void CalculatePulseHeightCorrection(std::string isotope)</div><div class="ttdoc">This function generates all neccessary pulse-height correction plots.</div><div class="ttdef"><b>Definition</b> <a href="#l01000">Reaction.cc:1000</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a04a1fd09e0469d805fa94df73765dec6"><div class="ttname"><a href="classISSReaction.html#a04a1fd09e0469d805fa94df73765dec6">ISSReaction::evszcutname</a></div><div class="ttdeci">std::vector&lt; std::string &gt; evszcutname</div><div class="ttdoc">The names of the E vs z cuts.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00453">Reaction.hh:453</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a0b99deb1a1d464c460c5f72bb2900955"><div class="ttname"><a href="classISSReaction.html#a0b99deb1a1d464c460c5f72bb2900955">ISSReaction::GetPulseHeightCorrection</a></div><div class="ttdeci">double GetPulseHeightCorrection(double Ei, bool detected)</div><div class="ttdoc">Returns the pulse height correction from the relevant TGraph.</div><div class="ttdef"><b>Definition</b> <a href="#l00988">Reaction.cc:988</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a0d8699a45c40e404ad7dfbd7b221ed7a"><div class="ttname"><a href="classISSReaction.html#a0d8699a45c40e404ad7dfbd7b221ed7a">ISSReaction::gPHC_inv</a></div><div class="ttdeci">std::unique_ptr&lt; TGraph &gt; gPHC_inv</div><div class="ttdoc">Flipped axes of gPHC.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00463">Reaction.hh:463</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a1306203fa1f40d6541fdc4c2e052b8a0"><div class="ttname"><a href="classISSReaction.html#a1306203fa1f40d6541fdc4c2e052b8a0">ISSReaction::EBIS_ratio</a></div><div class="ttdeci">double EBIS_ratio</div><div class="ttdoc">Ratio of ebis on/off as measured.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00403">Reaction.hh:403</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a1380ab0fc0280a85824c4a9e48b5900e"><div class="ttname"><a href="classISSReaction.html#a1380ab0fc0280a85824c4a9e48b5900e">ISSReaction::elum_rin</a></div><div class="ttdeci">double elum_rin</div><div class="ttdoc">inner radius of the ELUM detector</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00443">Reaction.hh:443</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a19f1f95b0c8e3074e79d9509bb06f2bb"><div class="ttname"><a href="classISSReaction.html#a19f1f95b0c8e3074e79d9509bb06f2bb">ISSReaction::GetBeta</a></div><div class="ttdeci">double GetBeta()</div><div class="ttdoc">Calculates the gamma factor for going between lab and CM frames.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00257">Reaction.hh:257</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a2d20defa409a7ba5aeab76ae4aaf5ec0"><div class="ttname"><a href="classISSReaction.html#a2d20defa409a7ba5aeab76ae4aaf5ec0">ISSReaction::elum_recoil_prompt</a></div><div class="ttdeci">double elum_recoil_prompt[2]</div><div class="ttdoc">Prompt time windows between recoil and elum event.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00425">Reaction.hh:425</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a33a6620f6b099925581e883a1f6cf304"><div class="ttname"><a href="classISSReaction.html#a33a6620f6b099925581e883a1f6cf304">ISSReaction::elum_deadlayer</a></div><div class="ttdeci">double elum_deadlayer</div><div class="ttdoc">Dead layer on ELUM in mm of Si equivalent.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00445">Reaction.hh:445</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a344c739edf79c6c6e25094cacfca8b28"><div class="ttname"><a href="classISSReaction.html#a344c739edf79c6c6e25094cacfca8b28">ISSReaction::deadlayer</a></div><div class="ttdeci">double deadlayer</div><div class="ttdoc">Dead layer on array silicon in mm of Si equivalent.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00376">Reaction.hh:376</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a3519ad8827535df9af318cb271c2788a"><div class="ttname"><a href="classISSReaction.html#a3519ad8827535df9af318cb271c2788a">ISSReaction::recoil_cut</a></div><div class="ttdeci">std::vector&lt; std::shared_ptr&lt; TCutG &gt; &gt; recoil_cut</div><div class="ttdoc">Vector containing the recoil cuts.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00456">Reaction.hh:456</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a35b6c40984615e7195549ff27492a3ed"><div class="ttname"><a href="classISSReaction.html#a35b6c40984615e7195549ff27492a3ed">ISSReaction::set</a></div><div class="ttdeci">std::shared_ptr&lt; ISSSettings &gt; set</div><div class="ttdoc">Smart pointer to the ISSSettings object.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00368">Reaction.hh:368</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a35f8209fb91d3decb1a1e582d64c8b4b"><div class="ttname"><a href="classISSReaction.html#a35f8209fb91d3decb1a1e582d64c8b4b">ISSReaction::GetQvalue</a></div><div class="ttdeci">double GetQvalue()</div><div class="ttdoc">Getter for the projected z (where the particle would intersect with the beam axis)</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00236">Reaction.hh:236</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a36c61a67fd69cd78d0800da598f730ce"><div class="ttname"><a href="classISSReaction.html#a36c61a67fd69cd78d0800da598f730ce">ISSReaction::elum_recoil_ratio</a></div><div class="ttdeci">double elum_recoil_ratio</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00427">Reaction.hh:427</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a376b78b49e6539283816c3c3db9e5558"><div class="ttname"><a href="classISSReaction.html#a376b78b49e6539283816c3c3db9e5558">ISSReaction::fInputFile</a></div><div class="ttdeci">std::string fInputFile</div><div class="ttdoc">The directory location of the input reaction file.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00365">Reaction.hh:365</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a390d45a97a79e814da75f103f3a1635b"><div class="ttname"><a href="classISSReaction.html#a390d45a97a79e814da75f103f3a1635b">ISSReaction::Recoil</a></div><div class="ttdeci">ISSParticle Recoil</div><div class="ttdoc">Recoil particle.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00382">Reaction.hh:382</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a3e37d91233f4c426a6a2ced39c6f5632"><div class="ttname"><a href="classISSReaction.html#a3e37d91233f4c426a6a2ced39c6f5632">ISSReaction::rxtree_flag</a></div><div class="ttdeci">bool rxtree_flag</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00419">Reaction.hh:419</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a40017cb95551a1d2045137aca76fd425"><div class="ttname"><a href="classISSReaction.html#a40017cb95551a1d2045137aca76fd425">ISSReaction::ReadMassTables</a></div><div class="ttdeci">void ReadMassTables()</div><div class="ttdoc">Reads the AME2020 mass tables.</div><div class="ttdef"><b>Definition</b> <a href="#l00332">Reaction.cc:332</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a40ede1141847b9a90798eeb907490996"><div class="ttname"><a href="classISSReaction.html#a40ede1141847b9a90798eeb907490996">ISSReaction::fb</a></div><div class="ttdeci">TF1 * fb</div><div class="ttdoc">Pointer to the derivative of the minimisation function.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00391">Reaction.hh:391</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a4241c6500ce557254dfcbeadb1e60cdb"><div class="ttname"><a href="classISSReaction.html#a4241c6500ce557254dfcbeadb1e60cdb">ISSReaction::SimulateReaction</a></div><div class="ttdeci">void SimulateReaction(TVector3 vec)</div><div class="ttdoc">Setup your particles, then call this with the ejectile detection position.</div><div class="ttdef"><b>Definition</b> <a href="#l01247">Reaction.cc:1247</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a4634045d6c30df4996f3632f9b8d0046"><div class="ttname"><a href="classISSReaction.html#a4634045d6c30df4996f3632f9b8d0046">ISSReaction::GetEnergyTotCM</a></div><div class="ttdeci">double GetEnergyTotCM()</div><div class="ttdoc">Calculates the total energy in the lab frame.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00245">Reaction.hh:245</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a49f9b17ebdb624e42438bf555afd262a"><div class="ttname"><a href="classISSReaction.html#a49f9b17ebdb624e42438bf555afd262a">ISSReaction::gPHC</a></div><div class="ttdeci">std::unique_ptr&lt; TGraph &gt; gPHC</div><div class="ttdoc">TGraph containing pulse-height correction information.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00462">Reaction.hh:462</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a4ee669e7a5f1e10359588e2818391fdb"><div class="ttname"><a href="classISSReaction.html#a4ee669e7a5f1e10359588e2818391fdb">ISSReaction::ISSReaction</a></div><div class="ttdeci">ISSReaction(std::string filename, std::shared_ptr&lt; ISSSettings &gt; myset, bool source)</div><div class="ttdoc">Constructor.</div><div class="ttdef"><b>Definition</b> <a href="#l00176">Reaction.cc:176</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a548c7232ebd368f5f6c237bd4179cbdf"><div class="ttname"><a href="classISSReaction.html#a548c7232ebd368f5f6c237bd4179cbdf">ISSReaction::array_recoil_random</a></div><div class="ttdeci">double array_recoil_random[2]</div><div class="ttdoc">Prompt time window between recoil and array event.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00423">Reaction.hh:423</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a5819db85711395799ad4d040a0415ba2"><div class="ttname"><a href="classISSReaction.html#a5819db85711395799ad4d040a0415ba2">ISSReaction::fa</a></div><div class="ttdeci">TF1 * fa</div><div class="ttdoc">Pointer to the minimisation function.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00390">Reaction.hh:390</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a5a60a17f7906086726d355d9c4cdf5dd"><div class="ttname"><a href="classISSReaction.html#a5a60a17f7906086726d355d9c4cdf5dd">ISSReaction::Mfield</a></div><div class="ttdeci">double Mfield</div><div class="ttdoc">Magnetic field strength in Telsa.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00374">Reaction.hh:374</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a5c4b0f91b7bebd1f75041f94611627b6"><div class="ttname"><a href="classISSReaction.html#a5c4b0f91b7bebd1f75041f94611627b6">ISSReaction::Target</a></div><div class="ttdeci">ISSParticle Target</div><div class="ttdoc">Target particle.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00380">Reaction.hh:380</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a607c106d914e9619cbee5351ea8fa437"><div class="ttname"><a href="classISSReaction.html#a607c106d914e9619cbee5351ea8fa437">ISSReaction::GetElumRecoilTimeRatio</a></div><div class="ttdeci">double GetElumRecoilTimeRatio()</div><div class="ttdoc">Getter for elum-recoil random time difference, used for defining coincidence windows.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00296">Reaction.hh:296</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a6a3030f5c356fe2df1db672ed72e2bd9"><div class="ttname"><a href="classISSReaction.html#a6a3030f5c356fe2df1db672ed72e2bd9">ISSReaction::phcurves</a></div><div class="ttdeci">bool phcurves</div><div class="ttdoc">Flag to indicate whether pulse height correction data was read successfully.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00465">Reaction.hh:465</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a6dbed1a57a850eae76bd9c0275dfe7f3"><div class="ttname"><a href="classISSReaction.html#a6dbed1a57a850eae76bd9c0275dfe7f3">ISSReaction::array_recoil_ratio</a></div><div class="ttdeci">double array_recoil_ratio</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00424">Reaction.hh:424</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a71000771f2de3911b1c2e83006b70372"><div class="ttname"><a href="classISSReaction.html#a71000771f2de3911b1c2e83006b70372">ISSReaction::array_recoil_prompt</a></div><div class="ttdeci">double array_recoil_prompt[2]</div><div class="ttdoc">Prompt time windows between recoil and array event.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00422">Reaction.hh:422</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a78838665b64cf7f500a1f2cad723cc16"><div class="ttname"><a href="classISSReaction.html#a78838665b64cf7f500a1f2cad723cc16">ISSReaction::Ex</a></div><div class="ttdeci">double Ex</div><div class="ttdoc">Excitation energy of recoil.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00396">Reaction.hh:396</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a7c5b735a73fb55aee805a12c7a7cdb0c"><div class="ttname"><a href="classISSReaction.html#a7c5b735a73fb55aee805a12c7a7cdb0c">ISSReaction::GetGamma</a></div><div class="ttdeci">double GetGamma()</div><div class="ttdoc">Calculates the total energy in the CM frame.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00253">Reaction.hh:253</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a7e33613ce6e80c530333cf96aac9a340"><div class="ttname"><a href="classISSReaction.html#a7e33613ce6e80c530333cf96aac9a340">ISSReaction::GetEnergyLoss</a></div><div class="ttdeci">double GetEnergyLoss(double Ei, double dist, std::unique_ptr&lt; TGraph &gt; &amp;g)</div><div class="ttdoc">Setter for the target offset (Y)</div><div class="ttdef"><b>Definition</b> <a href="#l00749">Reaction.cc:749</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a843c40e11d87b4f692be73d940c71399"><div class="ttname"><a href="classISSReaction.html#a843c40e11d87b4f692be73d940c71399">ISSReaction::rf</a></div><div class="ttdeci">std::unique_ptr&lt; ROOT::Math::RootFinder &gt; rf</div><div class="ttdoc">Pointer to a root finder object.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00388">Reaction.hh:388</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a874a6794d00162864859e686147fa1e9"><div class="ttname"><a href="classISSReaction.html#a874a6794d00162864859e686147fa1e9">ISSReaction::array_hist_mode</a></div><div class="ttdeci">bool array_hist_mode</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00416">Reaction.hh:416</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a891139efd11b9d84ea7a107293abdafc"><div class="ttname"><a href="classISSReaction.html#a891139efd11b9d84ea7a107293abdafc">ISSReaction::e3_cm</a></div><div class="ttdeci">double e3_cm</div><div class="ttdoc">Total energy of ejectile in centre of mass.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00395">Reaction.hh:395</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a893499127cdda06ebd65b452ce196842"><div class="ttname"><a href="classISSReaction.html#a893499127cdda06ebd65b452ce196842">ISSReaction::ReadReaction</a></div><div class="ttdeci">void ReadReaction()</div><div class="ttdoc">Reads the reaction input file.</div><div class="ttdef"><b>Definition</b> <a href="#l00402">Reaction.cc:402</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a895f215673d89b129f50254e79c47d49"><div class="ttname"><a href="classISSReaction.html#a895f215673d89b129f50254e79c47d49">ISSReaction::alpha_energies</a></div><div class="ttdeci">std::vector&lt; double &gt; alpha_energies</div><div class="ttdoc">Energies of the alphas for calibration in a source run.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00466">Reaction.hh:466</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a8b266f079eec81c5ca1cb5557e9e84f4"><div class="ttname"><a href="classISSReaction.html#a8b266f079eec81c5ca1cb5557e9e84f4">ISSReaction::Ejectile</a></div><div class="ttdeci">ISSParticle Ejectile</div><div class="ttdoc">Ejectile particle.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00381">Reaction.hh:381</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a9499ba48104aaf6baf36df40f049feb5"><div class="ttname"><a href="classISSReaction.html#a9499ba48104aaf6baf36df40f049feb5">ISSReaction::SetFile</a></div><div class="ttdeci">void SetFile(std::string filename)</div><div class="ttdoc">Setter for the reaction file location.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00185">Reaction.hh:185</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a95297d2ce63c688a3a8878a4dc5f5e46"><div class="ttname"><a href="classISSReaction.html#a95297d2ce63c688a3a8878a4dc5f5e46">ISSReaction::AddBindingEnergy</a></div><div class="ttdeci">void AddBindingEnergy(short Ai, short Zi, TString ame_be_str)</div><div class="ttdoc">Destructor.</div><div class="ttdef"><b>Definition</b> <a href="#l00307">Reaction.cc:307</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a9a12b81efcfe420e51f5c7eee374fd18"><div class="ttname"><a href="classISSReaction.html#a9a12b81efcfe420e51f5c7eee374fd18">ISSReaction::fsim</a></div><div class="ttdeci">TF1 * fsim</div><div class="ttdoc">Pointer to the minimisation function for the simulation of the reaction.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00392">Reaction.hh:392</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a9cfe688464099d479b5a299e89378783"><div class="ttname"><a href="classISSReaction.html#a9cfe688464099d479b5a299e89378783">ISSReaction::stopping</a></div><div class="ttdeci">bool stopping</div><div class="ttdoc">Flag to indicate whether calculation of stopping powers has worked or not.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00464">Reaction.hh:464</a></div></div>
<div class="ttc" id="aclassISSReaction_html_a9d0dc889d9edd419b9aa99fa0ae38cbb"><div class="ttname"><a href="classISSReaction.html#a9d0dc889d9edd419b9aa99fa0ae38cbb">ISSReaction::EBIS_Off</a></div><div class="ttdeci">double EBIS_Off</div><div class="ttdoc">Beam off max time in ns.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00402">Reaction.hh:402</a></div></div>
<div class="ttc" id="aclassISSReaction_html_aa37e457510dc2ef79dbe6c36dd8e4a9f"><div class="ttname"><a href="classISSReaction.html#aa37e457510dc2ef79dbe6c36dd8e4a9f">ISSReaction::GetEBISTimeRatio</a></div><div class="ttdeci">double GetEBISTimeRatio()</div><div class="ttdoc">Getter for the EBIS OFF time.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00222">Reaction.hh:222</a></div></div>
<div class="ttc" id="aclassISSReaction_html_aa4d5668b2abdd62b03825bfc655f6287"><div class="ttname"><a href="classISSReaction.html#aa4d5668b2abdd62b03825bfc655f6287">ISSReaction::gStopping</a></div><div class="ttdeci">std::vector&lt; std::unique_ptr&lt; TGraph &gt; &gt; gStopping</div><div class="ttdoc">Vector of pointer to relevant stopping-power TGraphs relevant to the reaction of study.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00460">Reaction.hh:460</a></div></div>
<div class="ttc" id="aclassISSReaction_html_aa68224abe77090438791b0b4a9cb4907"><div class="ttname"><a href="classISSReaction.html#aa68224abe77090438791b0b4a9cb4907">ISSReaction::z</a></div><div class="ttdeci">double z</div><div class="ttdoc">Projected z distance from target that ejectile interesect the beam axis.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00432">Reaction.hh:432</a></div></div>
<div class="ttc" id="aclassISSReaction_html_aa6c11b3484ae6c3317fca74023e57803"><div class="ttname"><a href="classISSReaction.html#aa6c11b3484ae6c3317fca74023e57803">ISSReaction::SimulateDecay</a></div><div class="ttdeci">double SimulateDecay(TVector3 vec, double en, int detector=0)</div><div class="ttdoc">Called during the autocalibration process with alphas.</div><div class="ttdef"><b>Definition</b> <a href="#l01166">Reaction.cc:1166</a></div></div>
<div class="ttc" id="aclassISSReaction_html_aa6d60a463ad5e3a9ab70adf3a7d4929f"><div class="ttname"><a href="classISSReaction.html#aa6d60a463ad5e3a9ab70adf3a7d4929f">ISSReaction::flag_source</a></div><div class="ttdeci">bool flag_source</div><div class="ttdoc">Flag in case it's an alpha source run.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00470">Reaction.hh:470</a></div></div>
<div class="ttc" id="aclassISSReaction_html_aab0c94813ab987498832bf77b2131cc1"><div class="ttname"><a href="classISSReaction.html#aab0c94813ab987498832bf77b2131cc1">ISSReaction::alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdoc">An angle used for calculating ThetaCM and Ex.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00398">Reaction.hh:398</a></div></div>
<div class="ttc" id="aclassISSReaction_html_aafcc62d779e00337aa5defd11d6abc3d"><div class="ttname"><a href="classISSReaction.html#aafcc62d779e00337aa5defd11d6abc3d">ISSReaction::target_thickness</a></div><div class="ttdeci">double target_thickness</div><div class="ttdoc">Target thickness in units of mg/cm^2.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00437">Reaction.hh:437</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ab046d9c215f2be2f43f3af6d2cb3fcc4"><div class="ttname"><a href="classISSReaction.html#ab046d9c215f2be2f43f3af6d2cb3fcc4">ISSReaction::gRange</a></div><div class="ttdeci">std::vector&lt; std::unique_ptr&lt; TGraph &gt; &gt; gRange</div><div class="ttdoc">Vector of pointer to relevant range TGraphs relevant to the reaction of study.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00461">Reaction.hh:461</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ab3971fa9b0c406b88590283d27710cf7"><div class="ttname"><a href="classISSReaction.html#ab3971fa9b0c406b88590283d27710cf7">ISSReaction::ReadStoppingPowers</a></div><div class="ttdeci">bool ReadStoppingPowers(std::string isotope1, std::string isotope2, std::unique_ptr&lt; TGraph &gt; &amp;g, std::unique_ptr&lt; TGraph &gt; &amp;r, bool electriconly=false, bool nuclearonly=false)</div><div class="ttdoc">Reads relevant SRIM files.</div><div class="ttdef"><b>Definition</b> <a href="#l00815">Reaction.cc:815</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ab41686e457e6cdb32b225c5bcbbcf0ab"><div class="ttname"><a href="classISSReaction.html#ab41686e457e6cdb32b225c5bcbbcf0ab">ISSReaction::theta_cm</a></div><div class="ttdeci">double theta_cm</div><div class="ttdoc">CM angle for ejectile/recoil.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00397">Reaction.hh:397</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ab41c921c55f7ff81e0faa8466c3cc160"><div class="ttname"><a href="classISSReaction.html#ab41c921c55f7ff81e0faa8466c3cc160">ISSReaction::elum_rout</a></div><div class="ttdeci">double elum_rout</div><div class="ttdoc">outer radius of the ELUM detector</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00444">Reaction.hh:444</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ab5d66ec25b61e0b6a6a0c3590b007fef"><div class="ttname"><a href="classISSReaction.html#ab5d66ec25b61e0b6a6a0c3590b007fef">ISSReaction::x_offset</a></div><div class="ttdeci">double x_offset</div><div class="ttdoc">Horizontal offset of the target/beam position, with respect to the array in mm.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00438">Reaction.hh:438</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ab8e40b35d77220f697c8a46fee95522f"><div class="ttname"><a href="classISSReaction.html#ab8e40b35d77220f697c8a46fee95522f">ISSReaction::evszcutfile</a></div><div class="ttdeci">std::vector&lt; std::string &gt; evszcutfile</div><div class="ttdoc">The location of the E vs z cut files.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00452">Reaction.hh:452</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ab91898a11ed53a3150f9c3809e2f2001"><div class="ttname"><a href="classISSReaction.html#ab91898a11ed53a3150f9c3809e2f2001">ISSReaction::laser_mode</a></div><div class="ttdeci">unsigned char laser_mode</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00410">Reaction.hh:410</a></div></div>
<div class="ttc" id="aclassISSReaction_html_abab36c9b636d932ce4fa0382cb9450ab"><div class="ttname"><a href="classISSReaction.html#abab36c9b636d932ce4fa0382cb9450ab">ISSReaction::t1_max_time</a></div><div class="ttdeci">double t1_max_time</div><div class="ttdoc">T1 pulse max time.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00406">Reaction.hh:406</a></div></div>
<div class="ttc" id="aclassISSReaction_html_abcd2c1e2e3ead74e3c264c06fedbbfad"><div class="ttname"><a href="classISSReaction.html#abcd2c1e2e3ead74e3c264c06fedbbfad">ISSReaction::Beam</a></div><div class="ttdeci">ISSParticle Beam</div><div class="ttdoc">Beam particle.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00379">Reaction.hh:379</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ac027b99074dbd0dc7024c5717353bcbf"><div class="ttname"><a href="classISSReaction.html#ac027b99074dbd0dc7024c5717353bcbf">ISSReaction::phi_meas</a></div><div class="ttdeci">double phi_meas</div><div class="ttdoc">Measured phi angle that ejectile interesect the silicon detector.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00433">Reaction.hh:433</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ac1f129ae2c5512d6d05073d3f9e27b6a"><div class="ttname"><a href="classISSReaction.html#ac1f129ae2c5512d6d05073d3f9e27b6a">ISSReaction::dsim</a></div><div class="ttdeci">TF1 * dsim</div><div class="ttdoc">Pointer to the derivative of the minimisation function for the simulation of the reaction.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00393">Reaction.hh:393</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ac23c3b2dede3a7ef6959d3fbcd848dcd"><div class="ttname"><a href="classISSReaction.html#ac23c3b2dede3a7ef6959d3fbcd848dcd">ISSReaction::phi</a></div><div class="ttdeci">double phi</div><div class="ttdoc">Projected phi angle of the ejectile emitted from the target.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00434">Reaction.hh:434</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ac912744a547580b017ac078ab88cb597"><div class="ttname"><a href="classISSReaction.html#ac912744a547580b017ac078ab88cb597">ISSReaction::nrecoilcuts</a></div><div class="ttdeci">unsigned int nrecoilcuts</div><div class="ttdoc">The number of recoil cuts.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00448">Reaction.hh:448</a></div></div>
<div class="ttc" id="aclassISSReaction_html_acd2c7f71be4c423656d8b0efb606d45b"><div class="ttname"><a href="classISSReaction.html#acd2c7f71be4c423656d8b0efb606d45b">ISSReaction::Eb</a></div><div class="ttdeci">double Eb</div><div class="ttdoc">Laboratory beam energy in keV/u.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00385">Reaction.hh:385</a></div></div>
<div class="ttc" id="aclassISSReaction_html_acd39d4d715b6635ebc1548872210b007"><div class="ttname"><a href="classISSReaction.html#acd39d4d715b6635ebc1548872210b007">ISSReaction::nevszcuts</a></div><div class="ttdeci">unsigned int nevszcuts</div><div class="ttdoc">The number of E vs z cuts.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00449">Reaction.hh:449</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ad10963ba32970b7ff3c303bdd0c7d642"><div class="ttname"><a href="classISSReaction.html#ad10963ba32970b7ff3c303bdd0c7d642">ISSReaction::rfsim</a></div><div class="ttdeci">std::unique_ptr&lt; ROOT::Math::RootFinder &gt; rfsim</div><div class="ttdoc">Pointer to a root finder object for the simulation of the reaction.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00389">Reaction.hh:389</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ad19626b55d856b809f89846a8b409a13"><div class="ttname"><a href="classISSReaction.html#ad19626b55d856b809f89846a8b409a13">ISSReaction::GetField_corr</a></div><div class="ttdeci">double GetField_corr()</div><div class="ttdoc">Getter for the magnetic field strength.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00201">Reaction.hh:201</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ad74e98af4ec57c4319a57d7d30d28475"><div class="ttname"><a href="classISSReaction.html#ad74e98af4ec57c4319a57d7d30d28475">ISSReaction::y_offset</a></div><div class="ttdeci">double y_offset</div><div class="ttdoc">Vertical offset of the target/beam position, with respect to the array in mm.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00439">Reaction.hh:439</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ad75dff2c1bbc19c8fbba6aa8a4e17ffd"><div class="ttname"><a href="classISSReaction.html#ad75dff2c1bbc19c8fbba6aa8a4e17ffd">ISSReaction::SimulateEmission</a></div><div class="ttdeci">double SimulateEmission(double en, double theta_lab, double phi_lab, int detector=0)</div><div class="ttdoc">Called during the simulation of particle emission.</div><div class="ttdef"><b>Definition</b> <a href="#l01105">Reaction.cc:1105</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ad84c32fc1188533e5da2ee8407cc13af"><div class="ttname"><a href="classISSReaction.html#ad84c32fc1188533e5da2ee8407cc13af">ISSReaction::e_vs_z_cut</a></div><div class="ttdeci">std::vector&lt; std::shared_ptr&lt; TCutG &gt; &gt; e_vs_z_cut</div><div class="ttdoc">Vector containing the E vs z cuts.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00457">Reaction.hh:457</a></div></div>
<div class="ttc" id="aclassISSReaction_html_adb9512f5ccfd619926bdeca3390f6c39"><div class="ttname"><a href="classISSReaction.html#adb9512f5ccfd619926bdeca3390f6c39">ISSReaction::recoilcutfile</a></div><div class="ttdeci">std::vector&lt; std::string &gt; recoilcutfile</div><div class="ttdoc">The location of the recoil cut files.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00450">Reaction.hh:450</a></div></div>
<div class="ttc" id="aclassISSReaction_html_adcc8a162077804557bb31ebae606c3ad"><div class="ttname"><a href="classISSReaction.html#adcc8a162077804557bb31ebae606c3ad">ISSReaction::GetNuclearEnergyLoss</a></div><div class="ttdeci">double GetNuclearEnergyLoss(double Ei, double range, std::unique_ptr&lt; TGraph &gt; &amp;gn, std::unique_ptr&lt; TGraph &gt; &amp;gtot)</div><div class="ttdoc">Calculate the nuclear specific energy loss.</div><div class="ttdef"><b>Definition</b> <a href="#l00782">Reaction.cc:782</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ae05f6c7c66ad83124da9617d7d3342ba"><div class="ttname"><a href="classISSReaction.html#ae05f6c7c66ad83124da9617d7d3342ba">ISSReaction::GetArrayRecoilTimeRatio</a></div><div class="ttdeci">double GetArrayRecoilTimeRatio()</div><div class="ttdoc">Getter for array-recoil random time difference, used for defining coincidence windows.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00274">Reaction.hh:274</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ae33c2eba4c4f58d816ac134609def3ca"><div class="ttname"><a href="classISSReaction.html#ae33c2eba4c4f58d816ac134609def3ca">ISSReaction::params</a></div><div class="ttdeci">double params[9]</div><div class="ttdoc">Array for holding parameters for the functions.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00394">Reaction.hh:394</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ae584fb00618d238d9e3012c40e3f1ea4"><div class="ttname"><a href="classISSReaction.html#ae584fb00618d238d9e3012c40e3f1ea4">ISSReaction::ame_be</a></div><div class="ttdeci">std::map&lt; std::string, double &gt; ame_be</div><div class="ttdoc">List of binding energies from AME2020.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00371">Reaction.hh:371</a></div></div>
<div class="ttc" id="aclassISSReaction_html_ae93210902046e4f60d6ef55c54a8c78c"><div class="ttname"><a href="classISSReaction.html#ae93210902046e4f60d6ef55c54a8c78c">ISSReaction::z_meas</a></div><div class="ttdeci">double z_meas</div><div class="ttdoc">Measured z distance from target that ejectile interesect the silicon detector.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00431">Reaction.hh:431</a></div></div>
<div class="ttc" id="aclassISSReaction_html_aea5baed953c7ad206f2bb7fc951baf1a"><div class="ttname"><a href="classISSReaction.html#aea5baed953c7ad206f2bb7fc951baf1a">ISSReaction::elum_recoil_random</a></div><div class="ttdeci">double elum_recoil_random[2]</div><div class="ttdoc">Prompt time window between recoil and elum event.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00426">Reaction.hh:426</a></div></div>
<div class="ttc" id="aclassISSReaction_html_aee8d77de7342c200a7576b281236825a"><div class="ttname"><a href="classISSReaction.html#aee8d77de7342c200a7576b281236825a">ISSReaction::recoilcutname</a></div><div class="ttdeci">std::vector&lt; std::string &gt; recoilcutname</div><div class="ttdoc">The names of the recoil cuts.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00451">Reaction.hh:451</a></div></div>
<div class="ttc" id="aclassISSReaction_html_af0020ca1f58ef4bc2bfd2da5e6be56f5"><div class="ttname"><a href="classISSReaction.html#af0020ca1f58ef4bc2bfd2da5e6be56f5">ISSReaction::elum_z</a></div><div class="ttdeci">double elum_z</div><div class="ttdoc">z position of the ELUM (usually positive, but if negative assumed not to exist in setup)</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00442">Reaction.hh:442</a></div></div>
<div class="ttc" id="aclassISSReaction_html_af09b6b1b50e23050ab80afeff489181f"><div class="ttname"><a href="classISSReaction.html#af09b6b1b50e23050ab80afeff489181f">ISSReaction::MakeReaction</a></div><div class="ttdeci">void MakeReaction(TVector3 vec, double en)</div><div class="ttdoc">Called event-by-event for transfer reactions.</div><div class="ttdef"><b>Definition</b> <a href="#l01324">Reaction.cc:1324</a></div></div>
<div class="ttc" id="aclassISSReaction_html_af675ea3ac3749a12c0e7bb6b05c1657b"><div class="ttname"><a href="classISSReaction.html#af675ea3ac3749a12c0e7bb6b05c1657b">ISSReaction::t1_min_time</a></div><div class="ttdeci">double t1_min_time</div><div class="ttdoc">T1 pulse min time.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00407">Reaction.hh:407</a></div></div>
<div class="ttc" id="aclassISSReaction_html_afa52f1d5e98b64c32f5931bb4e7a38fe"><div class="ttname"><a href="classISSReaction.html#afa52f1d5e98b64c32f5931bb4e7a38fe">ISSReaction::EBIS_On</a></div><div class="ttdeci">double EBIS_On</div><div class="ttdoc">Beam on max time in ns.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00401">Reaction.hh:401</a></div></div>
<div class="ttc" id="aclassISSReaction_html_afec1cbc2566feb68d42d352d51e86169"><div class="ttname"><a href="classISSReaction.html#afec1cbc2566feb68d42d352d51e86169">ISSReaction::r_meas</a></div><div class="ttdeci">double r_meas</div><div class="ttdoc">Measured radius of the ejectile when it interects the array.</div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00430">Reaction.hh:430</a></div></div>
<div class="ttc" id="aclassISSRxEvent_html"><div class="ttname"><a href="classISSRxEvent.html">ISSRxEvent</a></div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00474">Reaction.hh:474</a></div></div>
<div class="ttc" id="aclassISSRxInfo_html"><div class="ttname"><a href="classISSRxInfo.html">ISSRxInfo</a></div><div class="ttdef"><b>Definition</b> <a href="Reaction_8hh_source.html#l00552">Reaction.hh:552</a></div></div>
<div class="ttc" id="aiss__sort_8cc_html_aef2e709b38e28fdbbfe36870c344b223"><div class="ttname"><a href="iss__sort_8cc.html#aef2e709b38e28fdbbfe36870c344b223">myset</a></div><div class="ttdeci">std::shared_ptr&lt; ISSSettings &gt; myset</div><div class="ttdef"><b>Definition</b> <a href="iss__sort_8cc_source.html#l00106">iss_sort.cc:106</a></div></div>
<div class="ttc" id="az__to__angle__simulator_8cc_html_ab17935dd73a49ff6d8a06026a1950a0a"><div class="ttname"><a href="z__to__angle__simulator_8cc.html#ab17935dd73a49ff6d8a06026a1950a0a">g</a></div><div class="ttdeci">TGraph2D * g</div><div class="ttdef"><b>Definition</b> <a href="z__to__angle__simulator_8cc_source.html#l00031">z_to_angle_simulator.cc:31</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
