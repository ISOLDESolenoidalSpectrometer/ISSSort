<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.11.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ISSSort: ISSSort</title>
<link rel="icon" href=".isssort_logo.png" type="image/x-icon" />
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src=".isssort_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">ISSSort
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.11.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">ISSSort </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> <a href="https://doi.org/10.5281/zenodo.6366317"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.6366317.svg" alt="DOI" style="pointer-events: none;" class="inline"/></a></p>
<p>A code for sorting raw data from the ISOLDE Solendoidal Spectrometer in MIDAS format.</p>
<p>If you are using this code for any of your publications, please cite it using the DOI: 10.5281/zenodo.6366317</p>
<h1><a class="anchor" id="autotoc_md1"></a>
Instructions and user guide</h1>
<p>For the full details of how to use ISSSort, please take a look at the Wiki here on GitHub: <a href="https://github.com/ISOLDESolenoidalSpectrometer/ISSSort/wiki">https://github.com/ISOLDESolenoidalSpectrometer/ISSSort/wiki</a></p>
<p>Some basic intructions are included in the below README.</p>
<h1><a class="anchor" id="autotoc_md2"></a>
Download</h1>
<div class="fragment"><div class="line">git clone https://github.com/ISOLDESolenoidalSpectrometer/ISSSort</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md3"></a>
Compile</h1>
<div class="fragment"><div class="line">make clean</div>
<div class="line">make</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md4"></a>
Execute</h1>
<div class="fragment"><div class="line">iss_sort</div>
</div><!-- fragment --><p> if you add the ISSSort/bin to your PATH variable. You can also add ISSSort/lib to your (DY)LD_LIBRARY_PATH too.</p>
<p>or </p><div class="fragment"><div class="line">./bin/iss_sort</div>
</div><!-- fragment --><p>If you start the code without any flags, it will launch the GUI. To run in batch mode, simple pass at least one file to the programme with the -i flag.</p>
<p>The input options are described below.</p>
<div class="fragment"><div class="line">use iss_sort with following flags:</div>
<div class="line">        [-i           &lt;vector&lt;string&gt;&gt;: List of input files]</div>
<div class="line">        [-o           &lt;string        &gt;: Output file for histogram file]</div>
<div class="line">        [-s           &lt;string        &gt;: Settings file]</div>
<div class="line">        [-c           &lt;string        &gt;: Calibration file]</div>
<div class="line">        [-r           &lt;string        &gt;: Reaction file]</div>
<div class="line">        [-nptool                      : Flag for NPTool simulation input]</div>
<div class="line">        [-pace4                       : Flag for PACE4 particle input]</div>
<div class="line">        [-f                           : Flag to force new ROOT conversion]</div>
<div class="line">        [-e                           : Flag to force new event builder (new calibration)]</div>
<div class="line">        [-source                      : Flag to define an source only run]</div>
<div class="line">        [-autocal                     : Flag to perform automatic calibration of alpha source data]</div>
<div class="line">        [-autocalfile &lt;string        &gt;: Alpha source fit control file]</div>
<div class="line">        [-spy                         : Flag to run the DataSpy]</div>
<div class="line">        [-m           &lt;int           &gt;: Monitor input file every X seconds]</div>
<div class="line">        [-p           &lt;int           &gt;: Port number for web server (default 8030)]</div>
<div class="line">        [-d           &lt;string        &gt;: Output directory for sorted files]</div>
<div class="line">        [-g                           : Launch the GUI]</div>
<div class="line">        [-h                           : Print this help]</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md5"></a>
Sorting Philosophy</h1>
<p>The code can be run entirely with default values, meaning that none of the additional input files are required in order to sort the data.</p>
<h2><a class="anchor" id="autotoc_md6"></a>
Step 1: Converter</h2>
<p>Running iss_sort with a list of input files, using the <code>-i</code> flag, will simple convert them to ROOT format. This step produces one output file per input file, which has the name of the input file, appended with .root.</p>
<p>If a calibration file is added with the <code>-c</code> flag, the ADC data is calibrated for energy. An example calibration file is included in the source of this code, including a description of the format.</p>
<p>A settings file can also be included with the <code>-s</code> flag to overwrite any of the defaults for the configuration of the electronics and detectors. An example settings file is included in the source of this code, including a description of the format.</p>
<p>The ouptut file contains a single ROOT tree of the data and a series of diagnostic histograms and singles spectra. If the output file already exists, <code>iss_sort</code> will skip this step unless the <code>-f</code> flag is used.</p>
<p>If this is a calibration source run, declare the -source flag, which skips the following unnecessary stages of analysis. The output file in this case will not have any tree data and will be appended with <code>_source.root</code>. If you add the <code>-autocal</code> flag, the programme assumes you have given data from a quadruple alpha source and will attempt to perform an automatic strip-by-strip calibration. To correct for energy losses accuratley, you must also provide a reaction file with the Mfield, TargetArrayDistance and ArrayDeadLayer parameters at minimum.</p>
<h2><a class="anchor" id="autotoc_md7"></a>
Step 2: Time Sorting</h2>
<p>In order to combine timestamp and ADC data, the time sorting step needs to be performed. This step is contained within the conversion step as long as you are not using the <code>-source</code> flag and time-sorted data will then be written to the <code>iss_sort</code> tree. This is potentially the slowest part of the process if there is a lot of data out of order due to the number of I/O operations.</p>
<h2><a class="anchor" id="autotoc_md8"></a>
Step 3: Event Builder</h2>
<p>The next step is the event builder, which runs if the <code>-e</code> flag is used, or automatically if a new file has been converted. This uses the calibrated, time sorted data from the previous step to produce one output file per input, appended with <code>_events.root</code>. The same settings file from the Converter step is reused for the same parameters, plus the length of the build window (default 3 Âµs). There is a plan to have these setting written in to the ROOT file itself, so the file doesn't need to be passed again, but this isn't the case yet.</p>
<p>Events are built according to the particles on the array, correlating n- and p-side data, and also for recoil events, elum events, and ZeroDegree events in separate classes. This format is all contained within the <a class="el" href="classISSEvts.html">ISSEvts</a> class, which you can browse to see which functions are available. If you open the output file and want to draw directly from the <code>evt_tree</code>, you can load the library with <code>gSystem-&gt;Load("/path/to/ISSSort/lib/libiss_sort.so")</code> or by adding it to your .rootlogon.C. Then you have access to all the member functions like <code>array_event-&gt;GetZ()</code>, <code>recoil_event-&gt;GetEnergyLoss()</code>, <code>elum_event-&gt;GetSector()</code>, etc.</p>
<h2><a class="anchor" id="autotoc_md9"></a>
Step 4: Histogramming</h2>
<p>Finally a bunch of standard physics histograms are built using input from the reaction file, given with the <code>-r</code> flag. An example reaction file is included in the source of this code, including a description of the format.</p>
<p>The code will now chain together all of the event trees from the previous step to produce a single output file given with the <code>-o</code> flag. The default file name will be the first input file appended with <code>_hists.root</code>.</p>
<p>At this stage, you can generate cuts on the recoil spectra or the energy versus z plots and add them to the reaction file. Pulse height corrections are also performed at this step to account for the non-lineary energy response to light ions in silicon.</p>
<p>Users can edit this code as they please, producing their own plots. There is no "user input" specifically, but if there are extra histograms that are of use to the community, please send me an email or raise a feature request on GitHub and I will consider adding it to the standard code.</p>
<h1><a class="anchor" id="autotoc_md10"></a>
Extra features</h1>
<h2><a class="anchor" id="autotoc_md11"></a>
NPTool sorting</h2>
<p>You can sort simulation output files from NPTool by using the <code>-nptool</code> flag. You need to give the ROOT file containing the <code>SimulatedTree</code> as the input and the reaction file as normal.</p>
<h2><a class="anchor" id="autotoc_md12"></a>
PACE4 fusion-evaporation simulations</h2>
<p>One can perform fusion-evaporation simulations using the output from PACE4, by passing the <code>-pace4</code> flag. You need to give the <code>pName.particles</code> file that is produced by PACE4 containing the Monte-Carlo proton and alpha particle data as the input and the reaction file as normal.</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Dependencies</h1>
<p>You also need to have ROOT installed with a minumum standard that your compiler supports C++14. At the moment it works with v5 or v6, but let me know of any problems. ROOT must be built with GSL library support, otherwise known as MathMore. To check this is true, you can type: <code>root-config --has-mathmore</code> and hope the response is <code>yes</code>. If it isn't, you will need to install the GSL libraries and reconfigure/rebuild ROOT.</p>
<p><img src="./.schematic_isssort.png" alt="Schematic for ISSSort" class="inline"/> </p>
</div></div><!-- PageDoc -->
<a href="doxygen_crawl.html"/>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.11.0
</small></address>
</div><!-- doc-content -->
</body>
</html>
